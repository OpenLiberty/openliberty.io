<!DOCTYPE html>
<html lang="zh-Hans">

  





<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>
    
      Deploying Java microservices to an OKD cluster using Minishift
    
  </title>
  <meta name="description" content="A getting started tutorial and an example on how to deploy Java microservices to an Origin Community Distribution of Kubernetes (OKD) cluster using Minishift for development purposes.">

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
  

  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/openliberty.css">
  <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/coderay-custom.css">

  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/header.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/header-dark.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/toc-multipane-static.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/end-of-guide.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-card.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/tabs.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-common.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-multipane.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-multipane-static.css">
  

  

  

  <link rel="canonical" href="https://openliberty.io/zh-Hans/guides/okd">
  <link rel="alternate" type="application/rss+xml" title="Open Liberty" href="/zh-Hans/feed.xml">
  <link href="https://fonts.googleapis.com/css?family=Asap:400,500" rel="stylesheet">
    
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@OpenLibertyIO" />
  <meta name="twitter:title" content="Deploying Java microservices to an OKD cluster using Minishift" />
  <meta name="twitter:description" content="A getting started tutorial and an example on how to deploy Java microservices to an Origin Community Distribution of Kubernetes (OKD) cluster using Minishift for development purposes." />

  <meta property='og:title' content="Deploying Java microservices to an OKD cluster using Minishift" />
  <meta property='og:image' content="https://openliberty.io/img/twitter_card.jpg" />
  <meta property='og:image:alt' content="Open Liberty Logo" />
  <meta property='og:description' content="A getting started tutorial and an example on how to deploy Java microservices to an Origin Community Distribution of Kubernetes (OKD) cluster using Minishift for development purposes." />
  <meta property='og:url' content="https://openliberty.io/zh-Hans/guides/okd" />
  <meta property='og:type' content="website" />
  
  <meta name="google-site-verification" content="h2P030H9b66CyL1nEmWfrZB8Fr14h9LmVMG7Ur0caBs" />

  
      <meta name="robots" content="noindex" />
  

  <script async defer src="https://buttons.github.io/buttons.js"></script>
</head>


  <body>
    
    

    


<!--  -->

<header>
    <nav id="nav_bar">
        <div id="nav_header">
            <a id="home_link" href="/" aria-label="Open Liberty Home">
                <img id="ol_logo" src="/img/docs_openliberty_logo.png" alt="Open Liberty Logo">
            </a>
            <button id="hamburger_toggle_button" onclick="$('#nav_bar').toggleClass('responsive');">
                <span id="hamburger_toggle_icon"></span>
            </button>
        </div>
        <div id="hamburger_menu">
            <ul class="nav_list">
                <li class="nav_link">
                    <a href="/start/">入门</a>
                </li>
                <li class="nav_link">
                    <a href="/guides/">指南</a>
                </li>
                <li class="nav_link">
                    <a href="/docs/">文档</a>
                </li>
                <li class="nav_link">
                    <a href="/support/">支持</a>
                </li>
                <li class="nav_link">
                    <a href="/blog/">博客</a>
                </li>
            </ul>
            <div id="header_round_links_container"> 
                <a id="header_twitter_link" class="header_round_button" href="https://twitter.com/OpenLibertyIO" target="_blank" rel="noopener noreferrer" aria-label="Twitter"></a>
                <a id="header_stackoverflow_link" class="header_round_button" href="https://stackoverflow.com/questions/tagged/open-liberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty questions on Stack Overflow"></a>
                <a id="header_groupsio_link" class="header_round_button" href="https://groups.io/g/openliberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Groups.io"></a>
                <a id="header_gitter_link" class="header_round_button" href="https://app.gitter.im/#/room/#OpenLiberty_development:gitter.im" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Gitter"></a>
            </div>
        </div>

    </nav>
</header>


    <main aria-label="Content">

      <!-- Build a list of all the documents in the guides code base -->
  
 

<!-- Remove any documents deemed private (archived, templates, etc) -->


<!-- Count number of guides from past 30 days-->
<!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
 

<!-- Sort list of guides by date with most recent first -->


<div id="background_container">
  <div id="toc_hotspot"></div>
  <!-- Guide's table of contents section -->
  <div id="toc_column" class="collapse inline open">
    <div id="toc_inner">
       
      <div id="close_container">
        <img id="toc_close_white" src="/img/toc_close_white.svg" alt="Close the table of contents" tabindex="0">
      </div>
      <h3 id="toc_title">Contents</h3>
      <div id="toc_container"><ul class="sectlevel1">
<li>
<a href="#what-youll-learn">What you’ll learn</a>
<ul class="sectlevel2">
<li><a href="#what-is-origin-community-distribution-of-kubernetes-okd">What is Origin Community Distribution of Kubernetes (OKD)?</a></li>
</ul>
</li>
<li><a href="#additional-prerequisites">Additional prerequisites</a></li>
<li><a href="#getting-started">Getting started</a></li>
<li>
<a href="#starting-minishift">Starting Minishift</a>
<ul class="sectlevel2">
<li><a href="#deploying-the-cluster">Deploying the cluster</a></li>
<li><a href="#logging-in-to-the-cluster">Logging in to the cluster</a></li>
</ul>
</li>
<li><a href="#building-the-system-microservice">Building the system microservice</a></li>
<li>
<a href="#containerizing-the-system-microservice">Containerizing the system microservice</a>
<ul class="sectlevel2">
<li><a href="#reusing-the-docker-daemon">Reusing the Docker daemon</a></li>
<li><a href="#building-the-docker-image">Building the Docker image</a></li>
<li><a href="#accessing-the-internal-registry">Accessing the internal registry</a></li>
</ul>
</li>
<li><a href="#deploying-the-system-microservice">Deploying the system microservice</a></li>
<li>
<a href="#deploying-the-inventory-microservice">Deploying the inventory microservice</a>
<ul class="sectlevel2">
<li><a href="#building-the-microservice">Building the microservice</a></li>
<li><a href="#containerizing-the-microservice">Containerizing the microservice</a></li>
<li><a href="#deploying-the-microservice">Deploying the microservice</a></li>
</ul>
</li>
<li><a href="#testing-the-microservices">Testing the microservices</a></li>
<li><a href="#tearing-down-the-environment">Tearing down the environment</a></li>
<li><a href="#great-work-youre-done">Great work! You’re done!</a></li>
<li><a href="#guide-attribution">Guide Attribution</a></li>
</ul></div>
      <div id="toc_separator"></div>
      
      <h3 id="tag_title">标签</h3>
      <div id="tags_container"></div>
    </div>
  </div>
  <div id="toc_indicator" tabindex="0" aria-label="Open the table of contents" class="hidden">
    <img src="/img/arrow_white.svg" alt="arrow">
  </div>
  <div id="toc_line" class="open"></div>
  <!-- Entire guide section -->
  <div id="guide_column" class="position_relative open">
    <div id="guide_content">
      <!-- Guide header section -->
      <div id="guide_meta" class="sect1" tabindex="0">
        <h1 id="guide_title">Deploying microservices to an OKD cluster using Minishift</h1>
        <div id="duration_container">
          <img src="/img/guide_duration_clock_icon_large.svg" alt="duration">
          <span id="guide_duration">1 hour</span>

          <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
          <!-- If new posts count is less than 4, use 4 most recent posts -->
           
          <!-- If new posts count is >= 4, use posts from last 30 days-->
          
          <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
          <!-- Count number of guides from past last 12 weeks that is 84 days-->
          <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
          
        </div>
        <div id="mobile_prereqs_section">
          <p id="mobile_prereqs_title">Prerequisites:</p>
          <div class="prereqs_list"></div>
          <div class="skills_network_container">
            <div class="skills_network_description"></div>
          </div>
        </div>
      </div>

      <div class="scroller_anchor"></div>
      <div id="mobile_toc_accordion_container" data-toggle="collapse" data-target="#toc_column" aria-expanded="false" aria-controls="toc_column" role="button">
        <div role="menuitem" id="mobile_toc_accordion">
          <button class="breadcrumb_hamburger toc-toggle collapsed" type="button" tabindex="0">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <img src="/img/toc_close_green.svg" class="TOC_Close_SVG hidden img-responsive" alt="Table of contents close button">
          </button>
          <span>Table of contents</span>
        </div>
      </div>

      <!-- Guide content section -->
      <div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note hidden">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This repository contains the guide documentation source. To view the guide in published form, view it on the <a href="https://openliberty.io/guides/okd.html" target="_blank" rel="noopener">Open Liberty website</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Explore how to use Minishift to deploy microservices to an Origin Community Distribution of Kubernetes (OKD) cluster.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-youll-learn">What you’ll learn</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You will learn how to deploy two simple microservices with Open Liberty to an Origin Community Distribution of Kubernetes (OKD) cluster that is running in
Minishift.</p>
</div>
<div class="sect2">
<h3 id="what-is-origin-community-distribution-of-kubernetes-okd">What is Origin Community Distribution of Kubernetes (OKD)?</h3>
<div class="paragraph">
<p>OKD, formerly known as OpenShift Origin, is the upstream open source project for all OpenShift products.
OKD is a Kubernetes-based platform with added functionality.
OKD streamlines the DevOps process by providing an intuitive development pipeline.
It also provides integration with multiple tools to make the deployment and management of cloud applications easier.</p>
</div>
<div class="paragraph">
<p>To learn more about OKD, check out the <a href="https://www.okd.io/" target="_blank" rel="noopener noreferrer">official OKD page</a>.
To learn more about the different platforms that Red Hat OpenShift offers,
check out the <a href="https://docs.openshift.com" target="_blank" rel="noopener noreferrer">official OpenShift documentation</a>.
If you would like to learn more about Kubernetes, check out
the <a href="https://openliberty.io/guides/kubernetes-intro.html" target="_blank" rel="noopener">Deploying microservices to Kubernetes</a> guide.</p>
</div>
<div class="paragraph">
<p>Using Maven, you will build the <code>system</code> microservice that collects basic system properties from your system and the <code>inventory</code> microservice that will
interact with the <code>system</code> microservice. Then, you will learn how to deploy both to the cluster and establish communication between them.</p>
</div>
<div class="paragraph">
<p>You will use Minishift, a tool for you to run OKD on a local system.
Minishift allows developers to deploy a quick and easy OKD cluster for application development.</p>
</div>
<div class="paragraph">
<p>Minishift is based on OKD 3.11.
To run OKD 4.1 or newer on your local system, you can use the CodeReady Containers tool instead.
To learn how to use CodeReady Containers, check out the
<a href="https://openliberty.io/guides/openshift-codeready-containers.html" target="_blank" rel="noopener">Deploying microservices to OpenShift using CodeReady Containers</a> guide.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="additional-prerequisites">Additional prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following tools need to be installed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Minishift:</strong> With Minishift, you can try OKD by running a VM with a single-node cluster.
You can use Minishift with any OS, making it a convenient and flexible tool for testing and development.
For installation instructions, refer to the official
<a href="https://docs.okd.io/latest/minishift/index.html" target="_blank" rel="noopener noreferrer">OKD Minishift documentation</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To verify that Minishift is installed correctly, run the following command:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>minishift version</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output is similar to:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>minishift v1.34.1+c2ff9cb</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Docker:</strong> Docker is a containerization software for building the containers that you will eventually deploy onto the OKD cluster. For installation
instructions, refer to the official <a href="https://docs.docker.com/install/" target="_blank" rel="noopener noreferrer">Docker documentation</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To verify that Docker is installed correctly, run the following command:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker version</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output is similar to:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>Client: Docker Engine - Community
 Version:           19.03.5</pre>
</div>
</div>
</div>
</div>
<div class="sect1 command">
<h2 id="getting-started">Getting started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The fastest way to work through this guide is to clone the <a href="https://github.com/openliberty/guide-okd.git" target="_blank" rel="noopener noreferrer">Git repository</a> and use the projects that are provided inside:</p>
</div>
<div id="git_clone" class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>git clone https://github.com/openliberty/guide-okd.git
cd guide-okd</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>start</code> directory contains the starting project that you will build upon.</p>
</div>
<div class="paragraph">
<p>The <code>finish</code> directory contains the finished project that you will build.</p>
</div>
<div class="paragraph">
<p>Before you begin, make sure you have all the necessary <span class="prerequisites">prerequisites</span>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="starting-minishift">Starting Minishift</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="deploying-the-cluster">Deploying the cluster</h3>
<div class="paragraph">
<p>Run the following command to start Minishift and create the OKD cluster:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>minishift start</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the cluster started successfully, you see the following output:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>Server Information ...
OpenShift server started.

The server is accessible via web console at:
    https://192.168.99.103:8443/console</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="logging-in-to-the-cluster">Logging in to the cluster</h3>
<div class="paragraph">
<p>To interact with the OpenShift cluster, you need to use the <code>oc</code> command.
Minishift already includes the <code>oc</code> binary.
To use the <code>oc</code> commands, run the following command to configure your PATH to include the binary:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>minishift oc-env</code></pre>
</div>
</div>
<div class="paragraph">
<p>The resulting output differs based on your OS and environment, but you get an output similar to the following:</p>
</div>
<div class="paragraph tab_link windows_link">
<p><code><strong>WINDOWS</strong></code></p>
</div>
<div class="paragraph tab_link mac_link">
<p><code><strong>MAC</strong></code></p>
</div>
<div class="paragraph tab_link linux_link">
<p><code><strong>LINUX</strong></code></p>
</div>
<div class="openblock tab_content linux_section">
<div class="content">
<div class="listingblock no_copy">
<div class="content">
<pre>export PATH="/root/.minishift/cache/oc/v3.11.0/linux:$PATH"
# Run this command to configure your command-line session:
# eval $(minishift oc-env)</pre>
</div>
</div>
<div class="paragraph">
<p>Run the appropriate command to configure your environment:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>eval $(minishift oc-env)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock tab_content mac_section">
<div class="content">
<div class="listingblock no_copy">
<div class="content">
<pre>export PATH="/Users/guidesbot@ibm.com/.minishift/cache/oc/v3.11.0/darwin:$PATH"
# Run this command to configure your command-line session:
# eval $(minishift oc-env)</pre>
</div>
</div>
<div class="paragraph">
<p>Run the appropriate command to configure your environment:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>eval $(minishift oc-env)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock tab_content windows_section">
<div class="content">
<div class="listingblock no_copy">
<div class="content">
<pre>SET PATH=C:\Users\guides-bot\.minishift\cache\oc\v3.11.0\windows;%PATH%
REM Run this command to configure your command-line session:
REM     @FOR /f "tokens=*" %i IN ('minishift oc-env') DO @call %i</pre>
</div>
</div>
<div class="paragraph">
<p>Run the appropriate command to configure your environment:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>@FOR /f "tokens=*" %i IN ('minishift oc-env') DO @call %i</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>You can run through the development cycle by using OpenShift’s web console through the URL provided in the command output of the <code>minishift start</code>
command. You can also run the following command to open the web console:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>minishift console</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can log in with the following credentials:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>User:     developer
Password: [any value]</pre>
</div>
</div>
<div class="paragraph">
<p>The web console provides a GUI alternative to their CLI tools that you can explore on your own.
This guide will continue with the CLI tools.</p>
</div>
<div class="paragraph">
<p>You can confirm your credentials by running the <code>oc whoami</code> command. You will get <code>developer</code> as your output.</p>
</div>
<div class="paragraph">
<p>Next, create a new OpenShift project by running the following command:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc new-project [project-name]</code></pre>
</div>
</div>
<div class="paragraph">
<p>You are now ready to build and deploy a microservice.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="building-the-system-microservice">Building the system microservice</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dockerfile</p>
</div>
<div class="listingblock code_column">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="Text"><span class="line-numbers"> 1</span>FROM openliberty/open-liberty:kernel-java8-openj9-ubi
<span class="line-numbers"> 2</span>
<span class="line-numbers"> 3</span>ARG VERSION=1.0
<span class="line-numbers"> 4</span>ARG REVISION=SNAPSHOT
<span class="line-numbers"> 5</span>
<span class="line-numbers"> 6</span>LABEL \
<span class="line-numbers"> 7</span>  org.opencontainers.image.authors="Your Name" \
<span class="line-numbers"> 8</span>  org.opencontainers.image.vendor="IBM" \
<span class="line-numbers"> 9</span>  org.opencontainers.image.url="local" \
<span class="line-numbers">10</span>  org.opencontainers.image.source="https://github.com/OpenLiberty/guide-okd" \
<span class="line-numbers">11</span>  org.opencontainers.image.version="$VERSION" \
<span class="line-numbers">12</span>  org.opencontainers.image.revision="$REVISION" \
<span class="line-numbers">13</span>  vendor="Open Liberty" \
<span class="line-numbers">14</span>  name="system" \
<span class="line-numbers">15</span>  version="$VERSION-$REVISION" \
<span class="line-numbers">16</span>  summary="The system microservice from the OKD guide" \
<span class="line-numbers">17</span>  description="This image contains the system microservice running with the Open Liberty runtime."
<span class="line-numbers">18</span>
<span class="line-numbers">19</span>COPY src/main/liberty/config /config/
<span class="line-numbers">20</span>COPY target/*.war /config/apps
<span class="line-numbers">21</span>
<span class="line-numbers">22</span>RUN configure.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>A simple microservice named <code>system</code> will be packaged, containerized, and deployed onto the OKD cluster.
The <code>system</code> microservice collects the JVM properties of the host machine.</p>
</div>
<div class="paragraph">
<p>Navigate to the <code>start</code> directory.</p>
</div>
<div class="paragraph">
<p>The source code of the <code>system</code> and <code>inventory</code> microservices is located at the <code>system</code> and <code>inventory</code> directories.
Focus on the <code>system</code> microservice first, and you will learn about the <code>inventory</code> microservice later.</p>
</div>
<div class="paragraph">
<p>In the <code>start</code> directory, run the following command to package the <code>system</code> microservice:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn -pl system package</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>mvn package</code> command compiles, verifies, and builds the project.
The resulting compiled code is packaged into a <code>war</code> web archive that can be found under the <code>system/target</code> directory.
The archive contains the application that is needed to run the microservice on an Open Liberty,
and it is now ready to be injected into a Docker container for deployment.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="containerizing-the-system-microservice">Containerizing the system microservice</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="reusing-the-docker-daemon">Reusing the Docker daemon</h3>
<div class="paragraph">
<p>To simplify the local deployment process, you can reuse the built-in Minishift Docker daemon.
Reusing the Minishift Docker daemon allows you to use the internal Docker registry,
so you don’t have to build a Docker registry on your machine.
To reuse the Docker daemon, run the following command to point your command-line session to use the Minishift’s daemon:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>minishift docker-env</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of the command is a list of bash environment variable exports that configure your environment to reuse the Docker daemon inside the single
Minishift VM instance. The commands differ based on your OS and environment, but you get an output similar to the following example:</p>
</div>
<div class="paragraph tab_link windows_link">
<p><code><strong>WINDOWS</strong></code></p>
</div>
<div class="paragraph tab_link mac_link">
<p><code><strong>MAC</strong></code></p>
</div>
<div class="paragraph tab_link linux_link">
<p><code><strong>LINUX</strong></code></p>
</div>
<div class="openblock tab_content mac_section linux_section">
<div class="content">
<div class="listingblock no_copy">
<div class="content">
<pre>export DOCKER_TLS_VERIFY="1"
export DOCKER_HOST="tcp://192.168.99.103:2376"
export DOCKER_CERT_PATH="/Users/guidesbot@ibm.com/.minishift/certs"
# Run this command to configure your command-line session:
# eval $(minishift docker-env)</pre>
</div>
</div>
<div class="paragraph">
<p>Run the <code>eval</code> command to configure your environment:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>eval $(minishift docker-env)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock tab_content windows_section">
<div class="content">
<div class="listingblock no_copy">
<div class="content">
<pre>SET DOCKER_TLS_VERIFY=1
SET DOCKER_HOST=tcp://9.26.69.218:2376
SET DOCKER_CERT_PATH=C:\Users\maihameed\.minishift\certs
REM Run this command to configure your command-line session:
REM     @FOR /f "tokens=*" %i IN ('minishift docker-env') DO @call %i</pre>
</div>
</div>
<div class="paragraph">
<p>Run the given <code>@FOR</code> command to configure your environment:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>@FOR /f "tokens=*" %i IN ('minishift docker-env') DO @call %i</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="building-the-docker-image">Building the Docker image</h3>
<div class="paragraph">
<p>Run the following command to download or update to the latest Open Liberty Docker image:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker pull openliberty/open-liberty:kernel-java8-openj9-ubi</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now that the environment is set up, ensure that you are in the <code>start</code> directory and run the following command to build the <code>system</code> Docker image:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker build -t system system/</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command builds an image named <code>system</code> from the <code class="hotspot file=0">Dockerfile</code> provided in the <code>system</code> directory.
To verify that the images are built, run the following command to list all local Docker images:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker images</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your <code>system</code> image should appear in the list of all Docker images:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>REPOSITORY             TAG                 IMAGE ID            CREATED             SIZE
system                 latest              e8a8393e9364        2 minutes ago       399MB</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="accessing-the-internal-registry">Accessing the internal registry</h3>
<div class="paragraph">
<p>To run the microservice on the OKD cluster, you need to push the microservice image into a container image registry.
You will use the OpenShift integrated container image registry called OpenShift Container Registry (OCR).
First, you must authenticate your Docker client to your OCR. Start by running the login command:</p>
</div>
<div class="paragraph tab_link windows_link">
<p><code><strong>WINDOWS</strong></code></p>
</div>
<div class="paragraph tab_link mac_link">
<p><code><strong>MAC</strong></code></p>
</div>
<div class="paragraph tab_link linux_link">
<p><code><strong>LINUX</strong></code></p>
</div>
<div class="openblock tab_content mac_section linux_section">
<div class="content">
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>echo $(oc whoami -t) | docker login -u developer --password-stdin $(oc registry info)</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock tab_content windows_section">
<div class="content">
<div class="paragraph">
<p>Because the Windows command prompt doesn’t support the command substitution that is displayed for Mac and Linux, run the following commands:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc whoami
oc whoami -t
oc registry info</code></pre>
</div>
</div>
<div class="paragraph">
<p>Replace the square brackets in the following <code>docker login</code> command with the results from the previous commands:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker login -u [oc whoami] -p [oc whoami -t] [oc registry info]</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Now you must tag and push your <code>system</code> microservice to the internal registry so that it is accessible for deployment.
Run the following command to tag your microservice:</p>
</div>
<div class="paragraph tab_link windows_link">
<p><code><strong>WINDOWS</strong></code></p>
</div>
<div class="paragraph tab_link mac_link">
<p><code><strong>MAC</strong></code></p>
</div>
<div class="paragraph tab_link linux_link">
<p><code><strong>LINUX</strong></code></p>
</div>
<div class="openblock tab_content mac_section linux_section">
<div class="content">
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker tag system $(oc registry info)/$(oc project -q)/system</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock tab_content windows_section">
<div class="content">
<div class="paragraph">
<p>Run the following commands:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc registry info
oc project -q</code></pre>
</div>
</div>
<div class="paragraph">
<p>Replace the square brackets in the following <code>docker tag</code> command with the results from the previous commands:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker tag system [oc registry info]/[oc project -q]/system</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Your newly tagged image should appear in the list of all Docker images:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>REPOSITORY                             TAG                 IMAGE ID            CREATED             SIZE
system                                 latest              e8a8393e9364        2 minutes ago       399MB
172.30.1.1:5000/my-project/system      latest              e8a8393e9364        2 minutes ago       399MB</pre>
</div>
</div>
<div class="paragraph">
<p>Now push your newly tagged image to the internal registry by running the following command:</p>
</div>
<div class="paragraph tab_link windows_link">
<p><code><strong>WINDOWS</strong></code></p>
</div>
<div class="paragraph tab_link mac_link">
<p><code><strong>MAC</strong></code></p>
</div>
<div class="paragraph tab_link linux_link">
<p><code><strong>LINUX</strong></code></p>
</div>
<div class="openblock tab_content mac_section linux_section">
<div class="content">
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker push $(oc registry info)/$(oc project -q)/system</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock tab_content windows_section">
<div class="content">
<div class="paragraph">
<p>Run the following commands:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc registry info
oc project -q</code></pre>
</div>
</div>
<div class="paragraph">
<p>Replace the square brackets in the following <code>docker push</code> command with the results from the previous commands:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker push [oc registry info]/[oc project -q]/system</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The microservice is now ready for deployment.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploying-the-system-microservice">Deploying the system microservice</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that the <code>system</code> Docker image is built, deploy it using a resource configuration file.
Since OKD is built on top of Kubernetes, it supports the same concepts and deployment strategies.
The OpenShift <code>oc</code> CLI tool supports most of the same commands as the Kubernetes <code>kubectl</code> tool.
To learn more about Kubernetes and resource configuration files,
check out the <a href="https://openliberty.io/guides/kubernetes-intro.html" target="_blank" rel="noopener">Deploying microservices to Kubernetes</a> guide.</p>
</div>
<div class="paragraph">
<p>The provided <code class="hotspot file=0">deploy.yaml</code> configuration file outlines a <code class="hotspot=deployment file=0">deployment</code>
resource that creates and deploys a container named <code class="hotspot=container file=0">system-container</code>.
This container will run the Docker-formatted image provided in the <code class="hotspot=image file=0">image</code> field.
The <code class="hotspot=image file=0">image</code> field should point to your newly pushed image.</p>
</div>
<div class="paragraph">
<p>deploy.yaml</p>
</div>
<div class="listingblock code_column hide_tags=everythingButSystemDeployment">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="line-numbers">  1</span><span class="key">apiVersion</span>: <span class="string"><span class="content">apps/v1</span></span>
<span class="line-numbers">  2</span><span class="comment"># tag::deployment[]</span>
<span class="line-numbers">  3</span><span class="key">kind</span>: <span class="string"><span class="content">Deployment</span></span>
<span class="line-numbers">  4</span><span class="comment"># end::deployment[]</span>
<span class="line-numbers">  5</span><span class="key">metadata</span>:
<span class="line-numbers">  6</span>  <span class="key">name</span>: <span class="string"><span class="content">system-deployment</span></span>
<span class="line-numbers">  7</span>  <span class="key">labels</span>:
<span class="line-numbers">  8</span>    <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers">  9</span><span class="key">spec</span>:
<span class="line-numbers"> 10</span>  <span class="key">selector</span>:
<span class="line-numbers"> 11</span>    <span class="key">matchLabels</span>:
<span class="line-numbers"> 12</span>      <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers"> 13</span>  <span class="key">template</span>:
<span class="line-numbers"> 14</span>    <span class="key">metadata</span>:
<span class="line-numbers"> 15</span>      <span class="key">labels</span>:
<span class="line-numbers"> 16</span>        <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers"> 17</span>    <span class="key">spec</span>:
<span class="line-numbers"> 18</span><span class="comment"># tag::container[]</span>
<span class="line-numbers"> 19</span>      <span class="key">containers</span>:
<span class="line-numbers"> 20</span>      - <span class="string"><span class="content">name: system-container</span></span>
<span class="line-numbers"> 21</span>        <span class="comment"># tag::image[]</span>
<span class="line-numbers"> 22</span>        <span class="key">image</span>: <span class="string"><span class="content">[image-link]</span></span>
<span class="line-numbers"> 23</span>        <span class="comment"># end::image[]</span>
<span class="line-numbers"> 24</span>        <span class="key">ports</span>:
<span class="line-numbers"> 25</span>        - <span class="string"><span class="content">containerPort: 9080</span></span>
<span class="line-numbers"> 26</span><span class="comment"># end::container[]</span>
<span class="line-numbers"> 27</span><span class="comment"># tag::everythingButSystemDeployment[]</span>
<span class="line-numbers"> 28</span><span class="comment"># tag::systemService[]</span>
<span class="line-numbers"> 29</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 30</span><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="line-numbers"> 31</span><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="line-numbers"> 32</span><span class="key">metadata</span>:
<span class="line-numbers"> 33</span>  <span class="key">name</span>: <span class="string"><span class="content">system-service</span></span>
<span class="line-numbers"> 34</span><span class="key">spec</span>:
<span class="line-numbers"> 35</span>  <span class="key">selector</span>:
<span class="line-numbers"> 36</span>    <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers"> 37</span>  <span class="key">ports</span>:
<span class="line-numbers"> 38</span>  - <span class="string"><span class="content">protocol: TCP</span></span>
<span class="line-numbers"> 39</span>    <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers"> 40</span><span class="comment"># end::systemService[]</span>
<span class="line-numbers"> 41</span><span class="comment"># tag::everythingButSystemDeploymentAndService[]</span>
<span class="line-numbers"> 42</span><span class="comment"># tag::systemRoute[]</span>
<span class="line-numbers"> 43</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 44</span><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="line-numbers"> 45</span><span class="key">kind</span>: <span class="string"><span class="content">Route</span></span>
<span class="line-numbers"> 46</span><span class="key">metadata</span>:
<span class="line-numbers"> 47</span>  <span class="key">name</span>: <span class="string"><span class="content">system-route</span></span>
<span class="line-numbers"> 48</span><span class="key">spec</span>:
<span class="line-numbers"> 49</span>  <span class="key">to</span>:
<span class="line-numbers"> 50</span>    <span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="line-numbers"> 51</span>    <span class="key">name</span>: <span class="string"><span class="content">system-service</span></span>
<span class="line-numbers"> 52</span><span class="comment"># end::systemRoute[]</span>
<span class="line-numbers"> 53</span><span class="comment"># tag::inventoryResources[]</span>
<span class="line-numbers"> 54</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 55</span><span class="key">apiVersion</span>: <span class="string"><span class="content">apps/v1</span></span>
<span class="line-numbers"> 56</span><span class="key">kind</span>: <span class="string"><span class="content">Deployment</span></span>
<span class="line-numbers"> 57</span><span class="key">metadata</span>:
<span class="line-numbers"> 58</span>  <span class="key">name</span>: <span class="string"><span class="content">inventory-deployment</span></span>
<span class="line-numbers"> 59</span>  <span class="key">labels</span>:
<span class="line-numbers"> 60</span>    <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers"> 61</span><span class="key">spec</span>:
<span class="line-numbers"> 62</span>  <span class="key">selector</span>:
<span class="line-numbers"> 63</span>    <span class="key">matchLabels</span>:
<span class="line-numbers"> 64</span>      <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers"> 65</span>  <span class="key">template</span>:
<span class="line-numbers"> 66</span>    <span class="key">metadata</span>:
<span class="line-numbers"> 67</span>      <span class="key">labels</span>:
<span class="line-numbers"> 68</span>        <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers"> 69</span>    <span class="key">spec</span>:
<span class="line-numbers"> 70</span>      <span class="key">containers</span>:
<span class="line-numbers"> 71</span>      - <span class="string"><span class="content">name: inventory-container</span></span>
<span class="line-numbers"> 72</span>        <span class="comment"># tag::inventoryImage[]</span>
<span class="line-numbers"> 73</span>        <span class="key">image</span>: <span class="string"><span class="content">[image-link]</span></span>
<span class="line-numbers"> 74</span>        <span class="comment"># end::inventoryImage[]</span>
<span class="line-numbers"> 75</span>        <span class="key">ports</span>:
<span class="line-numbers"> 76</span>        - <span class="string"><span class="content">containerPort: 9080</span></span>
<span class="line-numbers"> 77</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 78</span><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="line-numbers"> 79</span><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="line-numbers"> 80</span><span class="key">metadata</span>:
<span class="line-numbers"> 81</span>  <span class="key">name</span>: <span class="string"><span class="content">inventory-service</span></span>
<span class="line-numbers"> 82</span><span class="key">spec</span>:
<span class="line-numbers"> 83</span>  <span class="key">selector</span>:
<span class="line-numbers"> 84</span>    <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers"> 85</span>  <span class="key">ports</span>:
<span class="line-numbers"> 86</span>  - <span class="string"><span class="content">protocol: TCP</span></span>
<span class="line-numbers"> 87</span>    <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers"> 88</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 89</span><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="line-numbers"> 90</span><span class="key">kind</span>: <span class="string"><span class="content">Route</span></span>
<span class="line-numbers"> 91</span><span class="key">metadata</span>:
<span class="line-numbers"> 92</span>  <span class="key">name</span>: <span class="string"><span class="content">inventory-route</span></span>
<span class="line-numbers"> 93</span><span class="key">spec</span>:
<span class="line-numbers"> 94</span>  <span class="key">to</span>:
<span class="line-numbers"> 95</span>    <span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="line-numbers"> 96</span>    <span class="key">name</span>: <span class="string"><span class="content">inventory-service</span></span>
<span class="line-numbers"> 97</span><span class="comment"># end::inventoryResources[]</span>
<span class="line-numbers"> 98</span><span class="comment"># end::everythingButSystemDeploymentAndService[]</span>
<span class="line-numbers"> 99</span><span class="comment"># end::everythingButSystemDeployment[]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the following command to view the image stream:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc get imagestream</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should find your newly pushed image:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>NAME      DOCKER REPO                         TAGS      UPDATED
system    172.30.1.1:5000/my-project/system   latest    5 minutes ago</pre>
</div>
</div>
<div class="paragraph">
<p>The OpenShift image stream displays all the Docker-formatted container images that are pushed to the internal registry.
You can configure builds and deployments to trigger when an image is updated.</p>
</div>
<div class="listingblock code_command hotspot file=0">
<div class="content">
<pre><mark>Update the <code>deploy.yaml</code> file in the <code>start</code> directory.</mark>
<code>deploy.yaml</code></pre>
</div>
</div>
<div class="paragraph edit_command_text">
<p>The system <code class="hotspot=image file=0">image</code> field specifies the name and tag of the container image that you want to use for the system container. Update the
value of the system <code class="hotspot=image file=0">image</code> field to specify the image location found in the <code>DOCKER REPO</code> column from the output of the
following command:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc get imagestream</code></pre>
</div>
</div>
<div class="paragraph">
<p>After you update the value of the system <code class="hotspot=image file=0">image</code> field,
run the following command to apply the configuration file and create your OpenShift resource:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc apply -f deploy.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>You get an output similar to the following example:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>deployment.apps/system-deployment created</pre>
</div>
</div>
<div class="paragraph">
<p>Run the following command to view your pods:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc get pods</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ensure that your <code>system-deployment</code> pod is <code>Running</code>:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>NAME                                 READY     STATUS    RESTARTS   AGE
system-deployment-768f95cf8f-fnjjj   1/1       Running   0          5m</pre>
</div>
</div>
<div class="paragraph">
<p>Run the following command to get more details on your pod:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc describe pod system-deployment</code></pre>
</div>
</div>
<div class="paragraph">
<p>The pod description includes an events log, which is useful in debugging any issues that might arise.
The log is formatted similar to the following example:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>Events:
  Type    Reason     Age   From                Message
  ----    ------     ----  ----                -------
  Normal  Scheduled  1d    default-scheduler   Successfully assigned my-project/system-deployment-768f95cf8f-fnjjj to localhost
  Normal  Pulling    1d    kubelet, localhost  pulling image "172.30.1.1:5000/my-project/system"
  Normal  Pulled     1d    kubelet, localhost  Successfully pulled image "172.30.1.1:5000/my-project/system"
  Normal  Created    1d    kubelet, localhost  Created container
  Normal  Started    1d    kubelet, localhost  Started container</pre>
</div>
</div>
<div class="paragraph">
<p>The container is deployed successfully, but it’s isolated and cannot be accessed for requests.
A service needs to be created to expose your deployment so that you can make requests to your container.
You also must expose the service by using a route so that external users can access the microservice through a hostname.
Update your <code class="hotspot file=1">deploy.yaml</code> file to include service and route resources.</p>
</div>
<div class="listingblock code_command hotspot file=1">
<div class="content">
<pre><mark>Update the <code>deploy.yaml</code> file in the <code>start</code> directory.</mark>
<code>deploy.yaml</code></pre>
</div>
</div>
<div class="paragraph edit_command_text">
<p>Update the configuration file to include the <code class="hotspot=systemService file=1">service</code> and <code class="hotspot=systemRoute file=1">route</code> resources.</p>
</div>
<div class="paragraph">
<p>deploy.yaml</p>
</div>
<div class="listingblock code_column hide_tags=inventoryResources">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="line-numbers">  1</span><span class="key">apiVersion</span>: <span class="string"><span class="content">apps/v1</span></span>
<span class="line-numbers">  2</span><span class="comment"># tag::deployment[]</span>
<span class="line-numbers">  3</span><span class="key">kind</span>: <span class="string"><span class="content">Deployment</span></span>
<span class="line-numbers">  4</span><span class="comment"># end::deployment[]</span>
<span class="line-numbers">  5</span><span class="key">metadata</span>:
<span class="line-numbers">  6</span>  <span class="key">name</span>: <span class="string"><span class="content">system-deployment</span></span>
<span class="line-numbers">  7</span>  <span class="key">labels</span>:
<span class="line-numbers">  8</span>    <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers">  9</span><span class="key">spec</span>:
<span class="line-numbers"> 10</span>  <span class="key">selector</span>:
<span class="line-numbers"> 11</span>    <span class="key">matchLabels</span>:
<span class="line-numbers"> 12</span>      <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers"> 13</span>  <span class="key">template</span>:
<span class="line-numbers"> 14</span>    <span class="key">metadata</span>:
<span class="line-numbers"> 15</span>      <span class="key">labels</span>:
<span class="line-numbers"> 16</span>        <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers"> 17</span>    <span class="key">spec</span>:
<span class="line-numbers"> 18</span><span class="comment"># tag::container[]</span>
<span class="line-numbers"> 19</span>      <span class="key">containers</span>:
<span class="line-numbers"> 20</span>      - <span class="string"><span class="content">name: system-container</span></span>
<span class="line-numbers"> 21</span>        <span class="comment"># tag::image[]</span>
<span class="line-numbers"> 22</span>        <span class="key">image</span>: <span class="string"><span class="content">[image-link]</span></span>
<span class="line-numbers"> 23</span>        <span class="comment"># end::image[]</span>
<span class="line-numbers"> 24</span>        <span class="key">ports</span>:
<span class="line-numbers"> 25</span>        - <span class="string"><span class="content">containerPort: 9080</span></span>
<span class="line-numbers"> 26</span><span class="comment"># end::container[]</span>
<span class="line-numbers"> 27</span><span class="comment"># tag::everythingButSystemDeployment[]</span>
<span class="line-numbers"> 28</span><span class="comment"># tag::systemService[]</span>
<span class="line-numbers"> 29</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 30</span><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="line-numbers"> 31</span><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="line-numbers"> 32</span><span class="key">metadata</span>:
<span class="line-numbers"> 33</span>  <span class="key">name</span>: <span class="string"><span class="content">system-service</span></span>
<span class="line-numbers"> 34</span><span class="key">spec</span>:
<span class="line-numbers"> 35</span>  <span class="key">selector</span>:
<span class="line-numbers"> 36</span>    <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers"> 37</span>  <span class="key">ports</span>:
<span class="line-numbers"> 38</span>  - <span class="string"><span class="content">protocol: TCP</span></span>
<span class="line-numbers"> 39</span>    <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers"> 40</span><span class="comment"># end::systemService[]</span>
<span class="line-numbers"> 41</span><span class="comment"># tag::everythingButSystemDeploymentAndService[]</span>
<span class="line-numbers"> 42</span><span class="comment"># tag::systemRoute[]</span>
<span class="line-numbers"> 43</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 44</span><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="line-numbers"> 45</span><span class="key">kind</span>: <span class="string"><span class="content">Route</span></span>
<span class="line-numbers"> 46</span><span class="key">metadata</span>:
<span class="line-numbers"> 47</span>  <span class="key">name</span>: <span class="string"><span class="content">system-route</span></span>
<span class="line-numbers"> 48</span><span class="key">spec</span>:
<span class="line-numbers"> 49</span>  <span class="key">to</span>:
<span class="line-numbers"> 50</span>    <span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="line-numbers"> 51</span>    <span class="key">name</span>: <span class="string"><span class="content">system-service</span></span>
<span class="line-numbers"> 52</span><span class="comment"># end::systemRoute[]</span>
<span class="line-numbers"> 53</span><span class="comment"># tag::inventoryResources[]</span>
<span class="line-numbers"> 54</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 55</span><span class="key">apiVersion</span>: <span class="string"><span class="content">apps/v1</span></span>
<span class="line-numbers"> 56</span><span class="key">kind</span>: <span class="string"><span class="content">Deployment</span></span>
<span class="line-numbers"> 57</span><span class="key">metadata</span>:
<span class="line-numbers"> 58</span>  <span class="key">name</span>: <span class="string"><span class="content">inventory-deployment</span></span>
<span class="line-numbers"> 59</span>  <span class="key">labels</span>:
<span class="line-numbers"> 60</span>    <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers"> 61</span><span class="key">spec</span>:
<span class="line-numbers"> 62</span>  <span class="key">selector</span>:
<span class="line-numbers"> 63</span>    <span class="key">matchLabels</span>:
<span class="line-numbers"> 64</span>      <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers"> 65</span>  <span class="key">template</span>:
<span class="line-numbers"> 66</span>    <span class="key">metadata</span>:
<span class="line-numbers"> 67</span>      <span class="key">labels</span>:
<span class="line-numbers"> 68</span>        <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers"> 69</span>    <span class="key">spec</span>:
<span class="line-numbers"> 70</span>      <span class="key">containers</span>:
<span class="line-numbers"> 71</span>      - <span class="string"><span class="content">name: inventory-container</span></span>
<span class="line-numbers"> 72</span>        <span class="comment"># tag::inventoryImage[]</span>
<span class="line-numbers"> 73</span>        <span class="key">image</span>: <span class="string"><span class="content">[image-link]</span></span>
<span class="line-numbers"> 74</span>        <span class="comment"># end::inventoryImage[]</span>
<span class="line-numbers"> 75</span>        <span class="key">ports</span>:
<span class="line-numbers"> 76</span>        - <span class="string"><span class="content">containerPort: 9080</span></span>
<span class="line-numbers"> 77</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 78</span><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="line-numbers"> 79</span><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="line-numbers"> 80</span><span class="key">metadata</span>:
<span class="line-numbers"> 81</span>  <span class="key">name</span>: <span class="string"><span class="content">inventory-service</span></span>
<span class="line-numbers"> 82</span><span class="key">spec</span>:
<span class="line-numbers"> 83</span>  <span class="key">selector</span>:
<span class="line-numbers"> 84</span>    <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers"> 85</span>  <span class="key">ports</span>:
<span class="line-numbers"> 86</span>  - <span class="string"><span class="content">protocol: TCP</span></span>
<span class="line-numbers"> 87</span>    <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers"> 88</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 89</span><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="line-numbers"> 90</span><span class="key">kind</span>: <span class="string"><span class="content">Route</span></span>
<span class="line-numbers"> 91</span><span class="key">metadata</span>:
<span class="line-numbers"> 92</span>  <span class="key">name</span>: <span class="string"><span class="content">inventory-route</span></span>
<span class="line-numbers"> 93</span><span class="key">spec</span>:
<span class="line-numbers"> 94</span>  <span class="key">to</span>:
<span class="line-numbers"> 95</span>    <span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="line-numbers"> 96</span>    <span class="key">name</span>: <span class="string"><span class="content">inventory-service</span></span>
<span class="line-numbers"> 97</span><span class="comment"># end::inventoryResources[]</span>
<span class="line-numbers"> 98</span><span class="comment"># end::everythingButSystemDeploymentAndService[]</span>
<span class="line-numbers"> 99</span><span class="comment"># end::everythingButSystemDeployment[]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To update your resources, run the following command:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc apply -f deploy.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that the cluster only picks up changes, and doesn’t tear down and rebuild the deployment if it hasn’t changed:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>deployment.apps/system-deployment unchanged
service/system-service created
route/system-route created</pre>
</div>
</div>
<div class="paragraph">
<p>You can view all of your routes by running the following command:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc get routes</code></pre>
</div>
</div>
<div class="paragraph">
<p>You get an output similar to the following example:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>NAME             HOST/PORT                                         PATH      SERVICES         PORT      TERMINATION   WILDCARD
system-route     system-route-my-project.192.168.99.103.nip.io               system-service   &lt;all&gt;                   None</pre>
</div>
</div>
<div class="paragraph">
<p>Access your microservice through the hostname provided in the output,
by going to the <code>http://[hostname]/system/properties</code> URL, or running the following command.
In the following command, replace <code>[hostname]</code> with the hostname provided by the <code>oc get routes</code> command.</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>curl http://[hostname]/system/properties</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploying-the-inventory-microservice">Deploying the inventory microservice</h2>
<div class="sectionbody">
<div class="paragraph">
<p>deploy.yaml</p>
</div>
<div class="listingblock code_column">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="line-numbers">  1</span><span class="key">apiVersion</span>: <span class="string"><span class="content">apps/v1</span></span>
<span class="line-numbers">  2</span><span class="comment"># tag::deployment[]</span>
<span class="line-numbers">  3</span><span class="key">kind</span>: <span class="string"><span class="content">Deployment</span></span>
<span class="line-numbers">  4</span><span class="comment"># end::deployment[]</span>
<span class="line-numbers">  5</span><span class="key">metadata</span>:
<span class="line-numbers">  6</span>  <span class="key">name</span>: <span class="string"><span class="content">system-deployment</span></span>
<span class="line-numbers">  7</span>  <span class="key">labels</span>:
<span class="line-numbers">  8</span>    <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers">  9</span><span class="key">spec</span>:
<span class="line-numbers"> 10</span>  <span class="key">selector</span>:
<span class="line-numbers"> 11</span>    <span class="key">matchLabels</span>:
<span class="line-numbers"> 12</span>      <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers"> 13</span>  <span class="key">template</span>:
<span class="line-numbers"> 14</span>    <span class="key">metadata</span>:
<span class="line-numbers"> 15</span>      <span class="key">labels</span>:
<span class="line-numbers"> 16</span>        <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers"> 17</span>    <span class="key">spec</span>:
<span class="line-numbers"> 18</span><span class="comment"># tag::container[]</span>
<span class="line-numbers"> 19</span>      <span class="key">containers</span>:
<span class="line-numbers"> 20</span>      - <span class="string"><span class="content">name: system-container</span></span>
<span class="line-numbers"> 21</span>        <span class="comment"># tag::image[]</span>
<span class="line-numbers"> 22</span>        <span class="key">image</span>: <span class="string"><span class="content">[image-link]</span></span>
<span class="line-numbers"> 23</span>        <span class="comment"># end::image[]</span>
<span class="line-numbers"> 24</span>        <span class="key">ports</span>:
<span class="line-numbers"> 25</span>        - <span class="string"><span class="content">containerPort: 9080</span></span>
<span class="line-numbers"> 26</span><span class="comment"># end::container[]</span>
<span class="line-numbers"> 27</span><span class="comment"># tag::everythingButSystemDeployment[]</span>
<span class="line-numbers"> 28</span><span class="comment"># tag::systemService[]</span>
<span class="line-numbers"> 29</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 30</span><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="line-numbers"> 31</span><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="line-numbers"> 32</span><span class="key">metadata</span>:
<span class="line-numbers"> 33</span>  <span class="key">name</span>: <span class="string"><span class="content">system-service</span></span>
<span class="line-numbers"> 34</span><span class="key">spec</span>:
<span class="line-numbers"> 35</span>  <span class="key">selector</span>:
<span class="line-numbers"> 36</span>    <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers"> 37</span>  <span class="key">ports</span>:
<span class="line-numbers"> 38</span>  - <span class="string"><span class="content">protocol: TCP</span></span>
<span class="line-numbers"> 39</span>    <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers"> 40</span><span class="comment"># end::systemService[]</span>
<span class="line-numbers"> 41</span><span class="comment"># tag::everythingButSystemDeploymentAndService[]</span>
<span class="line-numbers"> 42</span><span class="comment"># tag::systemRoute[]</span>
<span class="line-numbers"> 43</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 44</span><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="line-numbers"> 45</span><span class="key">kind</span>: <span class="string"><span class="content">Route</span></span>
<span class="line-numbers"> 46</span><span class="key">metadata</span>:
<span class="line-numbers"> 47</span>  <span class="key">name</span>: <span class="string"><span class="content">system-route</span></span>
<span class="line-numbers"> 48</span><span class="key">spec</span>:
<span class="line-numbers"> 49</span>  <span class="key">to</span>:
<span class="line-numbers"> 50</span>    <span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="line-numbers"> 51</span>    <span class="key">name</span>: <span class="string"><span class="content">system-service</span></span>
<span class="line-numbers"> 52</span><span class="comment"># end::systemRoute[]</span>
<span class="line-numbers"> 53</span><span class="comment"># tag::inventoryResources[]</span>
<span class="line-numbers"> 54</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 55</span><span class="key">apiVersion</span>: <span class="string"><span class="content">apps/v1</span></span>
<span class="line-numbers"> 56</span><span class="key">kind</span>: <span class="string"><span class="content">Deployment</span></span>
<span class="line-numbers"> 57</span><span class="key">metadata</span>:
<span class="line-numbers"> 58</span>  <span class="key">name</span>: <span class="string"><span class="content">inventory-deployment</span></span>
<span class="line-numbers"> 59</span>  <span class="key">labels</span>:
<span class="line-numbers"> 60</span>    <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers"> 61</span><span class="key">spec</span>:
<span class="line-numbers"> 62</span>  <span class="key">selector</span>:
<span class="line-numbers"> 63</span>    <span class="key">matchLabels</span>:
<span class="line-numbers"> 64</span>      <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers"> 65</span>  <span class="key">template</span>:
<span class="line-numbers"> 66</span>    <span class="key">metadata</span>:
<span class="line-numbers"> 67</span>      <span class="key">labels</span>:
<span class="line-numbers"> 68</span>        <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers"> 69</span>    <span class="key">spec</span>:
<span class="line-numbers"> 70</span>      <span class="key">containers</span>:
<span class="line-numbers"> 71</span>      - <span class="string"><span class="content">name: inventory-container</span></span>
<span class="line-numbers"> 72</span>        <span class="comment"># tag::inventoryImage[]</span>
<span class="line-numbers"> 73</span>        <span class="key">image</span>: <span class="string"><span class="content">[image-link]</span></span>
<span class="line-numbers"> 74</span>        <span class="comment"># end::inventoryImage[]</span>
<span class="line-numbers"> 75</span>        <span class="key">ports</span>:
<span class="line-numbers"> 76</span>        - <span class="string"><span class="content">containerPort: 9080</span></span>
<span class="line-numbers"> 77</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 78</span><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="line-numbers"> 79</span><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="line-numbers"> 80</span><span class="key">metadata</span>:
<span class="line-numbers"> 81</span>  <span class="key">name</span>: <span class="string"><span class="content">inventory-service</span></span>
<span class="line-numbers"> 82</span><span class="key">spec</span>:
<span class="line-numbers"> 83</span>  <span class="key">selector</span>:
<span class="line-numbers"> 84</span>    <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers"> 85</span>  <span class="key">ports</span>:
<span class="line-numbers"> 86</span>  - <span class="string"><span class="content">protocol: TCP</span></span>
<span class="line-numbers"> 87</span>    <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers"> 88</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 89</span><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="line-numbers"> 90</span><span class="key">kind</span>: <span class="string"><span class="content">Route</span></span>
<span class="line-numbers"> 91</span><span class="key">metadata</span>:
<span class="line-numbers"> 92</span>  <span class="key">name</span>: <span class="string"><span class="content">inventory-route</span></span>
<span class="line-numbers"> 93</span><span class="key">spec</span>:
<span class="line-numbers"> 94</span>  <span class="key">to</span>:
<span class="line-numbers"> 95</span>    <span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="line-numbers"> 96</span>    <span class="key">name</span>: <span class="string"><span class="content">inventory-service</span></span>
<span class="line-numbers"> 97</span><span class="comment"># end::inventoryResources[]</span>
<span class="line-numbers"> 98</span><span class="comment"># end::everythingButSystemDeploymentAndService[]</span>
<span class="line-numbers"> 99</span><span class="comment"># end::everythingButSystemDeployment[]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now that the <code>system</code> microservice is running, you will package and deploy the <code>inventory</code> microservice,
which adds the properties from the <code>system</code> microservice to the <code>inventory</code>.
This process demonstrates how to establish communication between pods inside a cluster.</p>
</div>
<div class="sect2">
<h3 id="building-the-microservice">Building the microservice</h3>
<div class="paragraph">
<p>In the <code>start</code> directory, run the following command to package the <code>inventory</code> microservice:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn -pl inventory package</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="containerizing-the-microservice">Containerizing the microservice</h3>
<div class="paragraph">
<p>Run the following command to use the <code>inventory</code> Dockerfile to create an image:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker build -t inventory inventory/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, tag and push the image to the internal registry.</p>
</div>
<div class="paragraph tab_link windows_link">
<p><code><strong>WINDOWS</strong></code></p>
</div>
<div class="paragraph tab_link mac_link">
<p><code><strong>MAC</strong></code></p>
</div>
<div class="paragraph tab_link linux_link">
<p><code><strong>LINUX</strong></code></p>
</div>
<div class="openblock tab_content mac_section linux_section">
<div class="content">
<div class="paragraph">
<p>Run the following command to tag your microservice:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker tag inventory $(oc registry info)/$(oc project -q)/inventory</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now push your newly tagged image to the internal registry by running the following command:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker push $(oc registry info)/$(oc project -q)/inventory</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock tab_content windows_section">
<div class="content">
<div class="paragraph">
<p>Run the following commands:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc registry info
oc project -q</code></pre>
</div>
</div>
<div class="paragraph">
<p>Replace the square brackets in the following command with the results from the previous commands to tag your microservice:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker tag inventory [oc registry info]/[oc project -q]/inventory</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the following command to push your microservice, ensuring to replace the square brackets:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker push [oc registry info]/[oc project -q]/inventory</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The microservice is now ready for deployment.</p>
</div>
</div>
<div class="sect2">
<h3 id="deploying-the-microservice">Deploying the microservice</h3>
<div class="paragraph">
<p>You can use the same <code class="hotspot file=0">deploy.yaml</code> configuration file to deploy multiple microservices.
Update the configuration file to include the deployment, service, and route resources for your <code>inventory</code> microservice.</p>
</div>
<div class="listingblock code_command hotspot file=0">
<div class="content">
<pre><mark>Update the <code>deploy.yaml</code> file in the <code>start</code> directory.</mark>
<code>deploy.yaml</code></pre>
</div>
</div>
<div class="paragraph edit_command_text">
<p>Update the configuration file to add the <code class="hotspot=inventoryResources file=0">inventory</code> resources.
Make sure to update the inventory <code class="hotspot=inventoryImage file=0">image</code> field with the appropriate
image link found in the <code>DOCKER REPO</code> column from the output of the following command:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc get imagestream</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now run the following command to allow the cluster to pick up the new changes:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc apply -f deploy.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the following command to get the hostname of the newly exposed <code>inventory</code> service:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc get route inventory-route</code></pre>
</div>
</div>
<div class="paragraph">
<p>You get an output similar to the following example:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>NAME              HOST/PORT                                    PATH      SERVICES            PORT      TERMINATION   WILDCARD
inventory-route   inventory-route-myproject.127.0.0.1.nip.io             inventory-service   &lt;all&gt;                   None</pre>
</div>
</div>
<div class="paragraph">
<p>Go to the following <code>http://[hostname]/inventory/systems</code> URL or run the following <code>curl</code> command to view the current inventory.
In the <code>curl</code> command, replace the <code>[hostname]</code> with your appropriate hostname:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>curl http://[hostname]/inventory/systems</code></pre>
</div>
</div>
<div class="paragraph">
<p>You see a JSON response like the following example.
Your JSON response might not be formatted.
The sample output was formatted for readability:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>{
    "systems": [],
    "total": 0
}</pre>
</div>
</div>
<div class="paragraph">
<p>Since this is a fresh deployment, there are no saved systems in the inventory. Go to the <code>http://[hostname]/inventory/systems/system-service</code> URL or run
the following command to allow the <code>inventory</code> microservice to access the <code>system</code> microservice and save the <code>system</code> result in the <code>inventory</code>:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>curl http://[hostname]/inventory/systems/system-service</code></pre>
</div>
</div>
<div class="paragraph">
<p>You receive your JVM system properties as a response.
Go to the following <code>http://[hostname]/inventory/systems</code> URL or run the following command to recheck the inventory:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>curl http://[hostname]/inventory/systems</code></pre>
</div>
</div>
<div class="paragraph">
<p>You see the following response:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>{
    "systems": [
        {
            "hostname": "system-service",
            "properties": {
                "os.name": "Linux",
                "user.name": "unknown"
            }
        }
    ],
    "total": 1
}</pre>
</div>
</div>
<div class="paragraph">
<p>Notice that the system count incremented by 1 and provided a list of a few key fields that are retrieved from the system response.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing-the-microservices">Testing the microservices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>pom.xml</p>
</div>
<div class="listingblock code_column">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="line-numbers">  1</span><span class="preprocessor">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="line-numbers">  2</span><span class="tag">&lt;project</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://maven.apache.org/POM/4.0.0</span><span class="delimiter">"</span></span> 
<span class="line-numbers">  3</span>    <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span> <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers">  4</span>
<span class="line-numbers">  5</span>    <span class="tag">&lt;modelVersion&gt;</span>4.0.0<span class="tag">&lt;/modelVersion&gt;</span>
<span class="line-numbers">  6</span>
<span class="line-numbers">  7</span>    <span class="tag">&lt;groupId&gt;</span>io.openliberty.guides<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">  8</span>    <span class="tag">&lt;artifactId&gt;</span>inventory<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">  9</span>    <span class="tag">&lt;version&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 10</span>    <span class="tag">&lt;packaging&gt;</span>war<span class="tag">&lt;/packaging&gt;</span>
<span class="line-numbers"> 11</span>
<span class="line-numbers"> 12</span>    <span class="tag">&lt;properties&gt;</span>
<span class="line-numbers"> 13</span>        <span class="tag">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="tag">&lt;/project.build.sourceEncoding&gt;</span>
<span class="line-numbers"> 14</span>        <span class="tag">&lt;project.reporting.outputEncoding&gt;</span>UTF-8<span class="tag">&lt;/project.reporting.outputEncoding&gt;</span>
<span class="line-numbers"> 15</span>        <span class="tag">&lt;maven.compiler.source&gt;</span>1.8<span class="tag">&lt;/maven.compiler.source&gt;</span>
<span class="line-numbers"> 16</span>        <span class="tag">&lt;maven.compiler.target&gt;</span>1.8<span class="tag">&lt;/maven.compiler.target&gt;</span>
<span class="line-numbers"> 17</span>        <span class="comment">&lt;!-- OpenLiberty runtime --&gt;</span>
<span class="line-numbers"> 18</span>        <span class="tag">&lt;http.port&gt;</span>9080<span class="tag">&lt;/http.port&gt;</span>
<span class="line-numbers"> 19</span>        <span class="tag">&lt;https.port&gt;</span>9443<span class="tag">&lt;/https.port&gt;</span>
<span class="line-numbers"> 20</span>        <span class="comment">&lt;!-- Default test properties --&gt;</span>
<span class="line-numbers"> 21</span>        <span class="tag">&lt;system.kube.service&gt;</span>system-service<span class="tag">&lt;/system.kube.service&gt;</span>
<span class="line-numbers"> 22</span>        <span class="comment">&lt;!-- tag::systemIP[] --&gt;</span>
<span class="line-numbers"> 23</span>        <span class="tag">&lt;system.ip&gt;</span>localhost:9090<span class="tag">&lt;/system.ip&gt;</span>
<span class="line-numbers"> 24</span>        <span class="comment">&lt;!-- end::systemIP[] --&gt;</span>
<span class="line-numbers"> 25</span>        <span class="comment">&lt;!-- tag::inventoryIP[] --&gt;</span>
<span class="line-numbers"> 26</span>        <span class="tag">&lt;inventory.ip&gt;</span>localhost:9080<span class="tag">&lt;/inventory.ip&gt;</span>
<span class="line-numbers"> 27</span>        <span class="comment">&lt;!-- end::inventoryIP[] --&gt;</span>
<span class="line-numbers"> 28</span>    <span class="tag">&lt;/properties&gt;</span>
<span class="line-numbers"> 29</span>
<span class="line-numbers"> 30</span>    <span class="tag">&lt;dependencies&gt;</span>
<span class="line-numbers"> 31</span>
<span class="line-numbers"> 32</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 33</span>            <span class="tag">&lt;groupId&gt;</span>jakarta.platform<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 34</span>            <span class="tag">&lt;artifactId&gt;</span>jakarta.jakartaee-api<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 35</span>            <span class="tag">&lt;version&gt;</span>8.0.0<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 36</span>            <span class="tag">&lt;scope&gt;</span>provided<span class="tag">&lt;/scope&gt;</span>
<span class="line-numbers"> 37</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 38</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 39</span>            <span class="tag">&lt;groupId&gt;</span>org.eclipse.microprofile<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 40</span>            <span class="tag">&lt;artifactId&gt;</span>microprofile<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 41</span>            <span class="tag">&lt;version&gt;</span>3.3<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 42</span>            <span class="tag">&lt;type&gt;</span>pom<span class="tag">&lt;/type&gt;</span>
<span class="line-numbers"> 43</span>            <span class="tag">&lt;scope&gt;</span>provided<span class="tag">&lt;/scope&gt;</span>
<span class="line-numbers"> 44</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 45</span>
<span class="line-numbers"> 46</span>        <span class="comment">&lt;!-- For tests --&gt;</span>
<span class="line-numbers"> 47</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 48</span>            <span class="tag">&lt;groupId&gt;</span>org.apache.cxf<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 49</span>            <span class="tag">&lt;artifactId&gt;</span>cxf-rt-rs-client<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 50</span>            <span class="tag">&lt;version&gt;</span>3.3.6<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 51</span>            <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="line-numbers"> 52</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 53</span>
<span class="line-numbers"> 54</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 55</span>            <span class="tag">&lt;groupId&gt;</span>org.apache.cxf<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 56</span>            <span class="tag">&lt;artifactId&gt;</span>cxf-rt-rs-extension-providers<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 57</span>            <span class="tag">&lt;version&gt;</span>3.3.6<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 58</span>            <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="line-numbers"> 59</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 60</span>
<span class="line-numbers"> 61</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 62</span>            <span class="tag">&lt;groupId&gt;</span>org.glassfish<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 63</span>            <span class="tag">&lt;artifactId&gt;</span>javax.json<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 64</span>            <span class="tag">&lt;version&gt;</span>1.1.4<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 65</span>            <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="line-numbers"> 66</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 67</span>
<span class="line-numbers"> 68</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 69</span>            <span class="tag">&lt;groupId&gt;</span>org.junit.jupiter<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 70</span>            <span class="tag">&lt;artifactId&gt;</span>junit-jupiter<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 71</span>            <span class="tag">&lt;version&gt;</span>5.6.2<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 72</span>            <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="line-numbers"> 73</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 74</span>
<span class="line-numbers"> 75</span>    <span class="tag">&lt;/dependencies&gt;</span>
<span class="line-numbers"> 76</span>
<span class="line-numbers"> 77</span>    <span class="tag">&lt;build&gt;</span>
<span class="line-numbers"> 78</span>        <span class="tag">&lt;finalName&gt;</span>${project.artifactId}<span class="tag">&lt;/finalName&gt;</span>
<span class="line-numbers"> 79</span>        <span class="tag">&lt;plugins&gt;</span>
<span class="line-numbers"> 80</span>
<span class="line-numbers"> 81</span>            <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers"> 82</span>                <span class="tag">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 83</span>                <span class="tag">&lt;artifactId&gt;</span>maven-war-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 84</span>                <span class="tag">&lt;version&gt;</span>3.2.3<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 85</span>                <span class="tag">&lt;configuration&gt;</span>
<span class="line-numbers"> 86</span>                    <span class="tag">&lt;packagingExcludes&gt;</span>pom.xml<span class="tag">&lt;/packagingExcludes&gt;</span>
<span class="line-numbers"> 87</span>                <span class="tag">&lt;/configuration&gt;</span>
<span class="line-numbers"> 88</span>            <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers"> 89</span>
<span class="line-numbers"> 90</span>            <span class="comment">&lt;!-- Liberty plugin --&gt;</span>
<span class="line-numbers"> 91</span>            <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers"> 92</span>                <span class="tag">&lt;groupId&gt;</span>io.openliberty.tools<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 93</span>                <span class="tag">&lt;artifactId&gt;</span>liberty-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 94</span>                <span class="tag">&lt;version&gt;</span>3.2<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 95</span>            <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers"> 96</span>
<span class="line-numbers"> 97</span>            <span class="comment">&lt;!-- For unit tests --&gt;</span>
<span class="line-numbers"> 98</span>            <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers"> 99</span>                <span class="tag">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">100</span>                <span class="tag">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">101</span>                <span class="tag">&lt;version&gt;</span>2.22.2<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers">102</span>                <span class="tag">&lt;configuration&gt;</span>
<span class="line-numbers">103</span>                    <span class="tag">&lt;systemPropertyVariables&gt;</span>
<span class="line-numbers">104</span>                        <span class="tag">&lt;system.kube.service&gt;</span>${system.kube.service}<span class="tag">&lt;/system.kube.service&gt;</span>
<span class="line-numbers">105</span>                        <span class="tag">&lt;system.ip&gt;</span>${system.ip}<span class="tag">&lt;/system.ip&gt;</span>
<span class="line-numbers">106</span>                        <span class="tag">&lt;inventory.ip&gt;</span>${inventory.ip}<span class="tag">&lt;/inventory.ip&gt;</span>
<span class="line-numbers">107</span>                    <span class="tag">&lt;/systemPropertyVariables&gt;</span>
<span class="line-numbers">108</span>                <span class="tag">&lt;/configuration&gt;</span>
<span class="line-numbers">109</span>            <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers">110</span>
<span class="line-numbers">111</span>            <span class="comment">&lt;!-- For integration tests --&gt;</span>
<span class="line-numbers">112</span>            <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers">113</span>                <span class="tag">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">114</span>                <span class="tag">&lt;artifactId&gt;</span>maven-failsafe-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">115</span>                <span class="tag">&lt;version&gt;</span>2.22.2<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers">116</span>                <span class="tag">&lt;configuration&gt;</span>
<span class="line-numbers">117</span>                    <span class="tag">&lt;systemPropertyVariables&gt;</span>
<span class="line-numbers">118</span>                        <span class="tag">&lt;system.kube.service&gt;</span>${system.kube.service}<span class="tag">&lt;/system.kube.service&gt;</span>
<span class="line-numbers">119</span>                        <span class="tag">&lt;system.ip&gt;</span>${system.ip}<span class="tag">&lt;/system.ip&gt;</span>
<span class="line-numbers">120</span>                        <span class="tag">&lt;inventory.ip&gt;</span>${inventory.ip}<span class="tag">&lt;/inventory.ip&gt;</span>
<span class="line-numbers">121</span>                    <span class="tag">&lt;/systemPropertyVariables&gt;</span>
<span class="line-numbers">122</span>                <span class="tag">&lt;/configuration&gt;</span>
<span class="line-numbers">123</span>                <span class="tag">&lt;executions&gt;</span>
<span class="line-numbers">124</span>                    <span class="tag">&lt;execution&gt;</span>
<span class="line-numbers">125</span>                        <span class="tag">&lt;id&gt;</span>integration-test<span class="tag">&lt;/id&gt;</span>
<span class="line-numbers">126</span>                        <span class="tag">&lt;goals&gt;</span>
<span class="line-numbers">127</span>                            <span class="tag">&lt;goal&gt;</span>integration-test<span class="tag">&lt;/goal&gt;</span>
<span class="line-numbers">128</span>                        <span class="tag">&lt;/goals&gt;</span>
<span class="line-numbers">129</span>                        <span class="tag">&lt;configuration&gt;</span>
<span class="line-numbers">130</span>                            <span class="tag">&lt;trimStackTrace&gt;</span>false<span class="tag">&lt;/trimStackTrace&gt;</span>
<span class="line-numbers">131</span>                        <span class="tag">&lt;/configuration&gt;</span>
<span class="line-numbers">132</span>                    <span class="tag">&lt;/execution&gt;</span>
<span class="line-numbers">133</span>                    <span class="tag">&lt;execution&gt;</span>
<span class="line-numbers">134</span>                        <span class="tag">&lt;id&gt;</span>verify<span class="tag">&lt;/id&gt;</span>
<span class="line-numbers">135</span>                        <span class="tag">&lt;goals&gt;</span>
<span class="line-numbers">136</span>                            <span class="tag">&lt;goal&gt;</span>verify<span class="tag">&lt;/goal&gt;</span>
<span class="line-numbers">137</span>                        <span class="tag">&lt;/goals&gt;</span>
<span class="line-numbers">138</span>                    <span class="tag">&lt;/execution&gt;</span>
<span class="line-numbers">139</span>                <span class="tag">&lt;/executions&gt;</span>
<span class="line-numbers">140</span>            <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers">141</span>
<span class="line-numbers">142</span>        <span class="tag">&lt;/plugins&gt;</span>
<span class="line-numbers">143</span>    <span class="tag">&lt;/build&gt;</span>
<span class="line-numbers">144</span><span class="tag">&lt;/project&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A few tests are included for you to test the basic functions of the microservices.
If a test failure occurs, then you might have introduced a bug into the code.
To run the tests, wait for all pods to be in the ready state before you proceed further.
The default parameters that are defined in the <code class="hotspot file=0">pom.xml</code> file are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 13.0434%;">
<col style="width: 86.9566%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Parameter</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="hotspot=systemIP">system.ip</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IP or hostname of the <code>system-service</code> Kubernetes Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code class="hotspot=inventoryIP">inventory.ip</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IP or hostname of the <code>inventory-service</code> Kubernetes Service</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Use the following command to run the integration tests against your running cluster:</p>
</div>
<div class="paragraph tab_link windows_link">
<p><code><strong>WINDOWS</strong></code></p>
</div>
<div class="paragraph tab_link mac_link">
<p><code><strong>MAC</strong></code></p>
</div>
<div class="paragraph tab_link linux_link">
<p><code><strong>LINUX</strong></code></p>
</div>
<div class="openblock tab_content windows_section">
<div class="content">
<div class="paragraph">
<p>Run the following command, noting the values of the <code>system</code> and <code>inventory</code> route hostnames:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc get routes</code></pre>
</div>
</div>
<div class="paragraph">
<p>Substitute <code>[system-route-hostname]</code> and <code>[inventory-route-hostname]</code> with the appropriate values and run the following command:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn verify -Ddockerfile.skip=true -Dsystem.ip=[system-route-hostname] -Dinventory.ip=[inventory-route-hostname]</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock tab_content mac_section linux_section">
<div class="content">
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn verify -Ddockerfile.skip=true \
-Dsystem.ip=$(oc get route system-route -o=jsonpath='{.spec.host}') \
-Dinventory.ip=$(oc get route inventory-route -o=jsonpath='{.spec.host}')</code></pre>
</div>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>dockerfile.skip</code> parameter is set to <code>true</code> to skip building a new container image.</p>
</li>
<li>
<p>The <code>system.ip</code> parameter is replaced with the appropriate hostname to access your system microservice.</p>
</li>
<li>
<p>The <code>inventory.ip</code> parameter is replaced with the appropriate hostname to access your inventory microservice.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the tests pass, you see an output for each service similar to the following example:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre class="CodeRay highlight"><code>-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running it.io.openliberty.guides.system.SystemEndpointIT
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.673 sec - in it.io.openliberty.guides.system.SystemEndpointIT

Results:

Tests run: 2, Failures: 0, Errors: 0, Skipped: 0</code></pre>
</div>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre class="CodeRay highlight"><code>-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running it.io.openliberty.guides.inventory.InventoryEndpointIT
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.222 sec - in it.io.openliberty.guides.inventory.InventoryEndpointIT

Results:

Tests run: 4, Failures: 0, Errors: 0, Skipped: 0</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tearing-down-the-environment">Tearing down the environment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you no longer need your deployed microservices, you can use the same configuration file to delete them.
Run the following command to delete your deployments, systems, and routes:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>oc delete -f deploy.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>To completely delete your Minishift VM, cluster, and all associated files, refer to the official
<a href="https://docs.okd.io/latest/minishift/getting-started/uninstalling.html" target="_blank" rel="noopener noreferrer">Uninstalling Minishift</a> documentation.</p>
</div>
<div class="paragraph">
<p>To revert back to your default Docker settings, simply close your command-line session.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="great-work-youre-done">Great work! You’re done!</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You just deployed two microservices running in Open Liberty to an OKD cluster using the <code>oc</code> tool.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="guide-attribution">Guide Attribution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Deploying microservices to an OKD cluster using Minishift <span class="licensedClass">by</span> Open Liberty <span class="licensedClass">is licensed under</span> CC BY-ND 4.0</p>
</div>
</div>
</div>
    </div>
  </div>

  <!-- Code section -->
  <div id="code_column" class="position_relative" tabindex="0">
    <div id="code_column_title_container">
      <div id="code_column_tabs_container" class="dimmed">
        <ul id="code_column_tabs" class="nav" role="tablist"></ul>
      </div>
      <div class="copyFileButton" tabindex="0">
        <img src="/img/guides_copy_button.svg" alt="Copy file contents" title="Copy file contents">
        <div id="code_section_copied_confirmation">Copied to clipboard </div>
      </div>
    </div>
    <div id="code_column_content"></div>

    <div id="prereqs_container">
      <p id="prereqs_title">Prerequisites:</p>
      <div class="prereqs_list"></div>
      <div class="skills_network_container">
        <div class="skills_network_description"></div>
      </div>
    </div>

    <button id="dismiss_button" aria-label="Back to text" tabindex="0">
      Back to text
    </button>
  </div>
</div>

<!-- Build a list of all the documents in the guides code base -->






<!-- Remove any documents deemed private (archived, templates, etc) -->


<!-- Count number of guides from past 30 days-->


    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    


<!-- Sort list of guides by date with most recent first -->





<div id="end_of_guide">
        <h2 tabindex="0">Nice work! Where to next?</h2>
        <div id="end_of_guide_left_section">
            <p id="guide_attribution"></p>
            
            <h3 id="feedback_rating_question">What did you think of this guide?</h3>
            <div id="feedback_ratings">
                <img class="guide_rating" id="extreme_dislike" src="/img/1_Extreme_Dislike.png" onclick="$('#dislike_popup').show(); $('.popup_content').focus();" alt="Extreme Dislike" data-guide-rating="1" tabindex="0" aria-label="Rate this guide as extreme dislike">
                <img class="guide_rating" id="dislike" src="/img/2_Dislike.png" onclick="$('#dislike_popup').show(); $('.popup_content').focus();" alt="Dislike" data-guide-rating="2" tabindex="0" aria-label="Rate this guide as dislike">
                <img class="guide_rating" id="like" src="/img/3_Like.png" onclick="$('#like_popup').show(); $('.popup_content').focus();" alt="Like" data-guide-rating="3" tabindex="0" aria-label="Rate this guide as like">
                <img class="guide_rating" id="extreme_like" src="/img/4_Extreme_Like.png" onclick="$('#like_popup').show(); $('.popup_content').focus();" alt="Extreme Like" data-guide-rating="4" tabindex="0" aria-label="Rate this guide as extreme like">
            </div>

            <div id="like_popup" class="popup">
                <div class="popup_content" tabindex="0">
                    <p class="popup_title">Thank you for your feedback!</p>
                    <button id="close_button" class="popup_button" onclick="$('#like_popup').hide();">Close</button>
                </div>
            </div>

            <div id="dislike_popup" class="popup">
                <div class="popup_content" tabindex="0">
                    <p class="popup_title">Thank you for your feedback!</p>
                    <p id="open_issue">Would you like to open an issue in GitHub?</p>
                    
                        <a href="https://github.com/OpenLiberty/guide-okd/issues/new" target="_blank" id="yes_button" class="popup_button" onclick="$('#dislike_popup').hide();" rel="noopener noreferrer">Yes</a>
                    
                    <button id="no_button" class="popup_button" onclick="$('#dislike_popup').hide();">No, thank you</button>
                </div>
            </div>

            <h3 id="improve_guide_feedback">What could make this guide better?</h3>
            
                <p><a target="_blank" rel="noopener noreferrer" href="https://github.com/OpenLiberty/guide-okd/issues">Raise an issue</a> to share feedback</p>
                <p><a target="_blank" rel="noopener noreferrer" href="https://github.com/OpenLiberty/guide-okd/pulls">Create a pull request</a> to contribute to this guide</p>
            

            <h3 id="need_help">Need help?</h3>
            <p><a target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/questions/tagged/open-liberty">Ask a question on Stack Overflow</a></p>

            <h3>Like Open Liberty? Star our repo on GitHub.</h3>
            <a class="github-button" href="https://github.com/OpenLiberty/open-liberty" data-icon="octicon-star" aria-label="Star OpenLiberty/open-liberty on GitHub" target="_blank" rel="noopener noreferrer">Star</a>
        </div>
        <div id="end_of_guide_right_section">
            <h3 id="where_to_next">Where to next?</h3>

            
            

            <!-- Related guides section -->
            
            <div id="related-guides">
                <div id="related-guides-cards" class="row">
                
                    
                    
                    
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/istio-intro.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Managing microservice traffic using Istio</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">30 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/microprofile-istio-retry-fallback.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Developing fault-tolerant microservices with Istio Retry and MicroProfile Fallback</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">30 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/kubernetes-intro.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Deploying microservices to Kubernetes</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">25 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/containerize.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Containerizing microservices</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">20 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                </div>
            </div>
            
        </div>
    </div>



    </main>

    



<footer>
    <div id="footer_gray_background">
        <div id="footer_top_container" class="footer_container container-fluid">
            <div id="footer_project_container">
                <span id="footer_open_liberty"></span>
                <p id="footer_project">IBM 开放式源代码项目</p>
            </div>
            <div id="footer_round_links_container">
                <a id="footer_github_link" class="footer_round_btn" href="https://github.com/OpenLiberty/" target="_blank" rel="noopener noreferrer" aria-label="Github"></a>
                <a id="footer_twitter_link" class="footer_round_btn" href="https://twitter.com/OpenLibertyIO" target="_blank" rel="noopener noreferrer" aria-label="Twitter"></a>
                <a id="footer_stackoverflow_link" class="footer_round_btn" href="https://stackoverflow.com/questions/tagged/open-liberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty questions on Stack Overflow"></a>
                <a id="footer_groupsio_link" class="footer_round_btn" href="https://groups.io/g/openliberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Groups.io"></a>
                <a id="footer_gitter_link" class="footer_round_btn" href="https://app.gitter.im/#/room/#OpenLiberty_development:gitter.im" target="_blank" rel="noopener" aria-label="Open Liberty Gitter"></a>
            </div>
        </div>         
    </div>

    <div id="footer_bottom_container" class="footer_container container-fluid">
        <div id="footer_bottom_left_section">
            <p id="footer_copyright">© Copyright IBM Corp. 2017, 2023</p>
            <p class="vertical_bar">|</p>
            <a id="footer_privacy_policy_link" href="https://www.ibm.com/privacy/" target="_blank" rel="noopener noreferrer" class="left_footer_link">隐私策略</a>
            <p class="vertical_bar">|</p>
            <a id="footer_license_link" href="https://github.com/OpenLiberty/open-liberty/blob/release/LICENSE" target="_blank" rel="noopener noreferrer" class="left_footer_link">许可证</a>
            <p class="vertical_bar">|</p>
            <a id="footer_logos_link" href="https://github.com/OpenLiberty/logos" target="_blank" rel="noopener noreferrer" class="left_footer_link">洛戈斯</a>
        </div>
        <div id="footer_bottom_right_section">
            <a id="footer_docs_link" href="/docs" aria-label="Open Liberty Docs" class="right_footer_link blue_link_light_background">文档</a>
            <a id="footer_blog_link" href="/blog" aria-label="Open Liberty Blog" class="right_footer_link blue_link_light_background">博客</a>
            <a id="footer_support_link" href="/support" aria-label="Open Liberty Support" class="right_footer_link blue_link_light_background">支持</a>
        </div>
    </div>
</footer>

<!-- PRE-LOADED IMAGES FOR ON HOVER BEHAVIOR -->
<div class="d-none hidden">
    <img src="/img/Footer_GitCat_Hover.svg" alt="OpenLiberty Github link">
    <img src="/img/Footer_TwitterBird_Hover.svg" alt="OpenLibertyIO Twitter link">
    <img src="/img/Footer_StackO_Hover.svg" alt="Open-liberty Stack Overflow link">
    <img src="/img/Footer_GroupsIO_Hover.svg" alt="Openliberty Groups IO link">
    <img src="/img/footer_gitter_hover.svg" alt="Openliberty Gitter link">
</div>

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js" integrity="sha512-lzilC+JFd6YV8+vQRNRtU7DOqv5Sa9Ek53lXt/k91HZTJpytHS1L6l1mMKR9K6VVoDt4LiEXaa6XBrYk1YhGTQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>


<script type="text/javascript" src="/zh-Hans/assets/devEnvironment.js"></script>




  <script type="text/javascript" src="/zh-Hans/assets/guide-common.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/toc.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/tabs.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/guide-static.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/guide-multipane-static.js"></script>


<script type="text/javascript" src="/zh-Hans/assets/openliberty.js"></script>

  </body>

</html>
