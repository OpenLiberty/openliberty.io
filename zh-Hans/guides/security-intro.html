<!DOCTYPE html>
<html lang="zh-Hans">

  





<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>
    
      Securing a Java web application using the Jakarta EE Security API
    
  </title>
  <meta name="description" content="A getting started tutorial with examples of how to secure a Java EE or Jakarta EE web application through authentication and authorization with a user registry by using the Jakarta EE Security API.">

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
  

  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/openliberty.css">
  <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/coderay-custom.css">

  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/header.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/header-dark.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/toc-multipane-static.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/end-of-guide.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-card.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/tabs.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-common.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-multipane.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-multipane-static.css">
  

  

  

  <link rel="canonical" href="https://openliberty.io/zh-Hans/guides/security-intro">
  <link rel="alternate" type="application/rss+xml" title="Open Liberty" href="/zh-Hans/feed.xml">
  <link href="https://fonts.googleapis.com/css?family=Asap:400,500" rel="stylesheet">
    
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@OpenLibertyIO" />
  <meta name="twitter:title" content="Securing a Java web application using the Jakarta EE Security API" />
  <meta name="twitter:description" content="A getting started tutorial with examples of how to secure a Java EE or Jakarta EE web application through authentication and authorization with a user registry by using the Jakarta EE Security API." />

  <meta property='og:title' content="Securing a Java web application using the Jakarta EE Security API" />
  <meta property='og:image' content="https://openliberty.io/img/twitter_card.jpg" />
  <meta property='og:image:alt' content="Open Liberty Logo" />
  <meta property='og:description' content="A getting started tutorial with examples of how to secure a Java EE or Jakarta EE web application through authentication and authorization with a user registry by using the Jakarta EE Security API." />
  <meta property='og:url' content="https://openliberty.io/zh-Hans/guides/security-intro" />
  <meta property='og:type' content="website" />
  
  <meta name="google-site-verification" content="h2P030H9b66CyL1nEmWfrZB8Fr14h9LmVMG7Ur0caBs" />

  
      <meta name="robots" content="noindex" />
  

  <script async defer src="https://buttons.github.io/buttons.js"></script>
</head>


  <body>
    
    

    


<!--  -->

<header>
    <nav id="nav_bar">
        <div id="nav_header">
            <a id="home_link" href="/" aria-label="Open Liberty Home">
                <img id="ol_logo" src="/img/docs_openliberty_logo.png" alt="Open Liberty Logo">
            </a>
            <button id="hamburger_toggle_button" onclick="$('#nav_bar').toggleClass('responsive');">
                <span id="hamburger_toggle_icon"></span>
            </button>
        </div>
        <div id="hamburger_menu">
            <ul class="nav_list">
                <li class="nav_link">
                    <a href="/start/">入门</a>
                </li>
                <li class="nav_link">
                    <a href="/guides/">指南</a>
                </li>
                <li class="nav_link">
                    <a href="/docs/">文档</a>
                </li>
                <li class="nav_link">
                    <a href="/support/">支持</a>
                </li>
                <li class="nav_link">
                    <a href="/blog/">博客</a>
                </li>
            </ul>
            <div id="header_round_links_container"> 
                <a id="header_twitter_link" class="header_round_button" href="https://twitter.com/OpenLibertyIO" target="_blank" rel="noopener noreferrer" aria-label="Twitter"></a>
                <a id="header_stackoverflow_link" class="header_round_button" href="https://stackoverflow.com/questions/tagged/open-liberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty questions on Stack Overflow"></a>
                <a id="header_groupsio_link" class="header_round_button" href="https://groups.io/g/openliberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Groups.io"></a>
                <a id="header_gitter_link" class="header_round_button" href="https://app.gitter.im/#/room/#OpenLiberty_development:gitter.im" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Gitter"></a>
            </div>
        </div>

    </nav>
</header>


    <main aria-label="Content">

      <!-- Build a list of all the documents in the guides code base -->
  
 

<!-- Remove any documents deemed private (archived, templates, etc) -->


<!-- Count number of guides from past 30 days-->
<!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
 

<!-- Sort list of guides by date with most recent first -->


<div id="background_container">
  <div id="toc_hotspot"></div>
  <!-- Guide's table of contents section -->
  <div id="toc_column" class="collapse inline open">
    <div id="toc_inner">
       
      <div id="close_container">
        <img id="toc_close_white" src="/img/toc_close_white.svg" alt="Close the table of contents" tabindex="0">
      </div>
      <h3 id="toc_title">Contents</h3>
      <div id="toc_container"><ul class="sectlevel1">
<li><a href="#what-youll-learn">What you’ll learn</a></li>
<li>
<a href="#getting-started">Getting started</a>
<ul class="sectlevel2">
<li><a href="#try-what-youll-build">Try what you’ll build</a></li>
</ul>
</li>
<li><a href="#adding-authentication-and-authorization">Adding authentication and authorization</a></li>
<li><a href="#configuring-the-user-registry">Configuring the user registry</a></li>
<li><a href="#running-the-application">Running the application</a></li>
<li>
<a href="#testing-the-application">Testing the application</a>
<ul class="sectlevel2">
<li><a href="#running-the-tests">Running the tests</a></li>
</ul>
</li>
<li><a href="#great-work-youre-done">Great work! You’re done!</a></li>
<li><a href="#guide-attribution">Guide Attribution</a></li>
</ul></div>
      <div id="toc_separator"></div>
      
      <h3 id="tag_title">标签</h3>
      <div id="tags_container"></div>
    </div>
  </div>
  <div id="toc_indicator" tabindex="0" aria-label="Open the table of contents" class="hidden">
    <img src="/img/arrow_white.svg" alt="arrow">
  </div>
  <div id="toc_line" class="open"></div>
  <!-- Entire guide section -->
  <div id="guide_column" class="position_relative open">
    <div id="guide_content">
      <!-- Guide header section -->
      <div id="guide_meta" class="sect1" tabindex="0">
        <h1 id="guide_title">Securing a web application</h1>
        <div id="duration_container">
          <img src="/img/guide_duration_clock_icon_large.svg" alt="duration">
          <span id="guide_duration">15 minutes</span>

          <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
          <!-- If new posts count is less than 4, use 4 most recent posts -->
           
          <!-- If new posts count is >= 4, use posts from last 30 days-->
          
          <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
          <!-- Count number of guides from past last 12 weeks that is 84 days-->
          <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
          
        </div>
        <div id="mobile_prereqs_section">
          <p id="mobile_prereqs_title">Prerequisites:</p>
          <div class="prereqs_list"></div>
          <div class="skills_network_container">
            <div class="skills_network_description"></div>
          </div>
        </div>
      </div>

      <div class="scroller_anchor"></div>
      <div id="mobile_toc_accordion_container" data-toggle="collapse" data-target="#toc_column" aria-expanded="false" aria-controls="toc_column" role="button">
        <div role="menuitem" id="mobile_toc_accordion">
          <button class="breadcrumb_hamburger toc-toggle collapsed" type="button" tabindex="0">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <img src="/img/toc_close_green.svg" class="TOC_Close_SVG hidden img-responsive" alt="Table of contents close button">
          </button>
          <span>Table of contents</span>
        </div>
      </div>

      <!-- Guide content section -->
      <div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note hidden">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This repository contains the guide documentation source. To view the guide in published form, view it on the <a href="https://openliberty.io/guides/security-intro.html" target="_blank" rel="noopener">Open Liberty website</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Learn how to secure a web application through authentication and authorization.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-youll-learn">What you’ll learn</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You’ll learn how to secure a web application by performing authentication and authorization using Jakarta EE Security. Authentication confirms the identity of the user by verifying a user’s credentials while authorization determines whether a user has access to restricted resources.</p>
</div>
<div class="paragraph">
<p>Jakarta EE Security provides capability to configure the basic authentication, form authentication, or custom form authentication mechanism by using annotations in servlets. It also provides the SecurityContext API for programmatic security checks in application code.</p>
</div>
<div class="paragraph">
<p>You’ll implement form authentication for a simple web front end. You’ll also learn to specify security constraints for a servlet and use the SecurityContext API to determine the role of a logged-in user.</p>
</div>
</div>
</div>
<div class="sect1 command">
<h2 id="getting-started">Getting started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The fastest way to work through this guide is to clone the <a href="https://github.com/openliberty/guide-security-intro.git" target="_blank" rel="noopener noreferrer">Git repository</a> and use the projects that are provided inside:</p>
</div>
<div id="git_clone" class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>git clone https://github.com/openliberty/guide-security-intro.git
cd guide-security-intro</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>start</code> directory contains the starting project that you will build upon.</p>
</div>
<div class="paragraph">
<p>The <code>finish</code> directory contains the finished project that you will build.</p>
</div>
<div class="paragraph">
<p>Before you begin, make sure you have all the necessary <span class="prerequisites">prerequisites</span>.</p>
</div>
<div class="sect2 command">
<h3 id="try-what-youll-build">Try what you’ll build</h3>
<div class="paragraph">
<p>The <code>finish</code> directory in the root of this guide contains the finished application. Give it a try before you proceed.</p>
</div>
<div class="paragraph">
<p>To try out the application, first go to the <code>finish</code> directory and run the following Maven goal to build the application and deploy it to Open Liberty:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>cd finish
mvn liberty:run</code></pre>
</div>
</div>
<div class="paragraph">
<p>After you see the following message, your Liberty instance is ready:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>The defaultServer server is ready to run a smarter planet.</pre>
</div>
</div>
<div class="paragraph">
<p>The finished application is secured with form authentication.</p>
</div>
<div class="paragraph">
<p>Navigate your browser to this URL to access the application: <a href="http://localhost:9080" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9080</a></p>
</div>
<div class="paragraph">
<p>The application automatically switches from an HTTP connection to a secure HTTPS connection and forwards you to a login page. If the browser gives you a certificate warning, it’s because the Open Liberty instance created a self-signed SSL certificate by default. You can follow your browser’s provided instructions to accept the certificate and continue.</p>
</div>
<div class="paragraph">
<p>Sign in to the application with one of the following user credentials from the user registry, which are provided to you:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 7.2164%;">
<col style="width: 30.9278%;">
<col style="width: 30.9278%;">
<col style="width: 30.928%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Username</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Password</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Role</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Group</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">alice</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">alicepwd</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">user</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">Employee</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bob</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">bobpwd</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">admin, user</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">Manager, Employee</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">carl</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">carlpwd</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">admin, user</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">TeamLead, Employee</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dave</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">davepwd</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">PartTime</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Notice that when you sign in as Bob or Carl, the browser redirects to the <code>admin</code> page and you can view their names and roles. When you sign in as Alice, you can only view Alice’s name. When you sign in as Dave, you are blocked and see an <code>Error 403: Authorization failed</code> message because Dave doesn’t have a role that is supported by the application.</p>
</div>
<div class="paragraph command">
<p>After you are finished checking out the application, stop the Liberty instance by pressing <code>CTRL+C</code> in the command-line session where you ran Liberty. Alternatively, you can run the <code>liberty:stop</code> goal from the <code>finish</code> directory in another shell session:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn liberty:stop</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-authentication-and-authorization">Adding authentication and authorization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For this application, users are asked to log in with a form when they access the application. Users are authenticated and depending on their roles, they are redirected to the pages that they are authorized to access. If authentication or authorization fails, users are sent to an error page. The application supports two roles, <code>admin</code> and <code>user</code>.</p>
</div>
<div class="paragraph">
<p>Navigate to the <code>start</code> directory to begin.</p>
</div>
<div class="paragraph command">
<p>When you run Open Liberty in <a href="https://openliberty.io/docs/latest/development-mode.html" target="_blank" rel="noopener">dev mode</a>, dev mode listens for file changes and automatically recompiles and deploys your updates whenever you save a new change. Run the following goal to start Open Liberty in dev mode:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn liberty:dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>After you see the following message, your Liberty instance is ready in dev mode:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>**************************************************************
*    Liberty is running in dev mode.</pre>
</div>
</div>
<div class="paragraph">
<p>Dev mode holds your command-line session to listen for file changes. Open another command-line session to continue, or open the project in your editor.</p>
</div>
<div class="listingblock code_command hotspot">
<div class="content">
<pre><mark>Create the <code>HomeServlet</code> class.</mark>
<code>src/main/java/io/openliberty/guides/ui/HomeServlet.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>HomeServlet.java</p>
</div>
<div class="listingblock code_column hide_tags=copyright,javaDoc1,javaDoc2">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="line-numbers"> 1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers"> 2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers"> 3</span><span class="comment"> * Copyright (c) 2018, 2022 IBM Corporation and others.</span>
<span class="line-numbers"> 4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers"> 5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers"> 6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers"> 7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers"> 8</span><span class="comment"> *</span>
<span class="line-numbers"> 9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers">10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers">11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers">12</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.ui</span>;
<span class="line-numbers">13</span>
<span class="line-numbers">14</span><span class="keyword">import</span> <span class="include">java.io.IOException</span>;
<span class="line-numbers">15</span><span class="keyword">import</span> <span class="include">jakarta.inject.Inject</span>;
<span class="line-numbers">16</span><span class="keyword">import</span> <span class="include">jakarta.security.enterprise.SecurityContext</span>;
<span class="line-numbers">17</span><span class="keyword">import</span> <span class="include">jakarta.security.enterprise.authentication.mechanism.http.FormAuthenticationMechanismDefinition</span>;
<span class="line-numbers">18</span><span class="keyword">import</span> <span class="include">jakarta.security.enterprise.authentication.mechanism.http.LoginToContinue</span>;
<span class="line-numbers">19</span><span class="keyword">import</span> <span class="include">jakarta.servlet.ServletException</span>;
<span class="line-numbers">20</span><span class="keyword">import</span> <span class="include">jakarta.servlet.annotation.HttpConstraint</span>;
<span class="line-numbers">21</span><span class="keyword">import</span> <span class="include">jakarta.servlet.annotation.ServletSecurity</span>;
<span class="line-numbers">22</span><span class="keyword">import</span> <span class="include">jakarta.servlet.annotation.WebServlet</span>;
<span class="line-numbers">23</span><span class="keyword">import</span> <span class="include">jakarta.servlet.http.HttpServlet</span>;
<span class="line-numbers">24</span><span class="keyword">import</span> <span class="include">jakarta.servlet.http.HttpServletRequest</span>;
<span class="line-numbers">25</span><span class="keyword">import</span> <span class="include">jakarta.servlet.http.HttpServletResponse</span>;
<span class="line-numbers">26</span>
<span class="line-numbers">27</span><span class="annotation">@WebServlet</span>(urlPatterns = <span class="string"><span class="delimiter">"</span><span class="content">/home</span><span class="delimiter">"</span></span>)
<span class="line-numbers">28</span><span class="comment">// tag::AuthenticationMechanism[]</span>
<span class="line-numbers">29</span><span class="annotation">@FormAuthenticationMechanismDefinition</span>(
<span class="line-numbers">30</span>    <span class="comment">// tag::loginToContinue[]</span>
<span class="line-numbers">31</span>    <span class="comment">// tag::errorPage[]</span>
<span class="line-numbers">32</span>    loginToContinue = <span class="annotation">@LoginToContinue</span>(errorPage = <span class="string"><span class="delimiter">"</span><span class="content">/error.html</span><span class="delimiter">"</span></span>,
<span class="line-numbers">33</span>    <span class="comment">// end::errorPage[]</span>
<span class="line-numbers">34</span>                                        <span class="comment">// tag::loginPage[]</span>
<span class="line-numbers">35</span>                                       loginPage = <span class="string"><span class="delimiter">"</span><span class="content">/welcome.html</span><span class="delimiter">"</span></span>))
<span class="line-numbers">36</span>                                        <span class="comment">// end::loginPage[]</span>
<span class="line-numbers">37</span>    <span class="comment">// end::loginToContinue[]</span>
<span class="line-numbers">38</span><span class="comment">// end::AuthenticationMechanism[]</span>
<span class="line-numbers">39</span><span class="comment">// tag::ServletSecurity[]</span>
<span class="line-numbers">40</span><span class="comment">// tag::HttpConstraint[]</span>
<span class="line-numbers">41</span><span class="annotation">@ServletSecurity</span>(value = <span class="annotation">@HttpConstraint</span>(rolesAllowed = { <span class="string"><span class="delimiter">"</span><span class="content">user</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">admin</span><span class="delimiter">"</span></span> },
<span class="line-numbers">42</span><span class="comment">// end::HttpConstraint[]</span>
<span class="line-numbers">43</span>  <span class="comment">// tag::TransportGuarantee[]</span>
<span class="line-numbers">44</span>  transportGuarantee = ServletSecurity.TransportGuarantee.CONFIDENTIAL))
<span class="line-numbers">45</span>  <span class="comment">// end::TransportGuarantee[]</span>
<span class="line-numbers">46</span><span class="comment">// end::ServletSecurity[]</span>
<span class="line-numbers">47</span><span class="comment">// tag::HomeServlet[]</span>
<span class="line-numbers">48</span><span class="directive">public</span> <span class="type">class</span> <span class="class">HomeServlet</span> <span class="directive">extends</span> HttpServlet {
<span class="line-numbers">49</span>
<span class="line-numbers">50</span>    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="type">long</span> serialVersionUID = <span class="integer">1L</span>;
<span class="line-numbers">51</span>
<span class="line-numbers">52</span>    <span class="annotation">@Inject</span>
<span class="line-numbers">53</span>    <span class="directive">private</span> SecurityContext securityContext;
<span class="line-numbers">54</span>
<span class="line-numbers">55</span>    <span class="comment">// tag::javaDoc1[]</span>
<span class="line-numbers">56</span>    <span class="comment">/**</span>
<span class="line-numbers">57</span><span class="comment">     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse</span>
<span class="line-numbers">58</span><span class="comment">     *      response)</span>
<span class="line-numbers">59</span><span class="comment">     */</span>
<span class="line-numbers">60</span>    <span class="comment">// end::javaDoc1[]</span>
<span class="line-numbers">61</span>    <span class="comment">// tag::doGet[]</span>
<span class="line-numbers">62</span>    <span class="directive">protected</span> <span class="type">void</span> doGet(HttpServletRequest request, HttpServletResponse response)
<span class="line-numbers">63</span>        <span class="directive">throws</span> ServletException, <span class="exception">IOException</span> {
<span class="line-numbers">64</span>        <span class="comment">// tag::CallerInRole[]</span>
<span class="line-numbers">65</span>        <span class="keyword">if</span> (securityContext.isCallerInRole(Utils.ADMIN)) {
<span class="line-numbers">66</span>            response.sendRedirect(<span class="string"><span class="delimiter">"</span><span class="content">/admin.jsf</span><span class="delimiter">"</span></span>);
<span class="line-numbers">67</span>        <span class="comment">// end::CallerInRole[]</span>
<span class="line-numbers">68</span>        } <span class="keyword">else</span> <span class="keyword">if</span>  (securityContext.isCallerInRole(Utils.USER)) {
<span class="line-numbers">69</span>            response.sendRedirect(<span class="string"><span class="delimiter">"</span><span class="content">/user.jsf</span><span class="delimiter">"</span></span>);
<span class="line-numbers">70</span>        }
<span class="line-numbers">71</span>    }
<span class="line-numbers">72</span>    <span class="comment">// end::doGet[]</span>
<span class="line-numbers">73</span>
<span class="line-numbers">74</span>    <span class="comment">// tag::javaDoc2[]</span>
<span class="line-numbers">75</span>    <span class="comment">/**</span>
<span class="line-numbers">76</span><span class="comment">     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse</span>
<span class="line-numbers">77</span><span class="comment">     *      response)</span>
<span class="line-numbers">78</span><span class="comment">     */</span>
<span class="line-numbers">79</span>    <span class="comment">// end::javaDoc2[]</span>
<span class="line-numbers">80</span>    <span class="directive">protected</span> <span class="type">void</span> doPost(HttpServletRequest request, HttpServletResponse response)
<span class="line-numbers">81</span>        <span class="directive">throws</span> ServletException, <span class="exception">IOException</span> {
<span class="line-numbers">82</span>        doGet(request, response);
<span class="line-numbers">83</span>    }
<span class="line-numbers">84</span>}
<span class="line-numbers">85</span><span class="comment">// end::HomeServlet[]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code class="hotspot=HomeServlet file=0">HomeServlet</code> servlet is the entry point of the application. To enable form authentication for the <code class="hotspot=HomeServlet file=0">HomeServlet</code> class, define the <code class="hotspot=AuthenticationMechanism file=0">@FormAuthenticationMechanismDefinition</code> annotation and set its <code class="hotspot=loginToContinue file=0">loginToContinue</code> attribute with a <code class="hotspot=loginToContinue file=0">@LoginToContinue</code> annotation. This <code class="hotspot=AuthenticationMechanism file=0">@FormAuthenticationMechanismDefinition</code> annotation defines <code class="hotspot=loginPage file=0">welcome.html</code> as the login page and <code class="hotspot=errorPage file=0">error.html</code> as the error page.</p>
</div>
<div class="paragraph">
<p>The <code class="hotspot=loginPage file=0">welcome.html</code> page implements the login form, and the <code class="hotspot=errorPage file=0">error.html</code> page implements the error page. Both pages are provided for you under the <code>src/main/webapp</code> directory. The login form in the <code class="hotspot=loginPage file=0">welcome.html</code> page uses the <code>j_security_check</code> action, which is defined by Jakarta EE and available by default.</p>
</div>
<div class="paragraph">
<p>Authorization determines whether a user can access a resource. To restrict access to authenticated users with <code>user</code> and <code>admin</code> roles, define the <code class="hotspot=ServletSecurity file=0">@ServletSecurity</code> annotation with the <code class="hotspot=HttpConstraint file=0">@HttpConstraint</code> annotation and set the <code class="hotspot=HttpConstraint file=0">rolesAllowed</code> attribute to these two roles.</p>
</div>
<div class="paragraph">
<p>The <code class="hotspot=TransportGuarantee file=0">transportGuarantee</code> attribute defines the constraint on the traffic between the client and the application. Set it to <code class="hotspot=TransportGuarantee file=0">CONFIDENTIAL</code> to enforce that all user data must be encrypted, which is why an HTTP connection from a browser switches to HTTPS.</p>
</div>
<div class="paragraph">
<p>The SecurityContext interface provides programmatic access to the Jakarta EE Security API. Inject a SecurityContext instance into the <code class="hotspot=HomeServlet file=0">HomeServlet</code> class. The <code class="hotspot=doGet file=0">doGet()</code> method uses the <code class="hotspot=CallerInRole file=0">isCallerInRole()</code> method from the SecurityContext API to check a user’s role and then forwards the response to the appropriate page.</p>
</div>
<div class="paragraph">
<p>The <code class="hotspot=webxmlsecurity file=1">src/main/webapp/WEB-INF/web.xml</code> file contains the rest of the security declaration for the application.</p>
</div>
<div class="paragraph">
<p>web.xml</p>
</div>
<div class="listingblock code_column hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="line-numbers"> 1</span><span class="preprocessor">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="line-numbers"> 2</span><span class="comment">&lt;!-- tag::copyright[] --&gt;</span>
<span class="line-numbers"> 3</span><span class="comment">&lt;!--</span>
<span class="line-numbers"> 4</span><span class="comment">    Copyright (c) 2018, 2019 IBM Corp.</span>
<span class="line-numbers"> 5</span><span class="comment"></span>
<span class="line-numbers"> 6</span><span class="comment">    Licensed under the Apache License, Version 2.0 (the "License");</span>
<span class="line-numbers"> 7</span><span class="comment">    you may not use this file except in compliance with the License.</span>
<span class="line-numbers"> 8</span><span class="comment">    You may obtain a copy of the License at</span>
<span class="line-numbers"> 9</span><span class="comment"></span>
<span class="line-numbers">10</span><span class="comment">        http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="line-numbers">11</span><span class="comment"></span>
<span class="line-numbers">12</span><span class="comment">    Unless required by applicable law or agreed to in writing, software</span>
<span class="line-numbers">13</span><span class="comment">    distributed under the License is distributed on an "AS IS" BASIS,</span>
<span class="line-numbers">14</span><span class="comment">    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="line-numbers">15</span><span class="comment">    See the License for the specific language governing permissions and</span>
<span class="line-numbers">16</span><span class="comment">    limitations under the License.</span>
<span class="line-numbers">17</span><span class="comment">--&gt;</span>
<span class="line-numbers">18</span><span class="comment">&lt;!-- end::copyright[]--&gt;</span>
<span class="line-numbers">19</span><span class="comment">&lt;!-- tag::webxml[] --&gt;</span>
<span class="line-numbers">20</span><span class="tag">&lt;web-app</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/javaee</span><span class="delimiter">"</span></span> 
<span class="line-numbers">21</span>    <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
<span class="line-numbers">22</span>    <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd</span><span class="delimiter">"</span></span>
<span class="line-numbers">23</span>    <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">"</span><span class="content">3.1</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers">24</span>    <span class="tag">&lt;display-name&gt;</span>Liberty Project<span class="tag">&lt;/display-name&gt;</span>
<span class="line-numbers">25</span>
<span class="line-numbers">26</span>    <span class="comment">&lt;!-- WebAppJSF: Faces Servlet --&gt;</span>
<span class="line-numbers">27</span>    <span class="tag">&lt;servlet&gt;</span>
<span class="line-numbers">28</span>      <span class="tag">&lt;servlet-name&gt;</span>Faces Servlet<span class="tag">&lt;/servlet-name&gt;</span>
<span class="line-numbers">29</span>      <span class="tag">&lt;servlet-class&gt;</span>jakarta.faces.webapp.FacesServlet<span class="tag">&lt;/servlet-class&gt;</span>
<span class="line-numbers">30</span>      <span class="tag">&lt;load-on-startup&gt;</span>1<span class="tag">&lt;/load-on-startup&gt;</span>
<span class="line-numbers">31</span>    <span class="tag">&lt;/servlet&gt;</span>
<span class="line-numbers">32</span>
<span class="line-numbers">33</span>    <span class="comment">&lt;!-- WebAppJSF: Faces Servlet Mapping --&gt;</span>
<span class="line-numbers">34</span>    <span class="tag">&lt;servlet-mapping&gt;</span>
<span class="line-numbers">35</span>      <span class="tag">&lt;servlet-name&gt;</span>Faces Servlet<span class="tag">&lt;/servlet-name&gt;</span>
<span class="line-numbers">36</span>      <span class="tag">&lt;url-pattern&gt;</span>*.jsf<span class="tag">&lt;/url-pattern&gt;</span>
<span class="line-numbers">37</span>    <span class="tag">&lt;/servlet-mapping&gt;</span>
<span class="line-numbers">38</span>
<span class="line-numbers">39</span>    <span class="tag">&lt;welcome-file-list&gt;</span>
<span class="line-numbers">40</span>      <span class="tag">&lt;welcome-file&gt;</span>/index.html<span class="tag">&lt;/welcome-file&gt;</span>
<span class="line-numbers">41</span>    <span class="tag">&lt;/welcome-file-list&gt;</span>
<span class="line-numbers">42</span>
<span class="line-numbers">43</span>    <span class="comment">&lt;!-- tag::webxmlsecurity[] --&gt;</span>
<span class="line-numbers">44</span>    <span class="comment">&lt;!-- SECURITY ROLES --&gt;</span>
<span class="line-numbers">45</span>    <span class="comment">&lt;!-- tag::security-role[] --&gt;</span>
<span class="line-numbers">46</span>    <span class="tag">&lt;security-role&gt;</span>
<span class="line-numbers">47</span>      <span class="comment">&lt;!-- tag::role-name-admin[] --&gt;</span>
<span class="line-numbers">48</span>      <span class="tag">&lt;role-name&gt;</span>admin<span class="tag">&lt;/role-name&gt;</span>
<span class="line-numbers">49</span>      <span class="comment">&lt;!-- end::role-name-admin[] --&gt;</span>
<span class="line-numbers">50</span>    <span class="tag">&lt;/security-role&gt;</span>
<span class="line-numbers">51</span>
<span class="line-numbers">52</span>    <span class="tag">&lt;security-role&gt;</span>
<span class="line-numbers">53</span>      <span class="comment">&lt;!-- tag::role-name-user[] --&gt;</span>
<span class="line-numbers">54</span>      <span class="tag">&lt;role-name&gt;</span>user<span class="tag">&lt;/role-name&gt;</span>
<span class="line-numbers">55</span>      <span class="comment">&lt;!-- end::role-name-user[] --&gt;</span>
<span class="line-numbers">56</span>    <span class="tag">&lt;/security-role&gt;</span>
<span class="line-numbers">57</span>    <span class="comment">&lt;!-- end::security-role[] --&gt;</span>
<span class="line-numbers">58</span>
<span class="line-numbers">59</span>    <span class="comment">&lt;!-- SECURITY CONSTRAINTS --&gt;</span>
<span class="line-numbers">60</span>    <span class="comment">&lt;!-- tag::security-constraint[] --&gt;</span>
<span class="line-numbers">61</span>    <span class="tag">&lt;security-constraint&gt;</span>
<span class="line-numbers">62</span>      <span class="tag">&lt;web-resource-collection&gt;</span>
<span class="line-numbers">63</span>        <span class="tag">&lt;web-resource-name&gt;</span>AdminViewProperties<span class="tag">&lt;/web-resource-name&gt;</span>
<span class="line-numbers">64</span>        <span class="comment">&lt;!-- tag::url-pattern-admin[] --&gt;</span>
<span class="line-numbers">65</span>        <span class="tag">&lt;url-pattern&gt;</span>/admin.jsf<span class="tag">&lt;/url-pattern&gt;</span>
<span class="line-numbers">66</span>        <span class="comment">&lt;!-- end::url-pattern-admin[] --&gt;</span>
<span class="line-numbers">67</span>        <span class="tag">&lt;http-method&gt;</span>GET<span class="tag">&lt;/http-method&gt;</span>
<span class="line-numbers">68</span>      <span class="tag">&lt;/web-resource-collection&gt;</span>
<span class="line-numbers">69</span>      <span class="tag">&lt;auth-constraint&gt;</span>
<span class="line-numbers">70</span>        <span class="tag">&lt;role-name&gt;</span>admin<span class="tag">&lt;/role-name&gt;</span>
<span class="line-numbers">71</span>      <span class="tag">&lt;/auth-constraint&gt;</span>
<span class="line-numbers">72</span>    <span class="tag">&lt;/security-constraint&gt;</span>
<span class="line-numbers">73</span>
<span class="line-numbers">74</span>    <span class="tag">&lt;security-constraint&gt;</span>
<span class="line-numbers">75</span>      <span class="tag">&lt;web-resource-collection&gt;</span>
<span class="line-numbers">76</span>        <span class="tag">&lt;web-resource-name&gt;</span>UserViewProperties<span class="tag">&lt;/web-resource-name&gt;</span>
<span class="line-numbers">77</span>        <span class="comment">&lt;!-- tag::url-pattern-user[] --&gt;</span>
<span class="line-numbers">78</span>        <span class="tag">&lt;url-pattern&gt;</span>/user.jsf<span class="tag">&lt;/url-pattern&gt;</span>
<span class="line-numbers">79</span>        <span class="comment">&lt;!-- end::url-pattern-user[] --&gt;</span>
<span class="line-numbers">80</span>        <span class="tag">&lt;http-method&gt;</span>GET<span class="tag">&lt;/http-method&gt;</span>
<span class="line-numbers">81</span>      <span class="tag">&lt;/web-resource-collection&gt;</span>
<span class="line-numbers">82</span>      <span class="tag">&lt;auth-constraint&gt;</span>
<span class="line-numbers">83</span>        <span class="tag">&lt;role-name&gt;</span>user<span class="tag">&lt;/role-name&gt;</span>
<span class="line-numbers">84</span>      <span class="tag">&lt;/auth-constraint&gt;</span>
<span class="line-numbers">85</span>    <span class="tag">&lt;/security-constraint&gt;</span>
<span class="line-numbers">86</span>    <span class="tag">&lt;deny-uncovered-http-methods</span><span class="tag">/&gt;</span>
<span class="line-numbers">87</span>    <span class="comment">&lt;!-- end::security-constraint[] --&gt;</span>
<span class="line-numbers">88</span>    <span class="comment">&lt;!-- end::webxmlsecurity[] --&gt;</span>
<span class="line-numbers">89</span>
<span class="line-numbers">90</span>    <span class="comment">&lt;!-- Handle 403 Error --&gt;</span>
<span class="line-numbers">91</span>    <span class="tag">&lt;error-page&gt;</span>
<span class="line-numbers">92</span>      <span class="tag">&lt;error-code&gt;</span>403<span class="tag">&lt;/error-code&gt;</span>
<span class="line-numbers">93</span>      <span class="tag">&lt;location&gt;</span>/error403.html<span class="tag">&lt;/location&gt;</span>
<span class="line-numbers">94</span>    <span class="tag">&lt;/error-page&gt;</span>
<span class="line-numbers">95</span><span class="tag">&lt;/web-app&gt;</span>
<span class="line-numbers">96</span><span class="comment">&lt;!-- end::webxml[] --&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code class="hotspot=security-role file=1">security-role</code> elements define the roles that are supported by the application, which are <code class="hotspot=role-name-user file=1">user</code> and <code class="hotspot=role-name-admin file=1">admin</code>. The <code class="hotspot=security-constraint file=1">security-constraint</code> elements specify that JSF resources like the <code class="hotspot=url-pattern-user file=1">user.jsf</code> and <code class="hotspot=url-pattern-admin file=1">admin.jsf</code> pages can be accessed only by users with <code class="hotspot=role-name-user file=1">user</code> and <code class="hotspot=role-name-admin file=1">admin</code> roles.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-the-user-registry">Configuring the user registry</h2>
<div class="sectionbody">
<div class="paragraph">
<p>User registries store user account information, such as username and password, for use by applications to perform security-related operations. Typically, Open Liberty would be configured to use an external registry like a Lightweight Directory Access Protocol (LDAP) registry. Applications would access information in the registry for authentication and authorization by using APIs like the Jakarta EE Security API.</p>
</div>
<div class="paragraph">
<p>Open Liberty provides an easy-to-use basic user registry for developers, which you will configure.</p>
</div>
<div class="listingblock code_command hotspot">
<div class="content">
<pre><mark>Create the <code>userRegistry</code> configuration file.</mark>
<code>src/main/liberty/config/userRegistry.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>userRegistry.xml</p>
</div>
<div class="listingblock code_column">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="line-numbers"> 1</span><span class="tag">&lt;server</span> <span class="attribute-name">description</span>=<span class="string"><span class="delimiter">"</span><span class="content">Sample Liberty server</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers"> 2</span>  <span class="tag">&lt;basicRegistry</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">basic</span><span class="delimiter">"</span></span> <span class="attribute-name">realm</span>=<span class="string"><span class="delimiter">"</span><span class="content">WebRealm</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers"> 3</span>    <span class="comment">&lt;!-- tag::user-bob[] --&gt;</span>
<span class="line-numbers"> 4</span>    <span class="tag">&lt;user</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">bob</span><span class="delimiter">"</span></span>
<span class="line-numbers"> 5</span>      <span class="attribute-name">password</span>=<span class="string"><span class="delimiter">"</span><span class="content">{xor}PTA9Lyg7</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span> <span class="comment">&lt;!-- bobpwd --&gt;</span>
<span class="line-numbers"> 6</span>    <span class="comment">&lt;!-- end::user-bob[] --&gt;</span>
<span class="line-numbers"> 7</span>    <span class="comment">&lt;!-- tag::user-alice[] --&gt;</span>
<span class="line-numbers"> 8</span>    <span class="tag">&lt;user</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">alice</span><span class="delimiter">"</span></span>
<span class="line-numbers"> 9</span>      <span class="attribute-name">password</span>=<span class="string"><span class="delimiter">"</span><span class="content">{xor}PjM2PDovKDs=</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>  <span class="comment">&lt;!-- alicepwd --&gt;</span>
<span class="line-numbers">10</span>    <span class="comment">&lt;!-- end::user-alice[] --&gt;</span>
<span class="line-numbers">11</span>    <span class="comment">&lt;!-- tag::user-carl[] --&gt;</span>
<span class="line-numbers">12</span>    <span class="tag">&lt;user</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">carl</span><span class="delimiter">"</span></span>
<span class="line-numbers">13</span>      <span class="attribute-name">password</span>=<span class="string"><span class="delimiter">"</span><span class="content">{xor}PD4tMy8oOw==</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>  <span class="comment">&lt;!-- carlpwd --&gt;</span>
<span class="line-numbers">14</span>    <span class="comment">&lt;!-- end::user-carl[] --&gt;</span>
<span class="line-numbers">15</span>    <span class="comment">&lt;!-- tag::user-dave[] --&gt;</span>
<span class="line-numbers">16</span>    <span class="tag">&lt;user</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">dave</span><span class="delimiter">"</span></span>
<span class="line-numbers">17</span>      <span class="attribute-name">password</span>=<span class="string"><span class="delimiter">"</span><span class="content">{xor}Oz4pOi8oOw==</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>  <span class="comment">&lt;!-- davepwd --&gt;</span>
<span class="line-numbers">18</span>    <span class="comment">&lt;!-- end::user-dave[] --&gt;</span>
<span class="line-numbers">19</span>
<span class="line-numbers">20</span>    <span class="comment">&lt;!-- tag::group-name-Manager[] --&gt;</span>
<span class="line-numbers">21</span>    <span class="tag">&lt;group</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">Manager</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers">22</span>      <span class="tag">&lt;member</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">bob</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>
<span class="line-numbers">23</span>    <span class="tag">&lt;/group&gt;</span>
<span class="line-numbers">24</span>    <span class="comment">&lt;!-- end::group-name-Manager[] --&gt;</span>
<span class="line-numbers">25</span>
<span class="line-numbers">26</span>    <span class="comment">&lt;!-- tag::group-name-TeamLead[] --&gt;</span>
<span class="line-numbers">27</span>    <span class="tag">&lt;group</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">TeamLead</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers">28</span>      <span class="tag">&lt;member</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">carl</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>
<span class="line-numbers">29</span>    <span class="tag">&lt;/group&gt;</span>
<span class="line-numbers">30</span>    <span class="comment">&lt;!-- end::group-name-TeamLead[]--&gt;</span>
<span class="line-numbers">31</span>    
<span class="line-numbers">32</span>    <span class="comment">&lt;!-- tag::group-name-Employee[] --&gt;</span>
<span class="line-numbers">33</span>    <span class="tag">&lt;group</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">Employee</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers">34</span>      <span class="tag">&lt;member</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">alice</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>
<span class="line-numbers">35</span>      <span class="tag">&lt;member</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">bob</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>
<span class="line-numbers">36</span>      <span class="tag">&lt;member</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">carl</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>
<span class="line-numbers">37</span>    <span class="tag">&lt;/group&gt;</span>
<span class="line-numbers">38</span>    <span class="comment">&lt;!-- end::group-name-Employee[] --&gt;</span>
<span class="line-numbers">39</span>
<span class="line-numbers">40</span>    <span class="comment">&lt;!-- tag::group-name-PartTime[] --&gt;</span>
<span class="line-numbers">41</span>    <span class="tag">&lt;group</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">PartTime</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers">42</span>      <span class="tag">&lt;member</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">dave</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>
<span class="line-numbers">43</span>    <span class="tag">&lt;/group&gt;</span>
<span class="line-numbers">44</span>    <span class="comment">&lt;!-- end::group-name-PartTime[] --&gt;</span>
<span class="line-numbers">45</span>  <span class="tag">&lt;/basicRegistry&gt;</span>
<span class="line-numbers">46</span><span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The registry has four users, <code class="hotspot=user-bob file=0">bob</code>, <code class="hotspot=user-alice file=0">alice</code>, <code class="hotspot=user-carl file=0">carl</code>, and <code class="hotspot=user-dave file=0">dave</code>. It also has four groups: <code class="hotspot=group-name-Manager file=0">Manager</code>, <code class="hotspot=group-name-TeamLead file=0">TeamLead</code>, <code class="hotspot=group-name-Employee file=0">Employee</code>, and <code class="hotspot=group-name-PartTime file=0">PartTime</code>. Each user belongs to one or more groups.</p>
</div>
<div class="paragraph">
<p>It is not recommended to store passwords in plain text. The passwords in the <code class="hotspot file=0">userRegistry.xml</code> file are encoded by using the Liberty <code>securityUtility</code> command with XOR encoding.</p>
</div>
<div class="paragraph">
<p>server.xml</p>
</div>
<div class="listingblock code_column">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="line-numbers"> 1</span><span class="comment">&lt;!-- tag::serverxml[] --&gt;</span>
<span class="line-numbers"> 2</span><span class="tag">&lt;server</span> <span class="attribute-name">description</span>=<span class="string"><span class="delimiter">"</span><span class="content">Sample Liberty server</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers"> 3</span>
<span class="line-numbers"> 4</span>  <span class="tag">&lt;featureManager&gt;</span>
<span class="line-numbers"> 5</span>    <span class="tag">&lt;feature&gt;</span>appSecurity-5.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 6</span>    <span class="tag">&lt;feature&gt;</span>faces-4.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 7</span>    <span class="tag">&lt;feature&gt;</span>servlet-6.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 8</span>  <span class="tag">&lt;/featureManager&gt;</span>
<span class="line-numbers"> 9</span>
<span class="line-numbers">10</span>  <span class="tag">&lt;variable</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">default.http.port</span><span class="delimiter">"</span></span> <span class="attribute-name">defaultValue</span>=<span class="string"><span class="delimiter">"</span><span class="content">9080</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">11</span>  <span class="tag">&lt;variable</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">default.https.port</span><span class="delimiter">"</span></span> <span class="attribute-name">defaultValue</span>=<span class="string"><span class="delimiter">"</span><span class="content">9443</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">12</span>
<span class="line-numbers">13</span>  <span class="tag">&lt;httpEndpoint</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">defaultHttpEndpoint</span><span class="delimiter">"</span></span>
<span class="line-numbers">14</span>    <span class="attribute-name">httpPort</span>=<span class="string"><span class="delimiter">"</span><span class="content">${default.http.port}</span><span class="delimiter">"</span></span>
<span class="line-numbers">15</span>    <span class="attribute-name">httpsPort</span>=<span class="string"><span class="delimiter">"</span><span class="content">${default.https.port}</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>
<span class="line-numbers">16</span>
<span class="line-numbers">17</span>  <span class="comment">&lt;!-- tag::location[] --&gt;</span>
<span class="line-numbers">18</span>  <span class="tag">&lt;include</span> <span class="attribute-name">location</span>=<span class="string"><span class="delimiter">"</span><span class="content">userRegistry.xml</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">19</span>  <span class="comment">&lt;!-- end::location[]--&gt;</span>
<span class="line-numbers">20</span>
<span class="line-numbers">21</span>  <span class="tag">&lt;application</span> <span class="attribute-name">location</span>=<span class="string"><span class="delimiter">"</span><span class="content">guide-security-intro.war</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">war</span><span class="delimiter">"</span></span>
<span class="line-numbers">22</span>               <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">guide-security-intro.war</span><span class="delimiter">"</span></span>
<span class="line-numbers">23</span>               <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">guide-security-intro.war</span><span class="delimiter">"</span></span> <span class="attribute-name">context-root</span>=<span class="string"><span class="delimiter">"</span><span class="content">/</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers">24</span>    <span class="comment">&lt;!-- tag::application-bnd[] --&gt;</span>
<span class="line-numbers">25</span>    <span class="tag">&lt;application-bnd&gt;</span>
<span class="line-numbers">26</span>      <span class="comment">&lt;!-- tag::Security[] --&gt;</span>
<span class="line-numbers">27</span>      <span class="comment">&lt;!-- tag::security-role-admin[] --&gt;</span>
<span class="line-numbers">28</span>      <span class="tag">&lt;security-role</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">admin</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers">29</span>      <span class="comment">&lt;!-- end::security-role-admin[] --&gt;</span>
<span class="line-numbers">30</span>        <span class="comment">&lt;!-- tag::Group[] --&gt;</span>
<span class="line-numbers">31</span>        <span class="comment">&lt;!-- tag::group-name-Manager[] --&gt;</span>
<span class="line-numbers">32</span>        <span class="tag">&lt;group</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">Manager</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>
<span class="line-numbers">33</span>        <span class="comment">&lt;!-- end::group-name-Manager[] --&gt;</span>
<span class="line-numbers">34</span>        <span class="comment">&lt;!-- tag::group-name-TeamLead[] --&gt;</span>
<span class="line-numbers">35</span>        <span class="tag">&lt;group</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">TeamLead</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>
<span class="line-numbers">36</span>        <span class="comment">&lt;!-- end::group-name-TeamLead[] --&gt;</span>
<span class="line-numbers">37</span>        <span class="comment">&lt;!-- end::Group[] --&gt;</span>
<span class="line-numbers">38</span>      <span class="tag">&lt;/security-role&gt;</span>
<span class="line-numbers">39</span>      <span class="comment">&lt;!-- tag::security-role-user[] --&gt;</span>
<span class="line-numbers">40</span>      <span class="tag">&lt;security-role</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">user</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers">41</span>      <span class="comment">&lt;!-- end::security-role-user[] --&gt;</span>
<span class="line-numbers">42</span>        <span class="comment">&lt;!-- tag::group-name-Employee[] --&gt;</span>
<span class="line-numbers">43</span>        <span class="tag">&lt;group</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">Employee</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>
<span class="line-numbers">44</span>        <span class="comment">&lt;!-- end::group-name-Employee[] --&gt;</span>
<span class="line-numbers">45</span>      <span class="tag">&lt;/security-role&gt;</span>
<span class="line-numbers">46</span>      <span class="comment">&lt;!-- end::Security[] --&gt;</span>
<span class="line-numbers">47</span>    <span class="tag">&lt;/application-bnd&gt;</span>
<span class="line-numbers">48</span>     <span class="comment">&lt;!-- end::application-bnd[] --&gt;</span>
<span class="line-numbers">49</span>  <span class="tag">&lt;/application&gt;</span>
<span class="line-numbers">50</span><span class="tag">&lt;/server&gt;</span>
<span class="line-numbers">51</span><span class="comment">&lt;!-- end::serverxml[] --&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the <code class="hotspot=location file=1">include</code> element to add the basic user registry configuration to your Liberty configuration. Open Liberty includes configuration information from the specified XML file in its configuration.</p>
</div>
<div class="paragraph">
<p>The <code class="hotspot file=1">server.xml</code> configuration file contains the security configuration of the Liberty under the <code class="hotspot=application-bnd file=1">application-bnd</code> element. Use the <code class="hotspot=Security file=1">security-role</code> and <code class="hotspot=Group hotspot=group-name-Employee file=1">group</code> elements to map the groups in the <code class="hotspot file=0">userRegistry.xml</code> file to the appropriate user roles supported by the application for proper user authorization. The <code class="hotspot=group-name-Manager file=1">Manager</code> and <code class="hotspot=group-name-TeamLead file=1">TeamLead</code> groups are mapped to the <code class="hotspot=security-role-admin file=1">admin</code> role while the <code class="hotspot=group-name-Employee file=1">Employee</code> group is mapped to the <code class="hotspot=security-role-user file=1">user</code> role.</p>
</div>
</div>
</div>
<div class="sect1 command">
<h2 id="running-the-application">Running the application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You started the Open Liberty in dev mode at the beginning of the guide, so all the changes were automatically picked up.</p>
</div>
<div class="paragraph">
<p>HomeServlet.java</p>
</div>
<div class="listingblock code_column hide_tags=copyright,javaDoc1,javaDoc2">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="line-numbers"> 1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers"> 2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers"> 3</span><span class="comment"> * Copyright (c) 2018, 2022 IBM Corporation and others.</span>
<span class="line-numbers"> 4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers"> 5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers"> 6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers"> 7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers"> 8</span><span class="comment"> *</span>
<span class="line-numbers"> 9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers">10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers">11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers">12</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.ui</span>;
<span class="line-numbers">13</span>
<span class="line-numbers">14</span><span class="keyword">import</span> <span class="include">java.io.IOException</span>;
<span class="line-numbers">15</span><span class="keyword">import</span> <span class="include">jakarta.inject.Inject</span>;
<span class="line-numbers">16</span><span class="keyword">import</span> <span class="include">jakarta.security.enterprise.SecurityContext</span>;
<span class="line-numbers">17</span><span class="keyword">import</span> <span class="include">jakarta.security.enterprise.authentication.mechanism.http.FormAuthenticationMechanismDefinition</span>;
<span class="line-numbers">18</span><span class="keyword">import</span> <span class="include">jakarta.security.enterprise.authentication.mechanism.http.LoginToContinue</span>;
<span class="line-numbers">19</span><span class="keyword">import</span> <span class="include">jakarta.servlet.ServletException</span>;
<span class="line-numbers">20</span><span class="keyword">import</span> <span class="include">jakarta.servlet.annotation.HttpConstraint</span>;
<span class="line-numbers">21</span><span class="keyword">import</span> <span class="include">jakarta.servlet.annotation.ServletSecurity</span>;
<span class="line-numbers">22</span><span class="keyword">import</span> <span class="include">jakarta.servlet.annotation.WebServlet</span>;
<span class="line-numbers">23</span><span class="keyword">import</span> <span class="include">jakarta.servlet.http.HttpServlet</span>;
<span class="line-numbers">24</span><span class="keyword">import</span> <span class="include">jakarta.servlet.http.HttpServletRequest</span>;
<span class="line-numbers">25</span><span class="keyword">import</span> <span class="include">jakarta.servlet.http.HttpServletResponse</span>;
<span class="line-numbers">26</span>
<span class="line-numbers">27</span><span class="annotation">@WebServlet</span>(urlPatterns = <span class="string"><span class="delimiter">"</span><span class="content">/home</span><span class="delimiter">"</span></span>)
<span class="line-numbers">28</span><span class="comment">// tag::AuthenticationMechanism[]</span>
<span class="line-numbers">29</span><span class="annotation">@FormAuthenticationMechanismDefinition</span>(
<span class="line-numbers">30</span>    <span class="comment">// tag::loginToContinue[]</span>
<span class="line-numbers">31</span>    <span class="comment">// tag::errorPage[]</span>
<span class="line-numbers">32</span>    loginToContinue = <span class="annotation">@LoginToContinue</span>(errorPage = <span class="string"><span class="delimiter">"</span><span class="content">/error.html</span><span class="delimiter">"</span></span>,
<span class="line-numbers">33</span>    <span class="comment">// end::errorPage[]</span>
<span class="line-numbers">34</span>                                        <span class="comment">// tag::loginPage[]</span>
<span class="line-numbers">35</span>                                       loginPage = <span class="string"><span class="delimiter">"</span><span class="content">/welcome.html</span><span class="delimiter">"</span></span>))
<span class="line-numbers">36</span>                                        <span class="comment">// end::loginPage[]</span>
<span class="line-numbers">37</span>    <span class="comment">// end::loginToContinue[]</span>
<span class="line-numbers">38</span><span class="comment">// end::AuthenticationMechanism[]</span>
<span class="line-numbers">39</span><span class="comment">// tag::ServletSecurity[]</span>
<span class="line-numbers">40</span><span class="comment">// tag::HttpConstraint[]</span>
<span class="line-numbers">41</span><span class="annotation">@ServletSecurity</span>(value = <span class="annotation">@HttpConstraint</span>(rolesAllowed = { <span class="string"><span class="delimiter">"</span><span class="content">user</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">admin</span><span class="delimiter">"</span></span> },
<span class="line-numbers">42</span><span class="comment">// end::HttpConstraint[]</span>
<span class="line-numbers">43</span>  <span class="comment">// tag::TransportGuarantee[]</span>
<span class="line-numbers">44</span>  transportGuarantee = ServletSecurity.TransportGuarantee.CONFIDENTIAL))
<span class="line-numbers">45</span>  <span class="comment">// end::TransportGuarantee[]</span>
<span class="line-numbers">46</span><span class="comment">// end::ServletSecurity[]</span>
<span class="line-numbers">47</span><span class="comment">// tag::HomeServlet[]</span>
<span class="line-numbers">48</span><span class="directive">public</span> <span class="type">class</span> <span class="class">HomeServlet</span> <span class="directive">extends</span> HttpServlet {
<span class="line-numbers">49</span>
<span class="line-numbers">50</span>    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="type">long</span> serialVersionUID = <span class="integer">1L</span>;
<span class="line-numbers">51</span>
<span class="line-numbers">52</span>    <span class="annotation">@Inject</span>
<span class="line-numbers">53</span>    <span class="directive">private</span> SecurityContext securityContext;
<span class="line-numbers">54</span>
<span class="line-numbers">55</span>    <span class="comment">// tag::javaDoc1[]</span>
<span class="line-numbers">56</span>    <span class="comment">/**</span>
<span class="line-numbers">57</span><span class="comment">     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse</span>
<span class="line-numbers">58</span><span class="comment">     *      response)</span>
<span class="line-numbers">59</span><span class="comment">     */</span>
<span class="line-numbers">60</span>    <span class="comment">// end::javaDoc1[]</span>
<span class="line-numbers">61</span>    <span class="comment">// tag::doGet[]</span>
<span class="line-numbers">62</span>    <span class="directive">protected</span> <span class="type">void</span> doGet(HttpServletRequest request, HttpServletResponse response)
<span class="line-numbers">63</span>        <span class="directive">throws</span> ServletException, <span class="exception">IOException</span> {
<span class="line-numbers">64</span>        <span class="comment">// tag::CallerInRole[]</span>
<span class="line-numbers">65</span>        <span class="keyword">if</span> (securityContext.isCallerInRole(Utils.ADMIN)) {
<span class="line-numbers">66</span>            response.sendRedirect(<span class="string"><span class="delimiter">"</span><span class="content">/admin.jsf</span><span class="delimiter">"</span></span>);
<span class="line-numbers">67</span>        <span class="comment">// end::CallerInRole[]</span>
<span class="line-numbers">68</span>        } <span class="keyword">else</span> <span class="keyword">if</span>  (securityContext.isCallerInRole(Utils.USER)) {
<span class="line-numbers">69</span>            response.sendRedirect(<span class="string"><span class="delimiter">"</span><span class="content">/user.jsf</span><span class="delimiter">"</span></span>);
<span class="line-numbers">70</span>        }
<span class="line-numbers">71</span>    }
<span class="line-numbers">72</span>    <span class="comment">// end::doGet[]</span>
<span class="line-numbers">73</span>
<span class="line-numbers">74</span>    <span class="comment">// tag::javaDoc2[]</span>
<span class="line-numbers">75</span>    <span class="comment">/**</span>
<span class="line-numbers">76</span><span class="comment">     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse</span>
<span class="line-numbers">77</span><span class="comment">     *      response)</span>
<span class="line-numbers">78</span><span class="comment">     */</span>
<span class="line-numbers">79</span>    <span class="comment">// end::javaDoc2[]</span>
<span class="line-numbers">80</span>    <span class="directive">protected</span> <span class="type">void</span> doPost(HttpServletRequest request, HttpServletResponse response)
<span class="line-numbers">81</span>        <span class="directive">throws</span> ServletException, <span class="exception">IOException</span> {
<span class="line-numbers">82</span>        doGet(request, response);
<span class="line-numbers">83</span>    }
<span class="line-numbers">84</span>}
<span class="line-numbers">85</span><span class="comment">// end::HomeServlet[]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Point your browser to the <a href="http://localhost:9080" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9080</a> URL.</p>
</div>
<div class="paragraph">
<p>As you can see, the browser gets automatically redirected from an HTTP connection to an HTTPS connection because the transport guarantee is defined in the <code class="hotspot file=0">HomeServlet</code> class.</p>
</div>
<div class="paragraph">
<p>You will see a login form because form authentication is implemented and configured. Sign in to the application by using one of the credentials from the following table. The credentials are defined in the configured user registry.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 7.2164%;">
<col style="width: 30.9278%;">
<col style="width: 30.9278%;">
<col style="width: 30.928%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Username</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Password</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Role</strong></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Group</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">alice</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">alicepwd</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">user</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">Employee</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bob</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">bobpwd</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">admin, user</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">Manager, Employee</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">carl</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">carlpwd</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">admin, user</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">TeamLead, Employee</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dave</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">davepwd</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">PartTime</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Notice that when you sign in as Bob or Carl, the browser redirects to the <code>admin</code> page and you can view their names and roles. When you sign in as Alice, you can only view Alice’s name. When you sign in as Dave, you are blocked and see an <code>Error 403: Authorization failed</code> message because Dave doesn’t have a role that is supported by the application.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing-the-application">Testing the application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Write the <code class="hotspot file=0">SecurityIT</code> class to test the authentication and authorization of the application.</p>
</div>
<div class="listingblock code_command hotspot">
<div class="content">
<pre><mark>Create the <code>SecurityIT</code> class.</mark>
<code>src/test/java/it/io/openliberty/guides/security/SecurityIT.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>SecurityIT.java</p>
</div>
<div class="listingblock code_column hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="line-numbers">  1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers">  2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers">  3</span><span class="comment"> * Copyright (c) 2018, 2022 IBM Corporation and others.</span>
<span class="line-numbers">  4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers">  5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers">  6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers">  7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers">  8</span><span class="comment"> *</span>
<span class="line-numbers">  9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers"> 10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers"> 11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers"> 12</span><span class="keyword">package</span> <span class="namespace">it.io.openliberty.guides.security</span>;
<span class="line-numbers"> 13</span>
<span class="line-numbers"> 14</span><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertEquals</span>;
<span class="line-numbers"> 15</span><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertTrue</span>;
<span class="line-numbers"> 16</span>
<span class="line-numbers"> 17</span><span class="keyword">import</span> <span class="include">java.net.URI</span>;
<span class="line-numbers"> 18</span><span class="keyword">import</span> <span class="include">java.util.ArrayList</span>;
<span class="line-numbers"> 19</span><span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="line-numbers"> 20</span>
<span class="line-numbers"> 21</span><span class="keyword">import</span> <span class="include">javax.net.ssl.SSLContext</span>;
<span class="line-numbers"> 22</span><span class="keyword">import</span> <span class="include">jakarta.servlet.http.HttpServletResponse</span>;
<span class="line-numbers"> 23</span>
<span class="line-numbers"> 24</span><span class="keyword">import</span> <span class="include">org.apache.http.HttpResponse</span>;
<span class="line-numbers"> 25</span><span class="keyword">import</span> <span class="include">org.apache.http.NameValuePair</span>;
<span class="line-numbers"> 26</span><span class="keyword">import</span> <span class="include">org.apache.http.client.HttpClient</span>;
<span class="line-numbers"> 27</span><span class="keyword">import</span> <span class="include">org.apache.http.client.config.CookieSpecs</span>;
<span class="line-numbers"> 28</span><span class="keyword">import</span> <span class="include">org.apache.http.client.config.RequestConfig</span>;
<span class="line-numbers"> 29</span><span class="keyword">import</span> <span class="include">org.apache.http.client.entity.UrlEncodedFormEntity</span>;
<span class="line-numbers"> 30</span><span class="keyword">import</span> <span class="include">org.apache.http.client.methods.HttpGet</span>;
<span class="line-numbers"> 31</span><span class="keyword">import</span> <span class="include">org.apache.http.client.methods.HttpPost</span>;
<span class="line-numbers"> 32</span><span class="keyword">import</span> <span class="include">org.apache.http.impl.client.HttpClientBuilder</span>;
<span class="line-numbers"> 33</span><span class="keyword">import</span> <span class="include">org.apache.http.message.BasicNameValuePair</span>;
<span class="line-numbers"> 34</span><span class="keyword">import</span> <span class="include">org.apache.http.util.EntityUtils</span>;
<span class="line-numbers"> 35</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.BeforeEach</span>;
<span class="line-numbers"> 36</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;
<span class="line-numbers"> 37</span>
<span class="line-numbers"> 38</span><span class="directive">public</span> <span class="type">class</span> <span class="class">SecurityIT</span> {
<span class="line-numbers"> 39</span>
<span class="line-numbers"> 40</span>    <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">String</span> urlHttp;
<span class="line-numbers"> 41</span>    <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">String</span> urlHttps;
<span class="line-numbers"> 42</span>
<span class="line-numbers"> 43</span>    <span class="annotation">@BeforeEach</span>
<span class="line-numbers"> 44</span>    <span class="directive">public</span> <span class="type">void</span> setup() <span class="directive">throws</span> <span class="exception">Exception</span> {
<span class="line-numbers"> 45</span>        urlHttp = <span class="string"><span class="delimiter">"</span><span class="content">http://localhost:</span><span class="delimiter">"</span></span> + <span class="predefined-type">System</span>.getProperty(<span class="string"><span class="delimiter">"</span><span class="content">http.port</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 46</span>        urlHttps = <span class="string"><span class="delimiter">"</span><span class="content">https://localhost:</span><span class="delimiter">"</span></span> + <span class="predefined-type">System</span>.getProperty(<span class="string"><span class="delimiter">"</span><span class="content">https.port</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 47</span>        ITUtils.trustAll();
<span class="line-numbers"> 48</span>    }
<span class="line-numbers"> 49</span>
<span class="line-numbers"> 50</span>    <span class="annotation">@Test</span>
<span class="line-numbers"> 51</span>    <span class="comment">// tag::testAuthenticationFail[]</span>
<span class="line-numbers"> 52</span>    <span class="directive">public</span> <span class="type">void</span> testAuthenticationFail() <span class="directive">throws</span> <span class="exception">Exception</span> {
<span class="line-numbers"> 53</span>        executeURL(<span class="string"><span class="delimiter">"</span><span class="content">/</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">bob</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">wrongpassword</span><span class="delimiter">"</span></span>, <span class="predefined-constant">true</span>, -<span class="integer">1</span>, <span class="string"><span class="delimiter">"</span><span class="content">Don't care</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 54</span>    }
<span class="line-numbers"> 55</span>    <span class="comment">// end::testAuthenticationFail[]</span>
<span class="line-numbers"> 56</span>
<span class="line-numbers"> 57</span>    <span class="annotation">@Test</span>
<span class="line-numbers"> 58</span>    <span class="comment">// tag::testAuthorizationForAdmin[]</span>
<span class="line-numbers"> 59</span>    <span class="directive">public</span> <span class="type">void</span> testAuthorizationForAdmin() <span class="directive">throws</span> <span class="exception">Exception</span> {
<span class="line-numbers"> 60</span>        executeURL(<span class="string"><span class="delimiter">"</span><span class="content">/</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">bob</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">bobpwd</span><span class="delimiter">"</span></span>, <span class="predefined-constant">false</span>,
<span class="line-numbers"> 61</span>            HttpServletResponse.SC_OK, <span class="string"><span class="delimiter">"</span><span class="content">admin, user</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 62</span>    }
<span class="line-numbers"> 63</span>    <span class="comment">// end::testAuthorizationForAdmin[]</span>
<span class="line-numbers"> 64</span>
<span class="line-numbers"> 65</span>    <span class="annotation">@Test</span>
<span class="line-numbers"> 66</span>    <span class="comment">// tag::testAuthorizationForUser[]</span>
<span class="line-numbers"> 67</span>    <span class="directive">public</span> <span class="type">void</span> testAuthorizationForUser() <span class="directive">throws</span> <span class="exception">Exception</span> {
<span class="line-numbers"> 68</span>        executeURL(<span class="string"><span class="delimiter">"</span><span class="content">/</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">alice</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">alicepwd</span><span class="delimiter">"</span></span>, <span class="predefined-constant">false</span>,
<span class="line-numbers"> 69</span>            HttpServletResponse.SC_OK, <span class="string"><span class="delimiter">"</span><span class="content">&lt;title&gt;User&lt;/title&gt;</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 70</span>    }
<span class="line-numbers"> 71</span>    <span class="comment">// end::testAuthorizationForUser[]</span>
<span class="line-numbers"> 72</span>
<span class="line-numbers"> 73</span>    <span class="annotation">@Test</span>
<span class="line-numbers"> 74</span>    <span class="comment">// tag::testAuthorizationFail[]</span>
<span class="line-numbers"> 75</span>    <span class="directive">public</span> <span class="type">void</span> testAuthorizationFail() <span class="directive">throws</span> <span class="exception">Exception</span> {
<span class="line-numbers"> 76</span>        executeURL(<span class="string"><span class="delimiter">"</span><span class="content">/</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">dave</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">davepwd</span><span class="delimiter">"</span></span>, <span class="predefined-constant">false</span>,
<span class="line-numbers"> 77</span>            HttpServletResponse.SC_FORBIDDEN, <span class="string"><span class="delimiter">"</span><span class="content">Error 403: Authorization failed</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 78</span>    }
<span class="line-numbers"> 79</span>    <span class="comment">// end::testAuthorizationFail[]</span>
<span class="line-numbers"> 80</span>
<span class="line-numbers"> 81</span>    <span class="directive">private</span> <span class="type">void</span> executeURL(
<span class="line-numbers"> 82</span>        <span class="predefined-type">String</span> testUrl, <span class="predefined-type">String</span> userid, <span class="predefined-type">String</span> password,
<span class="line-numbers"> 83</span>        <span class="type">boolean</span> expectLoginFail, <span class="type">int</span> expectedCode, <span class="predefined-type">String</span> expectedContent)
<span class="line-numbers"> 84</span>        <span class="directive">throws</span> <span class="exception">Exception</span> {
<span class="line-numbers"> 85</span>
<span class="line-numbers"> 86</span>        <span class="comment">// Use HttpClient to execute the testUrl by HTTP</span>
<span class="line-numbers"> 87</span>        <span class="predefined-type">URI</span> url = <span class="keyword">new</span> <span class="predefined-type">URI</span>(urlHttp + testUrl);
<span class="line-numbers"> 88</span>        HttpGet getMethod = <span class="keyword">new</span> HttpGet(url);
<span class="line-numbers"> 89</span>        HttpClientBuilder clientBuilder = HttpClientBuilder.create();
<span class="line-numbers"> 90</span>        <span class="predefined-type">SSLContext</span> sslContext = <span class="predefined-type">SSLContext</span>.getDefault();
<span class="line-numbers"> 91</span>        clientBuilder.setSSLContext(sslContext);
<span class="line-numbers"> 92</span>        clientBuilder.setDefaultRequestConfig(
<span class="line-numbers"> 93</span>            RequestConfig.custom().setCookieSpec(CookieSpecs.STANDARD).build());
<span class="line-numbers"> 94</span>        HttpClient client = clientBuilder.build();
<span class="line-numbers"> 95</span>        HttpResponse response = client.execute(getMethod);
<span class="line-numbers"> 96</span>
<span class="line-numbers"> 97</span>        <span class="comment">// Response should be login.html</span>
<span class="line-numbers"> 98</span>        <span class="predefined-type">String</span> loginBody = EntityUtils.toString(response.getEntity(), <span class="string"><span class="delimiter">"</span><span class="content">UTF-8</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 99</span>        assertTrue(loginBody.contains(<span class="string"><span class="delimiter">"</span><span class="content">window.location.assign</span><span class="delimiter">"</span></span>),
<span class="line-numbers">100</span>            <span class="string"><span class="delimiter">"</span><span class="content">Not redirected to home.html</span><span class="delimiter">"</span></span>);
<span class="line-numbers">101</span>        <span class="predefined-type">String</span><span class="type">[]</span> redirect = loginBody.split(<span class="string"><span class="delimiter">"</span><span class="content">'</span><span class="delimiter">"</span></span>);
<span class="line-numbers">102</span>
<span class="line-numbers">103</span>        <span class="comment">// Use j_security_check to login</span>
<span class="line-numbers">104</span>        HttpPost postMethod = <span class="keyword">new</span> HttpPost(urlHttps + <span class="string"><span class="delimiter">"</span><span class="content">/j_security_check</span><span class="delimiter">"</span></span>);
<span class="line-numbers">105</span>        <span class="predefined-type">List</span>&lt;NameValuePair&gt; nvps = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;NameValuePair&gt;();
<span class="line-numbers">106</span>        nvps.add(<span class="keyword">new</span> BasicNameValuePair(<span class="string"><span class="delimiter">"</span><span class="content">j_username</span><span class="delimiter">"</span></span>, userid));
<span class="line-numbers">107</span>        nvps.add(<span class="keyword">new</span> BasicNameValuePair(<span class="string"><span class="delimiter">"</span><span class="content">j_password</span><span class="delimiter">"</span></span>, password));
<span class="line-numbers">108</span>        postMethod.setEntity(<span class="keyword">new</span> UrlEncodedFormEntity(nvps, <span class="string"><span class="delimiter">"</span><span class="content">UTF-8</span><span class="delimiter">"</span></span>));
<span class="line-numbers">109</span>        response = client.execute(postMethod);
<span class="line-numbers">110</span>        assertEquals(HttpServletResponse.SC_FOUND,
<span class="line-numbers">111</span>            response.getStatusLine().getStatusCode(),
<span class="line-numbers">112</span>            <span class="string"><span class="delimiter">"</span><span class="content">Expected </span><span class="delimiter">"</span></span> + HttpServletResponse.SC_FOUND + <span class="string"><span class="delimiter">"</span><span class="content"> status code for login</span><span class="delimiter">"</span></span>);
<span class="line-numbers">113</span>
<span class="line-numbers">114</span>        <span class="comment">// Return if login fails</span>
<span class="line-numbers">115</span>        <span class="keyword">if</span> (expectLoginFail) {
<span class="line-numbers">116</span>            <span class="predefined-type">String</span> location = response.getFirstHeader(<span class="string"><span class="delimiter">"</span><span class="content">Location</span><span class="delimiter">"</span></span>).getValue();
<span class="line-numbers">117</span>            assertTrue(location.contains(<span class="string"><span class="delimiter">"</span><span class="content">error.html</span><span class="delimiter">"</span></span>),
<span class="line-numbers">118</span>                <span class="string"><span class="delimiter">"</span><span class="content">Error.html was not returned</span><span class="delimiter">"</span></span>);
<span class="line-numbers">119</span>            <span class="keyword">return</span>;
<span class="line-numbers">120</span>        }
<span class="line-numbers">121</span>
<span class="line-numbers">122</span>        <span class="comment">// Use HttpClient to execute the redirected url</span>
<span class="line-numbers">123</span>        url = <span class="keyword">new</span> <span class="predefined-type">URI</span>(urlHttps + redirect[<span class="integer">1</span>]);
<span class="line-numbers">124</span>        getMethod = <span class="keyword">new</span> HttpGet(url);
<span class="line-numbers">125</span>        response = client.execute(getMethod);
<span class="line-numbers">126</span>        assertEquals(expectedCode, response.getStatusLine().getStatusCode(),
<span class="line-numbers">127</span>            <span class="string"><span class="delimiter">"</span><span class="content">Expected </span><span class="delimiter">"</span></span> + expectedCode + <span class="string"><span class="delimiter">"</span><span class="content"> status code for login</span><span class="delimiter">"</span></span>);
<span class="line-numbers">128</span>
<span class="line-numbers">129</span>        <span class="comment">// Return if not SC_OK</span>
<span class="line-numbers">130</span>        <span class="keyword">if</span> (expectedCode != HttpServletResponse.SC_OK) {
<span class="line-numbers">131</span>            <span class="keyword">return</span>;
<span class="line-numbers">132</span>        }
<span class="line-numbers">133</span>
<span class="line-numbers">134</span>        <span class="comment">// Check the content of the response returned</span>
<span class="line-numbers">135</span>        <span class="predefined-type">String</span> actual = EntityUtils.toString(response.getEntity(), <span class="string"><span class="delimiter">"</span><span class="content">UTF-8</span><span class="delimiter">"</span></span>);
<span class="line-numbers">136</span>        assertTrue(actual.contains(userid),
<span class="line-numbers">137</span>            <span class="string"><span class="delimiter">"</span><span class="content">The actual content did not contain the userid </span><span class="char">\"</span><span class="delimiter">"</span></span> + userid
<span class="line-numbers">138</span>            + <span class="string"><span class="delimiter">"</span><span class="char">\"</span><span class="content">. It was:</span><span class="char">\n</span><span class="delimiter">"</span></span> + actual);
<span class="line-numbers">139</span>        assertTrue(actual.contains(expectedContent),
<span class="line-numbers">140</span>            <span class="string"><span class="delimiter">"</span><span class="content">The url </span><span class="delimiter">"</span></span> + testUrl + <span class="string"><span class="delimiter">"</span><span class="content"> did not return the expected content </span><span class="char">\"</span><span class="delimiter">"</span></span>
<span class="line-numbers">141</span>            + expectedContent + <span class="string"><span class="delimiter">"</span><span class="char">\"</span><span class="delimiter">"</span></span> + <span class="string"><span class="delimiter">"</span><span class="content">The actual content was:</span><span class="char">\n</span><span class="delimiter">"</span></span> + actual);
<span class="line-numbers">142</span>    }
<span class="line-numbers">143</span>
<span class="line-numbers">144</span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code class="hotspot=testAuthenticationFail">testAuthenticationFail()</code> method tests an invalid user authentication while the <code class="hotspot=testAuthorizationFail">testAuthorizationFail()</code> method tests unauthorized access to the application.</p>
</div>
<div class="paragraph">
<p>The <code class="hotspot=testAuthorizationForAdmin">testAuthorizationForAdmin()</code> and <code class="hotspot=testAuthorizationForUser">testAuthorizationForUser()</code> methods verify that users with <code>admin</code> or <code>user</code> roles are properly authenticated and can access authorized resource.</p>
</div>
<div class="sect2 command">
<h3 id="running-the-tests">Running the tests</h3>
<div class="paragraph">
<p>Because you started Open Liberty in dev mode, you can run the tests by pressing the <code>enter/return</code> key from the command-line session where you started dev mode.</p>
</div>
<div class="paragraph">
<p>You see the following output:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre class="CodeRay highlight"><code>-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running it.io.openliberty.guides.security.SecurityIT
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.78 sec - in it.io.openliberty.guides.security.SecurityIT

Results :

Tests run: 4, Failures: 0, Errors: 0, Skipped: 0</code></pre>
</div>
</div>
<div class="paragraph command">
<p>When you are done checking out the service, exit dev mode by pressing <code>CTRL+C</code> in the command-line session where you ran Liberty, or by typing <code>q</code> and then pressing the <code>enter/return</code> key.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="great-work-youre-done">Great work! You’re done!</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You learned how to use Jakarta EE Security in Open Liberty to authenticate and authorize users to secure your web application.</p>
</div>
<div class="paragraph">
<p>Next, you can try the related <a href="https://openliberty.io/guides/microprofile-jwt.html" target="_blank" rel="noopener">MicroProfile JWT</a> guide. It demonstrates technologies to secure backend services.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="guide-attribution">Guide Attribution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Securing a web application <span class="licensedClass">by</span> Open Liberty <span class="licensedClass">is licensed under</span> CC BY-ND 4.0</p>
</div>
</div>
</div>
    </div>
  </div>

  <!-- Code section -->
  <div id="code_column" class="position_relative" tabindex="0">
    <div id="code_column_title_container">
      <div id="code_column_tabs_container" class="dimmed">
        <ul id="code_column_tabs" class="nav" role="tablist"></ul>
      </div>
      <div class="copyFileButton" tabindex="0">
        <img src="/img/guides_copy_button.svg" alt="Copy file contents" title="Copy file contents">
        <div id="code_section_copied_confirmation">Copied to clipboard </div>
      </div>
    </div>
    <div id="code_column_content"></div>

    <div id="prereqs_container">
      <p id="prereqs_title">Prerequisites:</p>
      <div class="prereqs_list"></div>
      <div class="skills_network_container">
        <div class="skills_network_description"></div>
      </div>
    </div>

    <button id="dismiss_button" aria-label="Back to text" tabindex="0">
      Back to text
    </button>
  </div>
</div>

<!-- Build a list of all the documents in the guides code base -->






<!-- Remove any documents deemed private (archived, templates, etc) -->


<!-- Count number of guides from past 30 days-->


    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    


<!-- Sort list of guides by date with most recent first -->





<div id="end_of_guide">
        <h2 tabindex="0">Nice work! Where to next?</h2>
        <div id="end_of_guide_left_section">
            <p id="guide_attribution"></p>
            
            <h3 id="feedback_rating_question">What did you think of this guide?</h3>
            <div id="feedback_ratings">
                <img class="guide_rating" id="extreme_dislike" src="/img/1_Extreme_Dislike.png" onclick="$('#dislike_popup').show(); $('.popup_content').focus();" alt="Extreme Dislike" data-guide-rating="1" tabindex="0" aria-label="Rate this guide as extreme dislike">
                <img class="guide_rating" id="dislike" src="/img/2_Dislike.png" onclick="$('#dislike_popup').show(); $('.popup_content').focus();" alt="Dislike" data-guide-rating="2" tabindex="0" aria-label="Rate this guide as dislike">
                <img class="guide_rating" id="like" src="/img/3_Like.png" onclick="$('#like_popup').show(); $('.popup_content').focus();" alt="Like" data-guide-rating="3" tabindex="0" aria-label="Rate this guide as like">
                <img class="guide_rating" id="extreme_like" src="/img/4_Extreme_Like.png" onclick="$('#like_popup').show(); $('.popup_content').focus();" alt="Extreme Like" data-guide-rating="4" tabindex="0" aria-label="Rate this guide as extreme like">
            </div>

            <div id="like_popup" class="popup">
                <div class="popup_content" tabindex="0">
                    <p class="popup_title">Thank you for your feedback!</p>
                    <button id="close_button" class="popup_button" onclick="$('#like_popup').hide();">Close</button>
                </div>
            </div>

            <div id="dislike_popup" class="popup">
                <div class="popup_content" tabindex="0">
                    <p class="popup_title">Thank you for your feedback!</p>
                    <p id="open_issue">Would you like to open an issue in GitHub?</p>
                    
                        <a href="https://github.com/OpenLiberty/guide-security-intro/issues/new" target="_blank" id="yes_button" class="popup_button" onclick="$('#dislike_popup').hide();" rel="noopener noreferrer">Yes</a>
                    
                    <button id="no_button" class="popup_button" onclick="$('#dislike_popup').hide();">No, thank you</button>
                </div>
            </div>

            <h3 id="improve_guide_feedback">What could make this guide better?</h3>
            
                <p><a target="_blank" rel="noopener noreferrer" href="https://github.com/OpenLiberty/guide-security-intro/issues">Raise an issue</a> to share feedback</p>
                <p><a target="_blank" rel="noopener noreferrer" href="https://github.com/OpenLiberty/guide-security-intro/pulls">Create a pull request</a> to contribute to this guide</p>
            

            <h3 id="need_help">Need help?</h3>
            <p><a target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/questions/tagged/open-liberty">Ask a question on Stack Overflow</a></p>

            <h3>Like Open Liberty? Star our repo on GitHub.</h3>
            <a class="github-button" href="https://github.com/OpenLiberty/open-liberty" data-icon="octicon-star" aria-label="Star OpenLiberty/open-liberty on GitHub" target="_blank" rel="noopener noreferrer">Star</a>
        </div>
        <div id="end_of_guide_right_section">
            <h3 id="where_to_next">Where to next?</h3>

            
            

            <!-- Related guides section -->
            
            <div id="related-guides">
                <div id="related-guides-cards" class="row">
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/microprofile-jwt.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Securing microservices with JSON Web Tokens</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">25 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/cdi-intro.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Injecting dependencies into microservices</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">15 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                </div>
            </div>
            
        </div>
    </div>



    </main>

    



<footer>
    <div id="footer_gray_background">
        <div id="footer_top_container" class="footer_container container-fluid">
            <div id="footer_project_container">
                <span id="footer_open_liberty"></span>
                <p id="footer_project">IBM 开放式源代码项目</p>
            </div>
            <div id="footer_round_links_container">
                <a id="footer_github_link" class="footer_round_btn" href="https://github.com/OpenLiberty/" target="_blank" rel="noopener noreferrer" aria-label="Github"></a>
                <a id="footer_twitter_link" class="footer_round_btn" href="https://twitter.com/OpenLibertyIO" target="_blank" rel="noopener noreferrer" aria-label="Twitter"></a>
                <a id="footer_stackoverflow_link" class="footer_round_btn" href="https://stackoverflow.com/questions/tagged/open-liberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty questions on Stack Overflow"></a>
                <a id="footer_groupsio_link" class="footer_round_btn" href="https://groups.io/g/openliberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Groups.io"></a>
                <a id="footer_gitter_link" class="footer_round_btn" href="https://app.gitter.im/#/room/#OpenLiberty_development:gitter.im" target="_blank" rel="noopener" aria-label="Open Liberty Gitter"></a>
            </div>
        </div>         
    </div>

    <div id="footer_bottom_container" class="footer_container container-fluid">
        <div id="footer_bottom_left_section">
            <p id="footer_copyright">© Copyright IBM Corp. 2017, 2023</p>
            <p class="vertical_bar">|</p>
            <a id="footer_privacy_policy_link" href="https://www.ibm.com/privacy/" target="_blank" rel="noopener noreferrer" class="left_footer_link">隐私策略</a>
            <p class="vertical_bar">|</p>
            <a id="footer_license_link" href="https://github.com/OpenLiberty/open-liberty/blob/release/LICENSE" target="_blank" rel="noopener noreferrer" class="left_footer_link">许可证</a>
            <p class="vertical_bar">|</p>
            <a id="footer_logos_link" href="https://github.com/OpenLiberty/logos" target="_blank" rel="noopener noreferrer" class="left_footer_link">洛戈斯</a>
        </div>
        <div id="footer_bottom_right_section">
            <a id="footer_docs_link" href="/docs" aria-label="Open Liberty Docs" class="right_footer_link blue_link_light_background">文档</a>
            <a id="footer_blog_link" href="/blog" aria-label="Open Liberty Blog" class="right_footer_link blue_link_light_background">博客</a>
            <a id="footer_support_link" href="/support" aria-label="Open Liberty Support" class="right_footer_link blue_link_light_background">支持</a>
        </div>
    </div>
</footer>

<!-- PRE-LOADED IMAGES FOR ON HOVER BEHAVIOR -->
<div class="d-none hidden">
    <img src="/img/Footer_GitCat_Hover.svg" alt="OpenLiberty Github link">
    <img src="/img/Footer_TwitterBird_Hover.svg" alt="OpenLibertyIO Twitter link">
    <img src="/img/Footer_StackO_Hover.svg" alt="Open-liberty Stack Overflow link">
    <img src="/img/Footer_GroupsIO_Hover.svg" alt="Openliberty Groups IO link">
    <img src="/img/footer_gitter_hover.svg" alt="Openliberty Gitter link">
</div>

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js" integrity="sha512-lzilC+JFd6YV8+vQRNRtU7DOqv5Sa9Ek53lXt/k91HZTJpytHS1L6l1mMKR9K6VVoDt4LiEXaa6XBrYk1YhGTQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>


<script type="text/javascript" src="/zh-Hans/assets/devEnvironment.js"></script>




  <script type="text/javascript" src="/zh-Hans/assets/guide-common.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/toc.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/tabs.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/guide-static.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/guide-multipane-static.js"></script>


<script type="text/javascript" src="/zh-Hans/assets/openliberty.js"></script>

  </body>

</html>
