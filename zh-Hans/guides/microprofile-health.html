<!DOCTYPE html>
<html lang="zh-Hans">

  





<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>
    
      Checking the health of Java microservices by using Eclipse MicroProfile Health Check
    
  </title>
  <meta name="description" content="A getting started tutorial and an example on how to monitor and report the health status of Java microservices by implementing readiness and liveness checks using Eclipse MicroProfile Health.">

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
  

  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/openliberty.css">
  <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/coderay-custom.css">

  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/header.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/header-dark.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/toc-multipane-static.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/end-of-guide.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-card.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/tabs.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-common.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-multipane.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-multipane-static.css">
  

  

  

  <link rel="canonical" href="https://openliberty.io/zh-Hans/guides/microprofile-health">
  <link rel="alternate" type="application/rss+xml" title="Open Liberty" href="/zh-Hans/feed.xml">
  <link href="https://fonts.googleapis.com/css?family=Asap:400,500" rel="stylesheet">
    
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@OpenLibertyIO" />
  <meta name="twitter:title" content="Checking the health of Java microservices by using Eclipse MicroProfile Health Check" />
  <meta name="twitter:description" content="A getting started tutorial and an example on how to monitor and report the health status of Java microservices by implementing readiness and liveness checks using Eclipse MicroProfile Health." />

  <meta property='og:title' content="Checking the health of Java microservices by using Eclipse MicroProfile Health Check" />
  <meta property='og:image' content="https://openliberty.io/img/twitter_card.jpg" />
  <meta property='og:image:alt' content="Open Liberty Logo" />
  <meta property='og:description' content="A getting started tutorial and an example on how to monitor and report the health status of Java microservices by implementing readiness and liveness checks using Eclipse MicroProfile Health." />
  <meta property='og:url' content="https://openliberty.io/zh-Hans/guides/microprofile-health" />
  <meta property='og:type' content="website" />
  
  <meta name="google-site-verification" content="h2P030H9b66CyL1nEmWfrZB8Fr14h9LmVMG7Ur0caBs" />

  
      <meta name="robots" content="noindex" />
  

  <script async defer src="https://buttons.github.io/buttons.js"></script>
</head>


  <body>
    
    

    


<!--  -->

<header>
    <nav id="nav_bar">
        <div id="nav_header">
            <a id="home_link" href="/" aria-label="Open Liberty Home">
                <img id="ol_logo" src="/img/docs_openliberty_logo.png" alt="Open Liberty Logo">
            </a>
            <button id="hamburger_toggle_button" onclick="$('#nav_bar').toggleClass('responsive');">
                <span id="hamburger_toggle_icon"></span>
            </button>
        </div>
        <div id="hamburger_menu">
            <ul class="nav_list">
                <li class="nav_link">
                    <a href="/start/">入门</a>
                </li>
                <li class="nav_link">
                    <a href="/guides/">指南</a>
                </li>
                <li class="nav_link">
                    <a href="/docs/">文档</a>
                </li>
                <li class="nav_link">
                    <a href="/support/">支持</a>
                </li>
                <li class="nav_link">
                    <a href="/blog/">博客</a>
                </li>
            </ul>
            <div id="header_round_links_container"> 
                <a id="header_twitter_link" class="header_round_button" href="https://twitter.com/OpenLibertyIO" target="_blank" rel="noopener noreferrer" aria-label="Twitter"></a>
                <a id="header_stackoverflow_link" class="header_round_button" href="https://stackoverflow.com/questions/tagged/open-liberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty questions on Stack Overflow"></a>
                <a id="header_groupsio_link" class="header_round_button" href="https://groups.io/g/openliberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Groups.io"></a>
                <a id="header_gitter_link" class="header_round_button" href="https://app.gitter.im/#/room/#OpenLiberty_development:gitter.im" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Gitter"></a>
            </div>
        </div>

    </nav>
</header>


    <main aria-label="Content">

      <!-- Build a list of all the documents in the guides code base -->
  
 

<!-- Remove any documents deemed private (archived, templates, etc) -->


<!-- Count number of guides from past 30 days-->
<!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
 

<!-- Sort list of guides by date with most recent first -->


<div id="background_container">
  <div id="toc_hotspot"></div>
  <!-- Guide's table of contents section -->
  <div id="toc_column" class="collapse inline open">
    <div id="toc_inner">
       
      <div id="close_container">
        <img id="toc_close_white" src="/img/toc_close_white.svg" alt="Close the table of contents" tabindex="0">
      </div>
      <h3 id="toc_title">Contents</h3>
      <div id="toc_container"><ul class="sectlevel1">
<li><a href="#what-youll-learn">What you’ll learn</a></li>
<li>
<a href="#getting-started">Getting started</a>
<ul class="sectlevel2">
<li><a href="#try-what-youll-build">Try what you’ll build</a></li>
</ul>
</li>
<li>
<a href="#adding-health-checks-to-microservices">Adding health checks to microservices</a>
<ul class="sectlevel2">
<li><a href="#adding-health-checks-to-the-system-service">Adding health checks to the system service</a></li>
<li><a href="#adding-health-checks-to-the-inventory-service">Adding health checks to the inventory service</a></li>
</ul>
</li>
<li><a href="#running-the-application">Running the application</a></li>
<li>
<a href="#testing-health-checks">Testing health checks</a>
<ul class="sectlevel2">
<li><a href="#running-the-tests">Running the tests</a></li>
</ul>
</li>
<li><a href="#great-work-youre-done">Great work! You’re done!</a></li>
<li><a href="#guide-attribution">Guide Attribution</a></li>
</ul></div>
      <div id="toc_separator"></div>
      
      <h3 id="tag_title">标签</h3>
      <div id="tags_container"></div>
    </div>
  </div>
  <div id="toc_indicator" tabindex="0" aria-label="Open the table of contents" class="hidden">
    <img src="/img/arrow_white.svg" alt="arrow">
  </div>
  <div id="toc_line" class="open"></div>
  <!-- Entire guide section -->
  <div id="guide_column" class="position_relative open">
    <div id="guide_content">
      <!-- Guide header section -->
      <div id="guide_meta" class="sect1" tabindex="0">
        <h1 id="guide_title">Adding health reports to microservices</h1>
        <div id="duration_container">
          <img src="/img/guide_duration_clock_icon_large.svg" alt="duration">
          <span id="guide_duration">20 minutes</span>

          <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
          <!-- If new posts count is less than 4, use 4 most recent posts -->
           
          <!-- If new posts count is >= 4, use posts from last 30 days-->
          
          <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
          <!-- Count number of guides from past last 12 weeks that is 84 days-->
          <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
          
        </div>
        <div id="mobile_prereqs_section">
          <p id="mobile_prereqs_title">Prerequisites:</p>
          <div class="prereqs_list"></div>
          <div class="skills_network_container">
            <div class="skills_network_description"></div>
          </div>
        </div>
      </div>

      <div class="scroller_anchor"></div>
      <div id="mobile_toc_accordion_container" data-toggle="collapse" data-target="#toc_column" aria-expanded="false" aria-controls="toc_column" role="button">
        <div role="menuitem" id="mobile_toc_accordion">
          <button class="breadcrumb_hamburger toc-toggle collapsed" type="button" tabindex="0">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <img src="/img/toc_close_green.svg" class="TOC_Close_SVG hidden img-responsive" alt="Table of contents close button">
          </button>
          <span>Table of contents</span>
        </div>
      </div>

      <!-- Guide content section -->
      <div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note hidden">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This repository contains the guide documentation source. To view the guide in published form, view it on the <a href="https://openliberty.io/guides/microprofile-health.html">Open Liberty website</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Explore how to report and check the health of a microservice with MicroProfile Health.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-youll-learn">What you’ll learn</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You will learn how to use MicroProfile Health to report the health status of microservices and take appropriate actions based on this report.</p>
</div>
<div class="paragraph">
<p>MicroProfile Health allows services to report their health, and it publishes the overall health status to a defined endpoint. A service reports <code>UP</code> if it is available and reports <code>DOWN</code> if it is unavailable. MicroProfile Health reports an individual service status at the endpoint and indicates the overall status as <code>UP</code> if all the services are <code>UP</code>. A service orchestrator can then use the health statuses to make decisions.</p>
</div>
<div class="paragraph">
<p>A service checks its own health by performing necessary self-checks and then reports its overall status by implementing the API provided by MicroProfile Health. A self-check can be a check on anything that the service needs, such as a dependency, a successful connection to an endpoint, a system property, a database connection, or the availability of required resources. MicroProfile offers checks for startup, liveness, and readiness.</p>
</div>
<div class="paragraph">
<p>You will add startup, liveness, and readiness checks to the <code>system</code> and <code>inventory</code> services, that are provided for you, and implement what is necessary to report health status by using MicroProfile Health.</p>
</div>
</div>
</div>
<div class="sect1 command">
<h2 id="getting-started">Getting started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The fastest way to work through this guide is to clone the <a href="https://github.com/openliberty/guide-microprofile-health.git" target="_blank" rel="noopener noreferrer">Git repository</a> and use the projects that are provided inside:</p>
</div>
<div id="git_clone" class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>git clone https://github.com/openliberty/guide-microprofile-health.git
cd guide-microprofile-health</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>start</code> directory contains the starting project that you will build upon.</p>
</div>
<div class="paragraph">
<p>The <code>finish</code> directory contains the finished project that you will build.</p>
</div>
<div class="paragraph">
<p>Before you begin, make sure you have all the necessary <span class="prerequisites">prerequisites</span>.</p>
</div>
<div class="sect2 command">
<h3 id="try-what-youll-build">Try what you’ll build</h3>
<div class="paragraph">
<p>The <code>finish</code> directory in the root of this guide contains the finished application. Give it a try before you proceed.</p>
</div>
<div class="paragraph">
<p>To try out the application, first go to the <code>finish</code> directory and run the following Maven goal to build the application and deploy it to Open Liberty:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>cd finish
mvn liberty:run</code></pre>
</div>
</div>
<div class="paragraph">
<p>After you see the following message, your Liberty instance is ready:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>The defaultServer server is ready to run a smarter planet.</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>system</code> and <code>inventory</code> services can be found at the following URLs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:9080/system/properties" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9080/system/properties</a></p>
</li>
<li>
<p><a href="http://localhost:9080/inventory/systems" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9080/inventory/systems</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Visit the <a href="http://localhost:9080/health" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9080/health</a> URL to see the overall health status of the application, as well as the aggregated data of the startup, liveness and readiness checks. Three checks show the state of the <code>system</code> service, and the other three checks show the state of the <code>inventory</code> service. As you might expect, all services are in the <code>UP</code> state, and the overall health status of the application is in the <code>UP</code> state.</p>
</div>
<div class="paragraph">
<p>Access the <code>/health/started</code> endpoint by visiting the <a href="http://localhost:9080/health/started" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9080/health/started</a> URL to view the data from the startup health checks. You can also access the <code>/health/live</code> endpoint by visiting the <a href="http://localhost:9080/health/live" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9080/health/live</a> URL to view the data from the liveness health checks. Similarly, access the <code>/health/ready</code> endpoint by visiting the <a href="http://localhost:9080/health/ready" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9080/health/ready</a> URL to view the data from the readiness health checks.</p>
</div>
<div class="paragraph command">
<p>After you are finished checking out the application, stop the Liberty instance by pressing <code>CTRL+C</code> in the command-line session where you ran Liberty. Alternatively, you can run the <code>liberty:stop</code> goal from the <code>finish</code> directory in another shell session:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn liberty:stop</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-health-checks-to-microservices">Adding health checks to microservices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Navigate to the <code>start</code> directory to begin.</p>
</div>
<div class="paragraph command">
<p>When you run Open Liberty in <a href="https://openliberty.io/docs/latest/development-mode.html" target="_blank" rel="noopener">dev mode</a>, dev mode listens for file changes and automatically recompiles and deploys your updates whenever you save a new change. Run the following goal to start Open Liberty in dev mode:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn liberty:dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>After you see the following message, your Liberty instance is ready in dev mode:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>**************************************************************
*    Liberty is running in dev mode.</pre>
</div>
</div>
<div class="paragraph">
<p>Dev mode holds your command-line session to listen for file changes. Open another command-line session to continue, or open the project in your editor.</p>
</div>
<div class="paragraph">
<p>A health report will be generated automatically for all services that enable MicroProfile Health. The <code class="hotspot=mpHealth">mpHealth</code> feature has already been enabled for you in the <code class="hotspot">src/main/liberty/config/server.xml</code> file.</p>
</div>
<div class="paragraph">
<p>All services must provide an implementation of the <code>HealthCheck</code> interface, which is used to verify their health. MicroProfile Health offers health checks for startup, liveness, and readiness. A startup check allows applications to define startup probes that are used for initial verification of the application before the Liveness probe takes over. For example, a startup check might check which applications require additional startup time on their first initialization. A liveness check allows third-party services to determine whether a microservice is running. If the liveness check fails, the application can be terminated. For example, a liveness check might fail if the application runs out of memory. A readiness check allows third-party services, such as Kubernetes, to determine whether a microservice is ready to process requests. For example, a readiness check might check dependencies, such as database connections.</p>
</div>
<div class="paragraph">
<p>server.xml</p>
</div>
<div class="listingblock code_column">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="line-numbers"> 1</span><span class="tag">&lt;server</span> <span class="attribute-name">description</span>=<span class="string"><span class="delimiter">"</span><span class="content">Sample Liberty server</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers"> 2</span>
<span class="line-numbers"> 3</span>  <span class="tag">&lt;featureManager&gt;</span>
<span class="line-numbers"> 4</span>    <span class="tag">&lt;feature&gt;</span>restfulWS-3.1<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 5</span>    <span class="tag">&lt;feature&gt;</span>jsonb-3.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 6</span>    <span class="tag">&lt;feature&gt;</span>jsonp-2.1<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 7</span>    <span class="tag">&lt;feature&gt;</span>cdi-4.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 8</span>    <span class="tag">&lt;feature&gt;</span>mpConfig-3.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 9</span>    <span class="tag">&lt;feature&gt;</span>mpRestClient-3.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers">10</span>    <span class="comment">&lt;!-- tag::mpHealth[] --&gt;</span>
<span class="line-numbers">11</span>    <span class="tag">&lt;feature&gt;</span>mpHealth-4.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers">12</span>    <span class="comment">&lt;!-- end::mpHealth[] --&gt;</span>
<span class="line-numbers">13</span>  <span class="tag">&lt;/featureManager&gt;</span>
<span class="line-numbers">14</span>
<span class="line-numbers">15</span>  <span class="tag">&lt;variable</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">default.http.port</span><span class="delimiter">"</span></span> <span class="attribute-name">defaultValue</span>=<span class="string"><span class="delimiter">"</span><span class="content">9080</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">16</span>  <span class="tag">&lt;variable</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">default.https.port</span><span class="delimiter">"</span></span> <span class="attribute-name">defaultValue</span>=<span class="string"><span class="delimiter">"</span><span class="content">9443</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">17</span>
<span class="line-numbers">18</span>  <span class="tag">&lt;httpEndpoint</span> <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">"</span><span class="content">*</span><span class="delimiter">"</span></span> <span class="attribute-name">httpPort</span>=<span class="string"><span class="delimiter">"</span><span class="content">${default.http.port}</span><span class="delimiter">"</span></span>
<span class="line-numbers">19</span>    <span class="attribute-name">httpsPort</span>=<span class="string"><span class="delimiter">"</span><span class="content">${default.https.port}</span><span class="delimiter">"</span></span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">defaultHttpEndpoint</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">20</span>
<span class="line-numbers">21</span>  <span class="tag">&lt;webApplication</span> <span class="attribute-name">location</span>=<span class="string"><span class="delimiter">"</span><span class="content">guide-microprofile-health.war</span><span class="delimiter">"</span></span> <span class="attribute-name">contextRoot</span>=<span class="string"><span class="delimiter">"</span><span class="content">/</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">22</span><span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="adding-health-checks-to-the-system-service">Adding health checks to the system service</h3>
<div class="listingblock code_command hotspot file=0">
<div class="content">
<pre><mark>Create the <code>SystemStartupCheck</code> class.</mark>
<code>src/main/java/io/openliberty/guides/system/SystemStartupCheck.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>SystemStartupCheck.java</p>
</div>
<div class="listingblock code_column tags=SystemStartupCheck hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="line-numbers"> 1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers"> 2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers"> 3</span><span class="comment"> * Copyright (c) 2022 IBM Corporation and others.</span>
<span class="line-numbers"> 4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers"> 5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers"> 6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers"> 7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers"> 8</span><span class="comment"> *</span>
<span class="line-numbers"> 9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers">10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers">11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers">12</span><span class="comment">// tag::SystemStartupCheck[]</span>
<span class="line-numbers">13</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.system</span>;
<span class="line-numbers">14</span>
<span class="line-numbers">15</span><span class="keyword">import</span> <span class="include">java.lang.management.ManagementFactory</span>;
<span class="line-numbers">16</span><span class="keyword">import</span> <span class="include">com.sun.management.OperatingSystemMXBean</span>;
<span class="line-numbers">17</span><span class="keyword">import</span> <span class="include">jakarta.enterprise.context.ApplicationScoped</span>;
<span class="line-numbers">18</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.Startup</span>;
<span class="line-numbers">19</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.HealthCheck</span>;
<span class="line-numbers">20</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.HealthCheckResponse</span>;
<span class="line-numbers">21</span>
<span class="line-numbers">22</span><span class="comment">// tag::Startup[]</span>
<span class="line-numbers">23</span><span class="annotation">@Startup</span>
<span class="line-numbers">24</span><span class="comment">// end::Startup[]</span>
<span class="line-numbers">25</span><span class="annotation">@ApplicationScoped</span>
<span class="line-numbers">26</span><span class="directive">public</span> <span class="type">class</span> <span class="class">SystemStartupCheck</span> <span class="directive">implements</span> HealthCheck {
<span class="line-numbers">27</span>
<span class="line-numbers">28</span>    <span class="annotation">@Override</span>
<span class="line-numbers">29</span>    <span class="directive">public</span> HealthCheckResponse call() {
<span class="line-numbers">30</span>        <span class="predefined-type">OperatingSystemMXBean</span> bean = (com.sun.management.OperatingSystemMXBean)
<span class="line-numbers">31</span>        <span class="predefined-type">ManagementFactory</span>.getOperatingSystemMXBean();
<span class="line-numbers">32</span>        <span class="type">double</span> cpuUsed = bean.getSystemCpuLoad();
<span class="line-numbers">33</span>        <span class="predefined-type">String</span> cpuUsage = <span class="predefined-type">String</span>.valueOf(cpuUsed);
<span class="line-numbers">34</span>        <span class="keyword">return</span> HealthCheckResponse.named(SystemResource.class
<span class="line-numbers">35</span>                                            .getSimpleName() + <span class="string"><span class="delimiter">"</span><span class="content"> Startup Check</span><span class="delimiter">"</span></span>)
<span class="line-numbers">36</span>                                            .status(cpuUsed &lt; <span class="float">0.95</span>).build();
<span class="line-numbers">37</span>    }
<span class="line-numbers">38</span>}
<span class="line-numbers">39</span>
<span class="line-numbers">40</span><span class="comment">// end::SystemStartupCheck[]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code class="hotspot=Startup file=0">@Startup</code> annotation indicates that this class is a startup health check procedure. In this case, you are checking the cpu usage. If more than 95% of the cpu is being used, a status of <code>DOWN</code> is returned.</p>
</div>
<div class="listingblock code_command hotspot file=1">
<div class="content">
<pre><mark>Create the <code>SystemLivenessCheck</code> class.</mark>
<code>src/main/java/io/openliberty/guides/system/SystemLivenessCheck.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>SystemLivenessCheck.java</p>
</div>
<div class="listingblock code_column tags=SystemLivenessCheck hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="line-numbers"> 1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers"> 2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers"> 3</span><span class="comment"> * Copyright (c) 2018, 2022 IBM Corporation and others.</span>
<span class="line-numbers"> 4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers"> 5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers"> 6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers"> 7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers"> 8</span><span class="comment"> *</span>
<span class="line-numbers"> 9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers">10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers">11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers">12</span><span class="comment">// tag::SystemLivenessCheck[]</span>
<span class="line-numbers">13</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.system</span>;
<span class="line-numbers">14</span>
<span class="line-numbers">15</span><span class="keyword">import</span> <span class="include">java.lang.management.ManagementFactory</span>;
<span class="line-numbers">16</span><span class="keyword">import</span> <span class="include">java.lang.management.MemoryMXBean</span>;
<span class="line-numbers">17</span>
<span class="line-numbers">18</span><span class="keyword">import</span> <span class="include">jakarta.enterprise.context.ApplicationScoped</span>;
<span class="line-numbers">19</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.Liveness</span>;
<span class="line-numbers">20</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.HealthCheck</span>;
<span class="line-numbers">21</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.HealthCheckResponse</span>;
<span class="line-numbers">22</span>
<span class="line-numbers">23</span><span class="comment">// tag::Liveness[]</span>
<span class="line-numbers">24</span><span class="annotation">@Liveness</span>
<span class="line-numbers">25</span><span class="comment">// end::Liveness[]</span>
<span class="line-numbers">26</span><span class="annotation">@ApplicationScoped</span>
<span class="line-numbers">27</span><span class="directive">public</span> <span class="type">class</span> <span class="class">SystemLivenessCheck</span> <span class="directive">implements</span> HealthCheck {
<span class="line-numbers">28</span>
<span class="line-numbers">29</span>  <span class="annotation">@Override</span>
<span class="line-numbers">30</span>  <span class="directive">public</span> HealthCheckResponse call() {
<span class="line-numbers">31</span>    <span class="predefined-type">MemoryMXBean</span> memBean = <span class="predefined-type">ManagementFactory</span>.getMemoryMXBean();
<span class="line-numbers">32</span>    <span class="type">long</span> memUsed = memBean.getHeapMemoryUsage().getUsed();
<span class="line-numbers">33</span>    <span class="type">long</span> memMax = memBean.getHeapMemoryUsage().getMax();
<span class="line-numbers">34</span>
<span class="line-numbers">35</span>    <span class="keyword">return</span> HealthCheckResponse.named(
<span class="line-numbers">36</span>      SystemResource.class.getSimpleName() + <span class="string"><span class="delimiter">"</span><span class="content"> Liveness Check</span><span class="delimiter">"</span></span>)
<span class="line-numbers">37</span>                              .status(memUsed &lt; memMax * <span class="float">0.9</span>).build();
<span class="line-numbers">38</span>  }
<span class="line-numbers">39</span>}
<span class="line-numbers">40</span><span class="comment">// end::SystemLivenessCheck[]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code class="hotspot=Liveness file=1">@Liveness</code> annotation indicates that this class is a liveness health check procedure. In this case, you are checking the heap memory usage. If more than 90% of the maximum memory is being used, a status of <code>DOWN</code> is returned.</p>
</div>
<div class="listingblock code_command hotspot file=2">
<div class="content">
<pre><mark>Create the <code>SystemReadinessCheck</code> class.</mark>
<code>src/main/java/io/openliberty/guides/system/SystemReadinessCheck.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>SystemReadinessCheck.java</p>
</div>
<div class="listingblock code_column tags=SystemReadinessCheck hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="line-numbers"> 1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers"> 2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers"> 3</span><span class="comment"> * Copyright (c) 2018, 2022 IBM Corporation and others.</span>
<span class="line-numbers"> 4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers"> 5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers"> 6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers"> 7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers"> 8</span><span class="comment"> *</span>
<span class="line-numbers"> 9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers">10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers">11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers">12</span><span class="comment">// tag::SystemReadinessCheck[]</span>
<span class="line-numbers">13</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.system</span>;
<span class="line-numbers">14</span>
<span class="line-numbers">15</span><span class="keyword">import</span> <span class="include">jakarta.enterprise.context.ApplicationScoped</span>;
<span class="line-numbers">16</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.Readiness</span>;
<span class="line-numbers">17</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.HealthCheck</span>;
<span class="line-numbers">18</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.HealthCheckResponse</span>;
<span class="line-numbers">19</span>
<span class="line-numbers">20</span><span class="comment">// tag::Readiness[]</span>
<span class="line-numbers">21</span><span class="annotation">@Readiness</span>
<span class="line-numbers">22</span><span class="comment">// end::Readiness[]</span>
<span class="line-numbers">23</span><span class="comment">// tag::ApplicationScoped[]</span>
<span class="line-numbers">24</span><span class="annotation">@ApplicationScoped</span>
<span class="line-numbers">25</span><span class="comment">// end::ApplicationScoped[]</span>
<span class="line-numbers">26</span><span class="directive">public</span> <span class="type">class</span> <span class="class">SystemReadinessCheck</span> <span class="directive">implements</span> HealthCheck {
<span class="line-numbers">27</span>
<span class="line-numbers">28</span>  <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> READINESS_CHECK = SystemResource.class.getSimpleName()
<span class="line-numbers">29</span>                                               + <span class="string"><span class="delimiter">"</span><span class="content"> Readiness Check</span><span class="delimiter">"</span></span>;
<span class="line-numbers">30</span>  <span class="annotation">@Override</span>
<span class="line-numbers">31</span><span class="comment">// tag::healthCheckResponse[]</span>
<span class="line-numbers">32</span>  <span class="directive">public</span> HealthCheckResponse call() {
<span class="line-numbers">33</span>    <span class="comment">// tag::defaultServer[]</span>
<span class="line-numbers">34</span>    <span class="keyword">if</span> (!<span class="predefined-type">System</span>.getProperty(<span class="string"><span class="delimiter">"</span><span class="content">wlp.server.name</span><span class="delimiter">"</span></span>).equals(<span class="string"><span class="delimiter">"</span><span class="content">defaultServer</span><span class="delimiter">"</span></span>)) {
<span class="line-numbers">35</span>    <span class="comment">// end::defaultServer[]</span>
<span class="line-numbers">36</span>      <span class="comment">// tag::HealthCheckResponse-DOWN[]</span>
<span class="line-numbers">37</span>      <span class="comment">// tag::HealthCheckResponse-named[]</span>
<span class="line-numbers">38</span>      <span class="keyword">return</span> HealthCheckResponse.down(READINESS_CHECK);
<span class="line-numbers">39</span>      <span class="comment">// end::HealthCheckResponse-named[]</span>
<span class="line-numbers">40</span>      <span class="comment">// end::HealthCheckResponse-DOWN[]</span>
<span class="line-numbers">41</span>    }
<span class="line-numbers">42</span>    <span class="comment">// tag::HealthCheckResponse-UP[]</span>
<span class="line-numbers">43</span>    <span class="keyword">return</span> HealthCheckResponse.up(READINESS_CHECK);
<span class="line-numbers">44</span>    <span class="comment">// end::HealthCheckResponse-UP[]</span>
<span class="line-numbers">45</span>  }
<span class="line-numbers">46</span><span class="comment">// end::healthCheckResponse[]</span>
<span class="line-numbers">47</span>}
<span class="line-numbers">48</span><span class="comment">// end::SystemReadinessCheck[]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code class="hotspot=Readiness file=2">@Readiness</code> annotation indicates that this class is a readiness health check procedure. By pairing this annotation with the <code class="hotspot=ApplicationScoped file=2">ApplicationScoped</code> context from the Contexts and Dependency Injections API, the bean is discovered automatically when the <code>http://localhost:9080/health</code> endpoint receives a request.</p>
</div>
<div class="paragraph">
<p>The <code class="hotspot=healthCheckResponse file=2">call()</code> method is used to return the health status of a particular service. In this case, you are checking if the server name is <code class="hotspot=defaultServer file=2">defaultServer</code> and returning <code class="hotspot=HealthCheckResponse-UP file=2">UP</code> if it is, and <code class="hotspot=HealthCheckResponse-DOWN file=2">DOWN</code> otherwise. This example is a very simple implementation of the <code class="hotspot=healthCheckResponse file=2">call()</code> method. In a real environment, you would orchestrate more meaningful health checks.</p>
</div>
</div>
<div class="sect2">
<h3 id="adding-health-checks-to-the-inventory-service">Adding health checks to the inventory service</h3>
<div class="listingblock code_command hotspot file=0">
<div class="content">
<pre><mark>Create the <code>InventoryStartupCheck</code> class.</mark>
<code>src/main/java/io/openliberty/guides/inventory/InventoryStartupCheck.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>InventoryStartupCheck.java</p>
</div>
<div class="listingblock code_column tags=InventoryStartupCheck hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="line-numbers"> 1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers"> 2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers"> 3</span><span class="comment"> * Copyright (c) 2022 IBM Corporation and others.</span>
<span class="line-numbers"> 4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers"> 5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers"> 6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers"> 7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers"> 8</span><span class="comment"> *</span>
<span class="line-numbers"> 9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers">10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers">11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers">12</span><span class="comment">// tag::InventoryStartupCheck[]</span>
<span class="line-numbers">13</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.inventory</span>;
<span class="line-numbers">14</span>
<span class="line-numbers">15</span><span class="keyword">import</span> <span class="include">java.lang.management.ManagementFactory</span>;
<span class="line-numbers">16</span><span class="keyword">import</span> <span class="include">com.sun.management.OperatingSystemMXBean</span>;
<span class="line-numbers">17</span><span class="keyword">import</span> <span class="include">jakarta.enterprise.context.ApplicationScoped</span>;
<span class="line-numbers">18</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.Startup</span>;
<span class="line-numbers">19</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.HealthCheck</span>;
<span class="line-numbers">20</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.HealthCheckResponse</span>;
<span class="line-numbers">21</span>
<span class="line-numbers">22</span><span class="comment">// tag::Startup[]</span>
<span class="line-numbers">23</span><span class="annotation">@Startup</span>
<span class="line-numbers">24</span><span class="comment">// end::Startup[]</span>
<span class="line-numbers">25</span><span class="annotation">@ApplicationScoped</span>
<span class="line-numbers">26</span><span class="directive">public</span> <span class="type">class</span> <span class="class">InventoryStartupCheck</span> <span class="directive">implements</span> HealthCheck {
<span class="line-numbers">27</span>
<span class="line-numbers">28</span>    <span class="annotation">@Override</span>
<span class="line-numbers">29</span>    <span class="directive">public</span> HealthCheckResponse call() {
<span class="line-numbers">30</span>        <span class="predefined-type">OperatingSystemMXBean</span> bean = (com.sun.management.OperatingSystemMXBean)
<span class="line-numbers">31</span>        <span class="predefined-type">ManagementFactory</span>.getOperatingSystemMXBean();
<span class="line-numbers">32</span>        <span class="type">double</span> cpuUsed = bean.getSystemCpuLoad();
<span class="line-numbers">33</span>        <span class="predefined-type">String</span> cpuUsage = <span class="predefined-type">String</span>.valueOf(cpuUsed);
<span class="line-numbers">34</span>        <span class="keyword">return</span> HealthCheckResponse.named(InventoryResource.class
<span class="line-numbers">35</span>                                            .getSimpleName() + <span class="string"><span class="delimiter">"</span><span class="content"> Startup Check</span><span class="delimiter">"</span></span>)
<span class="line-numbers">36</span>                                            .status(cpuUsed &lt; <span class="float">0.95</span>).build();
<span class="line-numbers">37</span>    }
<span class="line-numbers">38</span>}
<span class="line-numbers">39</span>
<span class="line-numbers">40</span><span class="comment">// end::InventoryStartupCheck[]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This startup check verifies that the cpu usage is below 95%.
If more than 95% of the cpu is being used, a status of <code>DOWN</code> is returned.</p>
</div>
<div class="listingblock code_command hotspot file=1">
<div class="content">
<pre><mark>Create the <code>InventoryLivenessCheck</code> class.</mark>
<code>src/main/java/io/openliberty/guides/inventory/InventoryLivenessCheck.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>InventoryLivenessCheck.java</p>
</div>
<div class="listingblock code_column tags=InventoryLivenessCheck hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="line-numbers"> 1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers"> 2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers"> 3</span><span class="comment"> * Copyright (c) 2018, 2022 IBM Corporation and others.</span>
<span class="line-numbers"> 4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers"> 5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers"> 6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers"> 7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers"> 8</span><span class="comment"> *</span>
<span class="line-numbers"> 9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers">10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers">11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers">12</span><span class="comment">// tag::InventoryLivenessCheck[]</span>
<span class="line-numbers">13</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.inventory</span>;
<span class="line-numbers">14</span>
<span class="line-numbers">15</span><span class="keyword">import</span> <span class="include">jakarta.enterprise.context.ApplicationScoped</span>;
<span class="line-numbers">16</span>
<span class="line-numbers">17</span><span class="keyword">import</span> <span class="include">java.lang.management.MemoryMXBean</span>;
<span class="line-numbers">18</span><span class="keyword">import</span> <span class="include">java.lang.management.ManagementFactory</span>;
<span class="line-numbers">19</span>
<span class="line-numbers">20</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.Liveness</span>;
<span class="line-numbers">21</span>
<span class="line-numbers">22</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.HealthCheck</span>;
<span class="line-numbers">23</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.HealthCheckResponse</span>;
<span class="line-numbers">24</span>
<span class="line-numbers">25</span><span class="annotation">@Liveness</span>
<span class="line-numbers">26</span><span class="annotation">@ApplicationScoped</span>
<span class="line-numbers">27</span><span class="directive">public</span> <span class="type">class</span> <span class="class">InventoryLivenessCheck</span> <span class="directive">implements</span> HealthCheck {
<span class="line-numbers">28</span>  <span class="annotation">@Override</span>
<span class="line-numbers">29</span>  <span class="directive">public</span> HealthCheckResponse call() {
<span class="line-numbers">30</span>      <span class="predefined-type">MemoryMXBean</span> memBean = <span class="predefined-type">ManagementFactory</span>.getMemoryMXBean();
<span class="line-numbers">31</span>      <span class="type">long</span> memUsed = memBean.getHeapMemoryUsage().getUsed();
<span class="line-numbers">32</span>      <span class="type">long</span> memMax = memBean.getHeapMemoryUsage().getMax();
<span class="line-numbers">33</span>
<span class="line-numbers">34</span>      <span class="keyword">return</span> HealthCheckResponse.named(
<span class="line-numbers">35</span>        InventoryResource.class.getSimpleName() + <span class="string"><span class="delimiter">"</span><span class="content"> Liveness Check</span><span class="delimiter">"</span></span>)
<span class="line-numbers">36</span>                                .status(memUsed &lt; memMax * <span class="float">0.9</span>).build();
<span class="line-numbers">37</span>  }
<span class="line-numbers">38</span>}
<span class="line-numbers">39</span><span class="comment">// end::InventoryLivenessCheck[]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As with the <code>system</code> liveness check, you are checking the heap memory usage. If more than 90% of the maximum memory is being used, a <code>DOWN</code> status is returned.</p>
</div>
<div class="listingblock code_command hotspot file=2">
<div class="content">
<pre><mark>Create the <code>InventoryReadinessCheck</code> class.</mark>
<code>src/main/java/io/openliberty/guides/inventory/InventoryReadinessCheck.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>InventoryReadinessCheck.java</p>
</div>
<div class="listingblock code_column tags=InventoryReadinessCheck hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="line-numbers"> 1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers"> 2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers"> 3</span><span class="comment"> * Copyright (c) 2018, 2022 IBM Corporation and others.</span>
<span class="line-numbers"> 4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers"> 5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers"> 6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers"> 7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers"> 8</span><span class="comment"> *</span>
<span class="line-numbers"> 9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers">10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers">11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers">12</span><span class="comment">// tag::InventoryReadinessCheck[]</span>
<span class="line-numbers">13</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.inventory</span>;
<span class="line-numbers">14</span>
<span class="line-numbers">15</span><span class="keyword">import</span> <span class="include">jakarta.enterprise.context.ApplicationScoped</span>;
<span class="line-numbers">16</span><span class="keyword">import</span> <span class="include">jakarta.inject.Inject</span>;
<span class="line-numbers">17</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.client.Client</span>;
<span class="line-numbers">18</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.client.ClientBuilder</span>;
<span class="line-numbers">19</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.MediaType</span>;
<span class="line-numbers">20</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.Response</span>;
<span class="line-numbers">21</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.Readiness</span>;
<span class="line-numbers">22</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.HealthCheck</span>;
<span class="line-numbers">23</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.health.HealthCheckResponse</span>;
<span class="line-numbers">24</span>
<span class="line-numbers">25</span><span class="annotation">@Readiness</span>
<span class="line-numbers">26</span><span class="annotation">@ApplicationScoped</span>
<span class="line-numbers">27</span><span class="directive">public</span> <span class="type">class</span> <span class="class">InventoryReadinessCheck</span> <span class="directive">implements</span> HealthCheck {
<span class="line-numbers">28</span>
<span class="line-numbers">29</span>  <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> READINESS_CHECK = InventoryResource.class.getSimpleName()
<span class="line-numbers">30</span>                                               + <span class="string"><span class="delimiter">"</span><span class="content"> Readiness Check</span><span class="delimiter">"</span></span>;
<span class="line-numbers">31</span>  <span class="annotation">@Inject</span>
<span class="line-numbers">32</span>  <span class="comment">// tag::inventoryConfig[]</span>
<span class="line-numbers">33</span>  InventoryConfig config;
<span class="line-numbers">34</span>  <span class="comment">// end::inventoryConfig[]</span>
<span class="line-numbers">35</span>
<span class="line-numbers">36</span>  <span class="comment">// tag::isHealthy[]</span>
<span class="line-numbers">37</span>  <span class="directive">public</span> <span class="type">boolean</span> isHealthy() {
<span class="line-numbers">38</span>    <span class="keyword">if</span> (config.isInMaintenance()) {
<span class="line-numbers">39</span>      <span class="keyword">return</span> <span class="predefined-constant">false</span>;
<span class="line-numbers">40</span>    }
<span class="line-numbers">41</span>    <span class="keyword">try</span> {
<span class="line-numbers">42</span>      <span class="predefined-type">String</span> url = InventoryUtils.buildUrl(<span class="string"><span class="delimiter">"</span><span class="content">http</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">localhost</span><span class="delimiter">"</span></span>, config.getPortNumber(),
<span class="line-numbers">43</span>          <span class="string"><span class="delimiter">"</span><span class="content">/system/properties</span><span class="delimiter">"</span></span>);
<span class="line-numbers">44</span>      Client client = ClientBuilder.newClient();
<span class="line-numbers">45</span>      <span class="comment">// tag::getRequest[]</span>
<span class="line-numbers">46</span>      Response response = client.target(url).request(MediaType.APPLICATION_JSON).get();
<span class="line-numbers">47</span>      <span class="comment">// end::getRequest[]</span>
<span class="line-numbers">48</span>      <span class="keyword">if</span> (response.getStatus() != <span class="integer">200</span>) {
<span class="line-numbers">49</span>        <span class="keyword">return</span> <span class="predefined-constant">false</span>;
<span class="line-numbers">50</span>      }
<span class="line-numbers">51</span>      <span class="keyword">return</span> <span class="predefined-constant">true</span>;
<span class="line-numbers">52</span>    } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
<span class="line-numbers">53</span>      <span class="keyword">return</span> <span class="predefined-constant">false</span>;
<span class="line-numbers">54</span>    }
<span class="line-numbers">55</span>  }
<span class="line-numbers">56</span>  <span class="comment">// end::isHealthy[]</span>
<span class="line-numbers">57</span>
<span class="line-numbers">58</span>  <span class="annotation">@Override</span>
<span class="line-numbers">59</span>  <span class="directive">public</span> HealthCheckResponse call() {
<span class="line-numbers">60</span>    <span class="keyword">if</span> (!isHealthy()) {
<span class="line-numbers">61</span>      <span class="keyword">return</span> HealthCheckResponse
<span class="line-numbers">62</span>          .down(READINESS_CHECK);
<span class="line-numbers">63</span>    }
<span class="line-numbers">64</span>    <span class="keyword">return</span> HealthCheckResponse
<span class="line-numbers">65</span>        .up(READINESS_CHECK);
<span class="line-numbers">66</span>  }
<span class="line-numbers">67</span>
<span class="line-numbers">68</span>}
<span class="line-numbers">69</span><span class="comment">// end::InventoryReadinessCheck[]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the <code class="hotspot=isHealthy file=2">isHealthy()</code> method, you report the <code>inventory</code> service as not ready if the service is in maintenance or if its dependant service is unavailable.</p>
</div>
<div class="paragraph">
<p>For simplicity, the custom <code class="hotspot=3 file=3">io_openliberty_guides_inventory_inMaintenance</code> MicroProfile Config property, which is defined in the <code class="hotspot file=3">resources/CustomConfigSource.json</code> file, indicates whether the service is in maintenance. This file was already created for you.</p>
</div>
<div class="paragraph">
<p>Moreover, the readiness health check procedure makes an HTTP <code class="hotspot=getRequest file=2">GET</code> request to the <code>system</code> service and checks its status. If the request is successful, the <code>inventory</code> service is healthy and ready because its dependant service is available. Otherwise, the <code>inventory</code> service is not ready and an unhealthy readiness status is returned.</p>
</div>
<div class="paragraph">
<p>If you are curious about the injected <code class="hotspot=inventoryConfig file=2">inventoryConfig</code> object or if you want to learn more about MicroProfile Config, see <a href="https://openliberty.io/guides/microprofile-config.html" target="_blank" rel="noopener">Configuring microservices</a>.</p>
</div>
<div class="paragraph">
<p>CustomConfigSource.json</p>
</div>
<div class="listingblock code_column">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><span class="line-numbers">1</span>{
<span class="line-numbers">2</span>    <span class="key"><span class="delimiter">"</span><span class="content">config_ordinal</span><span class="delimiter">"</span></span>:<span class="integer">700</span>,
<span class="line-numbers">3</span>    <span class="key"><span class="delimiter">"</span><span class="content">io_openliberty_guides_inventory_inMaintenance</span><span class="delimiter">"</span></span>:<span class="value">false</span>
<span class="line-numbers">4</span>}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 command">
<h2 id="running-the-application">Running the application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You started the Open Liberty in dev mode at the beginning of the guide, so all the changes were automatically picked up.</p>
</div>
<div class="paragraph">
<p>While the Liberty is running, navigate to the <a href="http://localhost:9080/health" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9080/health</a> URL to find the aggregated startup, liveness, and readiness health reports on the two services.</p>
</div>
<div class="paragraph">
<p>You can also navigate to the <a href="http://localhost:9080/health/started" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9080/health/started</a> URL to view the startup health report, to the <a href="http://localhost:9080/health/live" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9080/health/live</a> URL to view the liveness health report or the <a href="http://localhost:9080/health/ready" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9080/health/ready</a> URL to view the readiness health report.</p>
</div>
<div class="paragraph">
<p>Put the <code>inventory</code> service in maintenance by setting the <code class="hotspot=3">io_openliberty_guides_inventory_inMaintenance</code> property to <code>true</code> in the <code class="hotspot">CustomConfigSource.json</code> file.</p>
</div>
<div class="listingblock code_command hotspot file=0">
<div class="content">
<pre><mark>Replace the <code>CustomConfigSource.json</code> file.</mark>
<code>resources/CustomConfigSource.json</code></pre>
</div>
</div>
<div class="paragraph">
<p>CustomConfigSource.json</p>
</div>
<div class="listingblock code_column">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><span class="line-numbers">1</span>{
<span class="line-numbers">2</span>    <span class="key"><span class="delimiter">"</span><span class="content">config_ordinal</span><span class="delimiter">"</span></span>:<span class="integer">700</span>,
<span class="line-numbers">3</span>    <span class="key"><span class="delimiter">"</span><span class="content">io_openliberty_guides_inventory_inMaintenance</span><span class="delimiter">"</span></span>:<span class="value">true</span>
<span class="line-numbers">4</span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because this configuration file is picked up dynamically, simply refresh the <a href="http://localhost:9080/health" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9080/health</a> URL to see that the state of the <code>inventory</code> service changed to <code>DOWN</code>. The overall state of the application also changed to <code>DOWN</code> as a result. Go to the <a href="http://localhost:9080/inventory/systems" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9080/inventory/systems</a> URL to verify that the <code>inventory</code> service is indeed in maintenance. Set the <code class="hotspot=3">io_openliberty_guides_inventory_inMaintenance</code> property back to <code>false</code> after you are done.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing-health-checks">Testing health checks</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You will implement several test methods to validate the health of the <code>system</code> and <code>inventory</code> services.</p>
</div>
<div class="listingblock code_command hotspot file=0">
<div class="content">
<pre><mark>Create the <code>HealthIT</code> class.</mark>
<code>src/test/java/it/io/openliberty/guides/health/HealthIT.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>HealthIT.java</p>
</div>
<div class="listingblock code_column tags=HealthIT hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="line-numbers">  1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers">  2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers">  3</span><span class="comment"> * Copyright (c) 2018, 2022 IBM Corporation and others.</span>
<span class="line-numbers">  4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers">  5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers">  6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers">  7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers">  8</span><span class="comment"> *</span>
<span class="line-numbers">  9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers"> 10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers"> 11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers"> 12</span><span class="comment">// tag::HealthIT[]</span>
<span class="line-numbers"> 13</span><span class="keyword">package</span> <span class="namespace">it.io.openliberty.guides.health</span>;
<span class="line-numbers"> 14</span>
<span class="line-numbers"> 15</span><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertEquals</span>;
<span class="line-numbers"> 16</span>
<span class="line-numbers"> 17</span><span class="keyword">import</span> <span class="include">java.beans.Transient</span>;
<span class="line-numbers"> 18</span><span class="keyword">import</span> <span class="include">java.util.HashMap</span>;
<span class="line-numbers"> 19</span>
<span class="line-numbers"> 20</span><span class="keyword">import</span> <span class="include">jakarta.json.JsonArray</span>;
<span class="line-numbers"> 21</span>
<span class="line-numbers"> 22</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.AfterEach</span>;
<span class="line-numbers"> 23</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.BeforeEach</span>;
<span class="line-numbers"> 24</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;
<span class="line-numbers"> 25</span>
<span class="line-numbers"> 26</span><span class="directive">public</span> <span class="type">class</span> <span class="class">HealthIT</span> {
<span class="line-numbers"> 27</span>
<span class="line-numbers"> 28</span>  <span class="directive">private</span> JsonArray servicesStates;
<span class="line-numbers"> 29</span>  <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; endpointData;
<span class="line-numbers"> 30</span>
<span class="line-numbers"> 31</span>  <span class="directive">private</span> <span class="predefined-type">String</span> HEALTH_ENDPOINT = <span class="string"><span class="delimiter">"</span><span class="content">health</span><span class="delimiter">"</span></span>;
<span class="line-numbers"> 32</span>  <span class="directive">private</span> <span class="predefined-type">String</span> READINESS_ENDPOINT = <span class="string"><span class="delimiter">"</span><span class="content">health/ready</span><span class="delimiter">"</span></span>;
<span class="line-numbers"> 33</span>  <span class="directive">private</span> <span class="predefined-type">String</span> LIVENES_ENDPOINT = <span class="string"><span class="delimiter">"</span><span class="content">health/live</span><span class="delimiter">"</span></span>;
<span class="line-numbers"> 34</span>  <span class="directive">private</span> <span class="predefined-type">String</span> STARTUP_ENDPOINT = <span class="string"><span class="delimiter">"</span><span class="content">health/started</span><span class="delimiter">"</span></span>;
<span class="line-numbers"> 35</span>
<span class="line-numbers"> 36</span>  <span class="annotation">@BeforeEach</span>
<span class="line-numbers"> 37</span>  <span class="directive">public</span> <span class="type">void</span> setup() {
<span class="line-numbers"> 38</span>    endpointData = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;();
<span class="line-numbers"> 39</span>  }
<span class="line-numbers"> 40</span>
<span class="line-numbers"> 41</span>  <span class="annotation">@Test</span>
<span class="line-numbers"> 42</span>  <span class="comment">// tag::testStartup[]</span>
<span class="line-numbers"> 43</span>  <span class="directive">public</span> <span class="type">void</span> testStartup() {
<span class="line-numbers"> 44</span>    endpointData.put(<span class="string"><span class="delimiter">"</span><span class="content">InventoryResource Startup Check</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">UP</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 45</span>    endpointData.put(<span class="string"><span class="delimiter">"</span><span class="content">SystemResource Startup Check</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">UP</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 46</span>
<span class="line-numbers"> 47</span>    servicesStates = HealthITUtil.connectToHealthEnpoint(<span class="integer">200</span>, STARTUP_ENDPOINT);
<span class="line-numbers"> 48</span>    checkStates(endpointData, servicesStates);
<span class="line-numbers"> 49</span>  }
<span class="line-numbers"> 50</span>  <span class="comment">// end::testStartup[]</span>
<span class="line-numbers"> 51</span>
<span class="line-numbers"> 52</span>  <span class="annotation">@Test</span>
<span class="line-numbers"> 53</span>  <span class="comment">// tag::testLiveness[]</span>
<span class="line-numbers"> 54</span>  <span class="directive">public</span> <span class="type">void</span> testLiveness() {
<span class="line-numbers"> 55</span>    endpointData.put(<span class="string"><span class="delimiter">"</span><span class="content">SystemResource Liveness Check</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">UP</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 56</span>    endpointData.put(<span class="string"><span class="delimiter">"</span><span class="content">InventoryResource Liveness Check</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">UP</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 57</span>
<span class="line-numbers"> 58</span>    servicesStates = HealthITUtil.connectToHealthEnpoint(<span class="integer">200</span>, LIVENES_ENDPOINT);
<span class="line-numbers"> 59</span>    checkStates(endpointData, servicesStates);
<span class="line-numbers"> 60</span>  }
<span class="line-numbers"> 61</span>  <span class="comment">// end::testLiveness[]</span>
<span class="line-numbers"> 62</span>
<span class="line-numbers"> 63</span>  <span class="annotation">@Test</span>
<span class="line-numbers"> 64</span>  <span class="comment">// tag::testReadiness[]</span>
<span class="line-numbers"> 65</span>  <span class="directive">public</span> <span class="type">void</span> testReadiness() {
<span class="line-numbers"> 66</span>    endpointData.put(<span class="string"><span class="delimiter">"</span><span class="content">SystemResource Readiness Check</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">UP</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 67</span>    endpointData.put(<span class="string"><span class="delimiter">"</span><span class="content">InventoryResource Readiness Check</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">UP</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 68</span>
<span class="line-numbers"> 69</span>    servicesStates = HealthITUtil.connectToHealthEnpoint(<span class="integer">200</span>, READINESS_ENDPOINT);
<span class="line-numbers"> 70</span>    checkStates(endpointData, servicesStates);
<span class="line-numbers"> 71</span>  }
<span class="line-numbers"> 72</span>  <span class="comment">// end::testReadiness[]</span>
<span class="line-numbers"> 73</span>
<span class="line-numbers"> 74</span>  <span class="annotation">@Test</span>
<span class="line-numbers"> 75</span>  <span class="comment">// tag::testHealth[]</span>
<span class="line-numbers"> 76</span>  <span class="directive">public</span> <span class="type">void</span> testHealth() {
<span class="line-numbers"> 77</span>    endpointData.put(<span class="string"><span class="delimiter">"</span><span class="content">SystemResource Startup Check</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">UP</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 78</span>    endpointData.put(<span class="string"><span class="delimiter">"</span><span class="content">SystemResource Liveness Check</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">UP</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 79</span>    endpointData.put(<span class="string"><span class="delimiter">"</span><span class="content">SystemResource Readiness Check</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">UP</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 80</span>    endpointData.put(<span class="string"><span class="delimiter">"</span><span class="content">InventoryResource Startup Check</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">UP</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 81</span>    endpointData.put(<span class="string"><span class="delimiter">"</span><span class="content">InventoryResource Liveness Check</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">UP</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 82</span>    endpointData.put(<span class="string"><span class="delimiter">"</span><span class="content">InventoryResource Readiness Check</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">UP</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 83</span>
<span class="line-numbers"> 84</span>    servicesStates = HealthITUtil.connectToHealthEnpoint(<span class="integer">200</span>, HEALTH_ENDPOINT);
<span class="line-numbers"> 85</span>    checkStates(endpointData, servicesStates);
<span class="line-numbers"> 86</span>
<span class="line-numbers"> 87</span>    endpointData.put(<span class="string"><span class="delimiter">"</span><span class="content">InventoryResource Readiness Check</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">DOWN</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 88</span>    HealthITUtil.changeInventoryProperty(HealthITUtil.INV_MAINTENANCE_FALSE,
<span class="line-numbers"> 89</span>        HealthITUtil.INV_MAINTENANCE_TRUE);
<span class="line-numbers"> 90</span>    servicesStates = HealthITUtil.connectToHealthEnpoint(<span class="integer">503</span>, HEALTH_ENDPOINT);
<span class="line-numbers"> 91</span>    checkStates(endpointData, servicesStates);
<span class="line-numbers"> 92</span>  }
<span class="line-numbers"> 93</span>  <span class="comment">// end::testHealth[]</span>
<span class="line-numbers"> 94</span>
<span class="line-numbers"> 95</span>  <span class="directive">private</span> <span class="type">void</span> checkStates(<span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; testData, JsonArray servStates) {
<span class="line-numbers"> 96</span>    testData.forEach((service, expectedState) -&gt; {
<span class="line-numbers"> 97</span>      assertEquals(expectedState, HealthITUtil.getActualState(service, servStates),
<span class="line-numbers"> 98</span>          <span class="string"><span class="delimiter">"</span><span class="content">The state of </span><span class="delimiter">"</span></span> + service + <span class="string"><span class="delimiter">"</span><span class="content"> service is not matching.</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 99</span>    });
<span class="line-numbers">100</span>  }
<span class="line-numbers">101</span>
<span class="line-numbers">102</span>  <span class="annotation">@AfterEach</span>
<span class="line-numbers">103</span>  <span class="directive">public</span> <span class="type">void</span> teardown() {
<span class="line-numbers">104</span>    HealthITUtil.cleanUp();
<span class="line-numbers">105</span>  }
<span class="line-numbers">106</span>
<span class="line-numbers">107</span>}
<span class="line-numbers">108</span><span class="comment">// end::HealthIT[]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Let’s break down the test cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code class="hotspot=testStartup file=0">testStartup()</code> test case compares the generated health report for the startup checks with the actual status of the services.</p>
</li>
<li>
<p>The <code class="hotspot=testLiveness file=0">testLiveness()</code> test case compares the generated health report for the liveness checks with the actual status of the services.</p>
</li>
<li>
<p>The <code class="hotspot=testReadiness file=0">testReadiness()</code> test case compares the generated health report for the readiness checks with the actual status of the services.</p>
</li>
<li>
<p>The <code class="hotspot=testHealth file=0">testHealth()</code> test case compares the generated health report with the actual status of the services. This test also puts the <code>inventory</code> service in maintenance by setting the <code class="hotspot=3 file=1">io_openliberty_guides_inventory_inMaintenance</code> property to <code>true</code> and comparing the generated health report with the actual status of the services.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A few more tests were included to verify the basic functionality of the <code>system</code> and <code>inventory</code> services. They can be found under the <code class="hotspot file=2">src/test/java/it/io/openliberty/guides/inventory/InventoryEndpointIT.java</code> and <code class="hotspot file=3">src/test/java/it/io/openliberty/guides/system/SystemEndpointIT.java</code> files. If a test failure occurs, then you might have introduced a bug into the code. These tests run automatically as a part of the integration test suite.</p>
</div>
<div class="paragraph">
<p>CustomConfigSource.json</p>
</div>
<div class="listingblock code_column">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json"><span class="line-numbers">1</span>{
<span class="line-numbers">2</span>    <span class="key"><span class="delimiter">"</span><span class="content">config_ordinal</span><span class="delimiter">"</span></span>:<span class="integer">700</span>,
<span class="line-numbers">3</span>    <span class="key"><span class="delimiter">"</span><span class="content">io_openliberty_guides_inventory_inMaintenance</span><span class="delimiter">"</span></span>:<span class="value">false</span>
<span class="line-numbers">4</span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>InventoryEndpointIT.java</p>
</div>
<div class="listingblock code_column hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="Java"><span class="line-numbers">  1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers">  2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers">  3</span><span class="comment"> * Copyright (c) 2017, 2022 IBM Corporation and others.</span>
<span class="line-numbers">  4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers">  5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers">  6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers">  7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers">  8</span><span class="comment"> *</span>
<span class="line-numbers">  9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers"> 10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers"> 11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers"> 12</span><span class="comment">// tag::testClass[]</span>
<span class="line-numbers"> 13</span><span class="keyword">package</span> <span class="namespace">it.io.openliberty.guides.inventory</span>;
<span class="line-numbers"> 14</span>
<span class="line-numbers"> 15</span><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertEquals</span>;
<span class="line-numbers"> 16</span><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertTrue</span>;
<span class="line-numbers"> 17</span>
<span class="line-numbers"> 18</span><span class="keyword">import</span> <span class="include">jakarta.json.JsonArray</span>;
<span class="line-numbers"> 19</span><span class="keyword">import</span> <span class="include">jakarta.json.JsonObject</span>;
<span class="line-numbers"> 20</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.client.Client</span>;
<span class="line-numbers"> 21</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.client.ClientBuilder</span>;
<span class="line-numbers"> 22</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.MediaType</span>;
<span class="line-numbers"> 23</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.Response</span>;
<span class="line-numbers"> 24</span>
<span class="line-numbers"> 25</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.AfterEach</span>;
<span class="line-numbers"> 26</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.BeforeAll</span>;
<span class="line-numbers"> 27</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.BeforeEach</span>;
<span class="line-numbers"> 28</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.MethodOrderer.OrderAnnotation</span>;
<span class="line-numbers"> 29</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Order</span>;
<span class="line-numbers"> 30</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;
<span class="line-numbers"> 31</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.TestMethodOrder</span>;
<span class="line-numbers"> 32</span>
<span class="line-numbers"> 33</span><span class="annotation">@TestMethodOrder</span>(OrderAnnotation.class)
<span class="line-numbers"> 34</span><span class="directive">public</span> <span class="type">class</span> <span class="class">InventoryEndpointIT</span> {
<span class="line-numbers"> 35</span>
<span class="line-numbers"> 36</span>  <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">String</span> port;
<span class="line-numbers"> 37</span>  <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">String</span> baseUrl;
<span class="line-numbers"> 38</span>
<span class="line-numbers"> 39</span>  <span class="directive">private</span> Client client;
<span class="line-numbers"> 40</span>
<span class="line-numbers"> 41</span>  <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">String</span> SYSTEM_PROPERTIES = <span class="string"><span class="delimiter">"</span><span class="content">system/properties</span><span class="delimiter">"</span></span>;
<span class="line-numbers"> 42</span>  <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">String</span> INVENTORY_SYSTEMS = <span class="string"><span class="delimiter">"</span><span class="content">inventory/systems</span><span class="delimiter">"</span></span>;
<span class="line-numbers"> 43</span>
<span class="line-numbers"> 44</span>  <span class="annotation">@BeforeAll</span>
<span class="line-numbers"> 45</span>  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> oneTimeSetup() {
<span class="line-numbers"> 46</span>    port = <span class="predefined-type">System</span>.getProperty(<span class="string"><span class="delimiter">"</span><span class="content">default.http.port</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 47</span>    baseUrl = <span class="string"><span class="delimiter">"</span><span class="content">http://localhost:</span><span class="delimiter">"</span></span> + port + <span class="string"><span class="delimiter">"</span><span class="content">/</span><span class="delimiter">"</span></span>;
<span class="line-numbers"> 48</span>  }
<span class="line-numbers"> 49</span>
<span class="line-numbers"> 50</span>  <span class="annotation">@BeforeEach</span>
<span class="line-numbers"> 51</span>  <span class="directive">public</span> <span class="type">void</span> setup() {
<span class="line-numbers"> 52</span>    client = ClientBuilder.newClient();
<span class="line-numbers"> 53</span>  }
<span class="line-numbers"> 54</span>
<span class="line-numbers"> 55</span>  <span class="annotation">@AfterEach</span>
<span class="line-numbers"> 56</span>  <span class="directive">public</span> <span class="type">void</span> teardown() {
<span class="line-numbers"> 57</span>    client.close();
<span class="line-numbers"> 58</span>  }
<span class="line-numbers"> 59</span>
<span class="line-numbers"> 60</span>  <span class="comment">// tag::tests[]</span>
<span class="line-numbers"> 61</span>  <span class="annotation">@Test</span>
<span class="line-numbers"> 62</span>  <span class="annotation">@Order</span>(<span class="integer">1</span>)
<span class="line-numbers"> 63</span>  <span class="comment">// tag::testHostRegistration[]</span>
<span class="line-numbers"> 64</span>  <span class="directive">public</span> <span class="type">void</span> testHostRegistration() {
<span class="line-numbers"> 65</span>    <span class="local-variable">this</span>.visitLocalhost();
<span class="line-numbers"> 66</span>
<span class="line-numbers"> 67</span>    Response response = <span class="local-variable">this</span>.getResponse(baseUrl + INVENTORY_SYSTEMS);
<span class="line-numbers"> 68</span>    <span class="local-variable">this</span>.assertResponse(baseUrl, response);
<span class="line-numbers"> 69</span>
<span class="line-numbers"> 70</span>    JsonObject obj = response.readEntity(JsonObject.class);
<span class="line-numbers"> 71</span>
<span class="line-numbers"> 72</span>    JsonArray systems = obj.getJsonArray(<span class="string"><span class="delimiter">"</span><span class="content">systems</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 73</span>
<span class="line-numbers"> 74</span>    <span class="type">boolean</span> localhostExists = <span class="predefined-constant">false</span>;
<span class="line-numbers"> 75</span>    <span class="keyword">for</span> (<span class="type">int</span> n = <span class="integer">0</span>; n &lt; systems.size(); n++) {
<span class="line-numbers"> 76</span>      localhostExists = systems.getJsonObject(n).get(<span class="string"><span class="delimiter">"</span><span class="content">hostname</span><span class="delimiter">"</span></span>).toString()
<span class="line-numbers"> 77</span>          .contains(<span class="string"><span class="delimiter">"</span><span class="content">localhost</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 78</span>      <span class="keyword">if</span> (localhostExists) {
<span class="line-numbers"> 79</span>        <span class="keyword">break</span>;
<span class="line-numbers"> 80</span>      }
<span class="line-numbers"> 81</span>    }
<span class="line-numbers"> 82</span>    assertTrue(localhostExists, <span class="string"><span class="delimiter">"</span><span class="content">A host was registered, but it was not localhost</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 83</span>
<span class="line-numbers"> 84</span>    response.close();
<span class="line-numbers"> 85</span>  }
<span class="line-numbers"> 86</span>  <span class="comment">// end::testHostRegistration[]</span>
<span class="line-numbers"> 87</span>
<span class="line-numbers"> 88</span>  <span class="annotation">@Test</span>
<span class="line-numbers"> 89</span>  <span class="annotation">@Order</span>(<span class="integer">2</span>)
<span class="line-numbers"> 90</span>  <span class="comment">// tag::testSystemPropertiesMatch[]</span>
<span class="line-numbers"> 91</span>  <span class="directive">public</span> <span class="type">void</span> testSystemPropertiesMatch() {
<span class="line-numbers"> 92</span>    Response invResponse = <span class="local-variable">this</span>.getResponse(baseUrl + INVENTORY_SYSTEMS);
<span class="line-numbers"> 93</span>    Response sysResponse = <span class="local-variable">this</span>.getResponse(baseUrl + SYSTEM_PROPERTIES);
<span class="line-numbers"> 94</span>
<span class="line-numbers"> 95</span>    <span class="local-variable">this</span>.assertResponse(baseUrl, invResponse);
<span class="line-numbers"> 96</span>    <span class="local-variable">this</span>.assertResponse(baseUrl, sysResponse);
<span class="line-numbers"> 97</span>
<span class="line-numbers"> 98</span>    JsonObject jsonFromInventory = (JsonObject) invResponse.readEntity(JsonObject.class)
<span class="line-numbers"> 99</span>                                                           .getJsonArray(<span class="string"><span class="delimiter">"</span><span class="content">systems</span><span class="delimiter">"</span></span>)
<span class="line-numbers">100</span>                                                           .getJsonObject(<span class="integer">0</span>)
<span class="line-numbers">101</span>                                                           .get(<span class="string"><span class="delimiter">"</span><span class="content">properties</span><span class="delimiter">"</span></span>);
<span class="line-numbers">102</span>
<span class="line-numbers">103</span>    JsonObject jsonFromSystem = sysResponse.readEntity(JsonObject.class);
<span class="line-numbers">104</span>
<span class="line-numbers">105</span>    <span class="predefined-type">String</span> osNameFromInventory = jsonFromInventory.getString(<span class="string"><span class="delimiter">"</span><span class="content">os.name</span><span class="delimiter">"</span></span>);
<span class="line-numbers">106</span>    <span class="predefined-type">String</span> osNameFromSystem = jsonFromSystem.getString(<span class="string"><span class="delimiter">"</span><span class="content">os.name</span><span class="delimiter">"</span></span>);
<span class="line-numbers">107</span>    <span class="local-variable">this</span>.assertProperty(<span class="string"><span class="delimiter">"</span><span class="content">os.name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">localhost</span><span class="delimiter">"</span></span>, osNameFromSystem,
<span class="line-numbers">108</span>                        osNameFromInventory);
<span class="line-numbers">109</span>
<span class="line-numbers">110</span>    <span class="predefined-type">String</span> userNameFromInventory = jsonFromInventory.getString(<span class="string"><span class="delimiter">"</span><span class="content">user.name</span><span class="delimiter">"</span></span>);
<span class="line-numbers">111</span>    <span class="predefined-type">String</span> userNameFromSystem = jsonFromSystem.getString(<span class="string"><span class="delimiter">"</span><span class="content">user.name</span><span class="delimiter">"</span></span>);
<span class="line-numbers">112</span>    <span class="local-variable">this</span>.assertProperty(<span class="string"><span class="delimiter">"</span><span class="content">user.name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">localhost</span><span class="delimiter">"</span></span>, userNameFromSystem,
<span class="line-numbers">113</span>                        userNameFromInventory);
<span class="line-numbers">114</span>
<span class="line-numbers">115</span>    invResponse.close();
<span class="line-numbers">116</span>    sysResponse.close();
<span class="line-numbers">117</span>  }
<span class="line-numbers">118</span>  <span class="comment">// end::testSystemPropertiesMatch[]</span>
<span class="line-numbers">119</span>
<span class="line-numbers">120</span>  <span class="annotation">@Test</span>
<span class="line-numbers">121</span>  <span class="annotation">@Order</span>(<span class="integer">3</span>)
<span class="line-numbers">122</span>  <span class="comment">// tag::testUnknownHost[]</span>
<span class="line-numbers">123</span>  <span class="directive">public</span> <span class="type">void</span> testUnknownHost() {
<span class="line-numbers">124</span>    Response response = <span class="local-variable">this</span>.getResponse(baseUrl + INVENTORY_SYSTEMS);
<span class="line-numbers">125</span>    <span class="local-variable">this</span>.assertResponse(baseUrl, response);
<span class="line-numbers">126</span>
<span class="line-numbers">127</span>    Response badResponse = client.target(baseUrl + INVENTORY_SYSTEMS + <span class="string"><span class="delimiter">"</span><span class="content">/</span><span class="delimiter">"</span></span>
<span class="line-numbers">128</span>        + <span class="string"><span class="delimiter">"</span><span class="content">badhostname</span><span class="delimiter">"</span></span>).request(MediaType.APPLICATION_JSON).get();
<span class="line-numbers">129</span>
<span class="line-numbers">130</span>    <span class="predefined-type">String</span> obj = badResponse.readEntity(<span class="predefined-type">String</span>.class);
<span class="line-numbers">131</span>
<span class="line-numbers">132</span>    <span class="type">boolean</span> isError = obj.contains(<span class="string"><span class="delimiter">"</span><span class="content">error</span><span class="delimiter">"</span></span>);
<span class="line-numbers">133</span>    assertTrue(isError,
<span class="line-numbers">134</span>        <span class="string"><span class="delimiter">"</span><span class="content">badhostname is not a valid host but it didn't raise an error</span><span class="delimiter">"</span></span>);
<span class="line-numbers">135</span>
<span class="line-numbers">136</span>    response.close();
<span class="line-numbers">137</span>    badResponse.close();
<span class="line-numbers">138</span>  }
<span class="line-numbers">139</span>
<span class="line-numbers">140</span>  <span class="comment">// end::testUnknownHost[]</span>
<span class="line-numbers">141</span>  <span class="comment">// end::tests[]</span>
<span class="line-numbers">142</span>  <span class="comment">// tag::helpers[]</span>
<span class="line-numbers">143</span>  <span class="comment">// tag::javadoc[]</span>
<span class="line-numbers">144</span>  <span class="comment">/**</span>
<span class="line-numbers">145</span><span class="comment">   * &lt;p&gt;</span>
<span class="line-numbers">146</span><span class="comment">   * Returns response information from the specified URL.</span>
<span class="line-numbers">147</span><span class="comment">   * &lt;/p&gt;</span>
<span class="line-numbers">148</span><span class="comment">   *</span>
<span class="line-numbers">149</span><span class="comment">   * @param url</span>
<span class="line-numbers">150</span><span class="comment">   *          - target URL.</span>
<span class="line-numbers">151</span><span class="comment">   * @return Response object with the response from the specified URL.</span>
<span class="line-numbers">152</span><span class="comment">   */</span>
<span class="line-numbers">153</span>  <span class="comment">// end::javadoc[]</span>
<span class="line-numbers">154</span>  <span class="directive">private</span> Response getResponse(<span class="predefined-type">String</span> url) {
<span class="line-numbers">155</span>    <span class="keyword">return</span> client.target(url).request().get();
<span class="line-numbers">156</span>  }
<span class="line-numbers">157</span>
<span class="line-numbers">158</span>  <span class="comment">// tag::javadoc[]</span>
<span class="line-numbers">159</span>  <span class="comment">/**</span>
<span class="line-numbers">160</span><span class="comment">   * &lt;p&gt;</span>
<span class="line-numbers">161</span><span class="comment">   * Asserts that the given URL has the correct response code of 200.</span>
<span class="line-numbers">162</span><span class="comment">   * &lt;/p&gt;</span>
<span class="line-numbers">163</span><span class="comment">   *</span>
<span class="line-numbers">164</span><span class="comment">   * @param url</span>
<span class="line-numbers">165</span><span class="comment">   *          - target URL.</span>
<span class="line-numbers">166</span><span class="comment">   * @param response</span>
<span class="line-numbers">167</span><span class="comment">   *          - response received from the target URL.</span>
<span class="line-numbers">168</span><span class="comment">   */</span>
<span class="line-numbers">169</span>  <span class="comment">// end::javadoc[]</span>
<span class="line-numbers">170</span>  <span class="directive">private</span> <span class="type">void</span> assertResponse(<span class="predefined-type">String</span> url, Response response) {
<span class="line-numbers">171</span>    assertEquals(<span class="integer">200</span>, response.getStatus(), <span class="string"><span class="delimiter">"</span><span class="content">Incorrect response code from </span><span class="delimiter">"</span></span> + url);
<span class="line-numbers">172</span>  }
<span class="line-numbers">173</span>
<span class="line-numbers">174</span>  <span class="comment">// tag::javadoc[]</span>
<span class="line-numbers">175</span>  <span class="comment">/**</span>
<span class="line-numbers">176</span><span class="comment">   * Asserts that the specified JVM system property is equivalent in both the</span>
<span class="line-numbers">177</span><span class="comment">   * system and inventory services.</span>
<span class="line-numbers">178</span><span class="comment">   *</span>
<span class="line-numbers">179</span><span class="comment">   * @param propertyName</span>
<span class="line-numbers">180</span><span class="comment">   *          - name of the system property to check.</span>
<span class="line-numbers">181</span><span class="comment">   * @param hostname</span>
<span class="line-numbers">182</span><span class="comment">   *          - name of JVM's host.</span>
<span class="line-numbers">183</span><span class="comment">   * @param expected</span>
<span class="line-numbers">184</span><span class="comment">   *          - expected name.</span>
<span class="line-numbers">185</span><span class="comment">   * @param actual</span>
<span class="line-numbers">186</span><span class="comment">   *          - actual name.</span>
<span class="line-numbers">187</span><span class="comment">   */</span>
<span class="line-numbers">188</span>  <span class="comment">// end::javadoc[]</span>
<span class="line-numbers">189</span>  <span class="directive">private</span> <span class="type">void</span> assertProperty(<span class="predefined-type">String</span> propertyName, <span class="predefined-type">String</span> hostname,
<span class="line-numbers">190</span>      <span class="predefined-type">String</span> expected, <span class="predefined-type">String</span> actual) {
<span class="line-numbers">191</span>    assertEquals(expected, actual, <span class="string"><span class="delimiter">"</span><span class="content">JVM system property [</span><span class="delimiter">"</span></span> + propertyName + <span class="string"><span class="delimiter">"</span><span class="content">] </span><span class="delimiter">"</span></span>
<span class="line-numbers">192</span>        + <span class="string"><span class="delimiter">"</span><span class="content">in the system service does not match the one stored in </span><span class="delimiter">"</span></span>
<span class="line-numbers">193</span>        + <span class="string"><span class="delimiter">"</span><span class="content">the inventory service for </span><span class="delimiter">"</span></span> + hostname);
<span class="line-numbers">194</span>  }
<span class="line-numbers">195</span>
<span class="line-numbers">196</span>  <span class="comment">// tag::javadoc[]</span>
<span class="line-numbers">197</span>  <span class="comment">/**</span>
<span class="line-numbers">198</span><span class="comment">   * Makes a simple GET request to inventory/localhost.</span>
<span class="line-numbers">199</span><span class="comment">   */</span>
<span class="line-numbers">200</span>  <span class="comment">// end::javadoc[]</span>
<span class="line-numbers">201</span>  <span class="directive">private</span> <span class="type">void</span> visitLocalhost() {
<span class="line-numbers">202</span>    Response response = <span class="local-variable">this</span>.getResponse(baseUrl + SYSTEM_PROPERTIES);
<span class="line-numbers">203</span>    <span class="local-variable">this</span>.assertResponse(baseUrl, response);
<span class="line-numbers">204</span>    response.close();
<span class="line-numbers">205</span>
<span class="line-numbers">206</span>    Response targetResponse = client.target(baseUrl + INVENTORY_SYSTEMS
<span class="line-numbers">207</span>        + <span class="string"><span class="delimiter">"</span><span class="content">/localhost</span><span class="delimiter">"</span></span>).request().get();
<span class="line-numbers">208</span>    targetResponse.close();
<span class="line-numbers">209</span>  }
<span class="line-numbers">210</span>  <span class="comment">// end::helpers[]</span>
<span class="line-numbers">211</span>}
<span class="line-numbers">212</span><span class="comment">// end::testClass[]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>SystemEndpointIT.java</p>
</div>
<div class="listingblock code_column hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="Java"><span class="line-numbers"> 1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers"> 2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers"> 3</span><span class="comment"> * Copyright (c) 2017, 2022 IBM Corporation and others.</span>
<span class="line-numbers"> 4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers"> 5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers"> 6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers"> 7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers"> 8</span><span class="comment"> *</span>
<span class="line-numbers"> 9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers">10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers">11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers">12</span><span class="keyword">package</span> <span class="namespace">it.io.openliberty.guides.system</span>;
<span class="line-numbers">13</span>
<span class="line-numbers">14</span><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertEquals</span>;
<span class="line-numbers">15</span>
<span class="line-numbers">16</span><span class="keyword">import</span> <span class="include">jakarta.json.JsonObject</span>;
<span class="line-numbers">17</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.client.Client</span>;
<span class="line-numbers">18</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.client.ClientBuilder</span>;
<span class="line-numbers">19</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.client.WebTarget</span>;
<span class="line-numbers">20</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.Response</span>;
<span class="line-numbers">21</span>
<span class="line-numbers">22</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;
<span class="line-numbers">23</span>
<span class="line-numbers">24</span><span class="directive">public</span> <span class="type">class</span> <span class="class">SystemEndpointIT</span> {
<span class="line-numbers">25</span>
<span class="line-numbers">26</span>  <span class="annotation">@Test</span>
<span class="line-numbers">27</span>  <span class="directive">public</span> <span class="type">void</span> testGetProperties() {
<span class="line-numbers">28</span>    <span class="predefined-type">String</span> port = <span class="predefined-type">System</span>.getProperty(<span class="string"><span class="delimiter">"</span><span class="content">default.http.port</span><span class="delimiter">"</span></span>);
<span class="line-numbers">29</span>    <span class="predefined-type">String</span> url = <span class="string"><span class="delimiter">"</span><span class="content">http://localhost:</span><span class="delimiter">"</span></span> + port + <span class="string"><span class="delimiter">"</span><span class="content">/</span><span class="delimiter">"</span></span>;
<span class="line-numbers">30</span>
<span class="line-numbers">31</span>    Client client = ClientBuilder.newClient();
<span class="line-numbers">32</span>
<span class="line-numbers">33</span>    WebTarget target = client.target(url + <span class="string"><span class="delimiter">"</span><span class="content">system/properties</span><span class="delimiter">"</span></span>);
<span class="line-numbers">34</span>    Response response = target.request().get();
<span class="line-numbers">35</span>
<span class="line-numbers">36</span>    assertEquals(<span class="integer">200</span>, response.getStatus(), <span class="string"><span class="delimiter">"</span><span class="content">Incorrect response code from </span><span class="delimiter">"</span></span> + url);
<span class="line-numbers">37</span>
<span class="line-numbers">38</span>    JsonObject obj = response.readEntity(JsonObject.class);
<span class="line-numbers">39</span>
<span class="line-numbers">40</span>    assertEquals(<span class="predefined-type">System</span>.getProperty(<span class="string"><span class="delimiter">"</span><span class="content">os.name</span><span class="delimiter">"</span></span>), obj.getString(<span class="string"><span class="delimiter">"</span><span class="content">os.name</span><span class="delimiter">"</span></span>),
<span class="line-numbers">41</span>        <span class="string"><span class="delimiter">"</span><span class="content">The system property for the local and remote JVM should match</span><span class="delimiter">"</span></span>);
<span class="line-numbers">42</span>
<span class="line-numbers">43</span>    response.close();
<span class="line-numbers">44</span>    client.close();
<span class="line-numbers">45</span>  }
<span class="line-numbers">46</span>}</code></pre>
</div>
</div>
<div class="sect2 command">
<h3 id="running-the-tests">Running the tests</h3>
<div class="paragraph">
<p>Because you started Open Liberty in dev mode, you can run the tests by pressing the <code>enter/return</code> key from the command-line session where you started dev mode.</p>
</div>
<div class="paragraph">
<p>You see the following output:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre class="CodeRay highlight"><code>[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running it.io.openliberty.guides.health.HealthIT
[INFO] [WARNING ] CWMMH0052W: The class io.openliberty.microprofile.health30.impl.HealthCheck30ResponseImpl implementing HealthCheckResponse in the guide-microprofile-health application in module guide-microprofile-health.war, reported a DOWN status with data Optional[{}].
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 3.706 s - in it.io.openliberty.guides.health.HealthIT
[INFO] Running it.io.openliberty.guides.system.SystemEndpointIT
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 s - in it.io.openliberty.guides.system.SystemEndpointIT
[INFO] Running it.io.openliberty.guides.inventory.InventoryEndpointIT
[INFO] [WARNING ] Interceptor for {http://client.inventory.guides.openliberty.io/}SystemClient has thrown exception, unwinding now
[INFO] Could not send Message.
[INFO] [err] The specified host is unknown.
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.171 s - in it.io.openliberty.guides.inventory.InventoryEndpointIT
[INFO]
[INFO] Results:
[INFO]
[INFO] Tests run: 8, Failures: 0, Errors: 0, Skipped: 0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The warning messages are expected. The first warning results from a request to a service that is under maintenance. This request is made in the <code>testHealth()</code> test from the <code>InventoryEndpointIT</code> integration test. The second warning and error results from a request to a bad or an unknown hostname. This request is made in the <code>testUnknownHost()</code> test from the <code>InventoryEndpointIT</code> integration test.</p>
</div>
<div class="paragraph">
<p>The tests might fail if your system CPU or memory use is high. The status of the system is DOWN if the CPU usage is over 95%, or the memory usage is over 90%.</p>
</div>
<div class="paragraph">
<p>To see whether the tests detect a failure, manually change the configuration of <code class="hotspot=3 file=1">io_openliberty_guides_inventory_inMaintenance</code> from <code>false</code> to <code>true</code> in the <code>resources/CustomConfigSource.json</code> file. Rerun the tests to see a test failure occur. The test failure occurs because the initial status of the <code>inventory</code> service is <code>DOWN</code>.</p>
</div>
<div class="paragraph command">
<p>When you are done checking out the service, exit dev mode by pressing <code>CTRL+C</code> in the command-line session where you ran Liberty, or by typing <code>q</code> and then pressing the <code>enter/return</code> key.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="great-work-youre-done">Great work! You’re done!</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You just learned how to add health checks to report the states of microservices by using MicroProfile Health in Open Liberty. Then, you wrote tests to validate the generated health report.</p>
</div>
<div class="paragraph">
<p>Feel free to try one of the related MicroProfile guides. They demonstrate additional technologies that you can learn and expand on top of what you built here.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="guide-attribution">Guide Attribution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Adding health reports to microservices <span class="licensedClass">by</span> Open Liberty <span class="licensedClass">is licensed under</span> CC BY-ND 4.0</p>
</div>
</div>
</div>
    </div>
  </div>

  <!-- Code section -->
  <div id="code_column" class="position_relative" tabindex="0">
    <div id="code_column_title_container">
      <div id="code_column_tabs_container" class="dimmed">
        <ul id="code_column_tabs" class="nav" role="tablist"></ul>
      </div>
      <div class="copyFileButton" tabindex="0">
        <img src="/img/guides_copy_button.svg" alt="Copy file contents" title="Copy file contents">
        <div id="code_section_copied_confirmation">Copied to clipboard </div>
      </div>
    </div>
    <div id="code_column_content"></div>

    <div id="prereqs_container">
      <p id="prereqs_title">Prerequisites:</p>
      <div class="prereqs_list"></div>
      <div class="skills_network_container">
        <div class="skills_network_description"></div>
      </div>
    </div>

    <button id="dismiss_button" aria-label="Back to text" tabindex="0">
      Back to text
    </button>
  </div>
</div>

<!-- Build a list of all the documents in the guides code base -->






<!-- Remove any documents deemed private (archived, templates, etc) -->


<!-- Count number of guides from past 30 days-->


    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    


<!-- Sort list of guides by date with most recent first -->





<div id="end_of_guide">
        <h2 tabindex="0">Nice work! Where to next?</h2>
        <div id="end_of_guide_left_section">
            <p id="guide_attribution"></p>
            
            <h3 id="feedback_rating_question">What did you think of this guide?</h3>
            <div id="feedback_ratings">
                <img class="guide_rating" id="extreme_dislike" src="/img/1_Extreme_Dislike.png" onclick="$('#dislike_popup').show(); $('.popup_content').focus();" alt="Extreme Dislike" data-guide-rating="1" tabindex="0" aria-label="Rate this guide as extreme dislike">
                <img class="guide_rating" id="dislike" src="/img/2_Dislike.png" onclick="$('#dislike_popup').show(); $('.popup_content').focus();" alt="Dislike" data-guide-rating="2" tabindex="0" aria-label="Rate this guide as dislike">
                <img class="guide_rating" id="like" src="/img/3_Like.png" onclick="$('#like_popup').show(); $('.popup_content').focus();" alt="Like" data-guide-rating="3" tabindex="0" aria-label="Rate this guide as like">
                <img class="guide_rating" id="extreme_like" src="/img/4_Extreme_Like.png" onclick="$('#like_popup').show(); $('.popup_content').focus();" alt="Extreme Like" data-guide-rating="4" tabindex="0" aria-label="Rate this guide as extreme like">
            </div>

            <div id="like_popup" class="popup">
                <div class="popup_content" tabindex="0">
                    <p class="popup_title">Thank you for your feedback!</p>
                    <button id="close_button" class="popup_button" onclick="$('#like_popup').hide();">Close</button>
                </div>
            </div>

            <div id="dislike_popup" class="popup">
                <div class="popup_content" tabindex="0">
                    <p class="popup_title">Thank you for your feedback!</p>
                    <p id="open_issue">Would you like to open an issue in GitHub?</p>
                    
                        <a href="https://github.com/OpenLiberty/guide-microprofile-health/issues/new" target="_blank" id="yes_button" class="popup_button" onclick="$('#dislike_popup').hide();" rel="noopener noreferrer">Yes</a>
                    
                    <button id="no_button" class="popup_button" onclick="$('#dislike_popup').hide();">No, thank you</button>
                </div>
            </div>

            <h3 id="improve_guide_feedback">What could make this guide better?</h3>
            
                <p><a target="_blank" rel="noopener noreferrer" href="https://github.com/OpenLiberty/guide-microprofile-health/issues">Raise an issue</a> to share feedback</p>
                <p><a target="_blank" rel="noopener noreferrer" href="https://github.com/OpenLiberty/guide-microprofile-health/pulls">Create a pull request</a> to contribute to this guide</p>
            

            <h3 id="need_help">Need help?</h3>
            <p><a target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/questions/tagged/open-liberty">Ask a question on Stack Overflow</a></p>

            <h3>Like Open Liberty? Star our repo on GitHub.</h3>
            <a class="github-button" href="https://github.com/OpenLiberty/open-liberty" data-icon="octicon-star" aria-label="Star OpenLiberty/open-liberty on GitHub" target="_blank" rel="noopener noreferrer">Star</a>
        </div>
        <div id="end_of_guide_right_section">
            <h3 id="where_to_next">Where to next?</h3>

            
            

            <!-- Related guides section -->
            
            <div id="related-guides">
                <div id="related-guides-cards" class="row">
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/microprofile-config.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Configuring microservices</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">20 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/microprofile-metrics.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Providing metrics from a microservice</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">15 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/cdi-intro.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Injecting dependencies into microservices</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">15 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/rest-intro.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Creating a RESTful web service</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">30 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                </div>
            </div>
            
        </div>
    </div>



    </main>

    



<footer>
    <div id="footer_gray_background">
        <div id="footer_top_container" class="footer_container container-fluid">
            <div id="footer_project_container">
                <span id="footer_open_liberty"></span>
                <p id="footer_project">IBM 开放式源代码项目</p>
            </div>
            <div id="footer_round_links_container">
                <a id="footer_github_link" class="footer_round_btn" href="https://github.com/OpenLiberty/" target="_blank" rel="noopener noreferrer" aria-label="Github"></a>
                <a id="footer_twitter_link" class="footer_round_btn" href="https://twitter.com/OpenLibertyIO" target="_blank" rel="noopener noreferrer" aria-label="Twitter"></a>
                <a id="footer_stackoverflow_link" class="footer_round_btn" href="https://stackoverflow.com/questions/tagged/open-liberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty questions on Stack Overflow"></a>
                <a id="footer_groupsio_link" class="footer_round_btn" href="https://groups.io/g/openliberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Groups.io"></a>
                <a id="footer_gitter_link" class="footer_round_btn" href="https://app.gitter.im/#/room/#OpenLiberty_development:gitter.im" target="_blank" rel="noopener" aria-label="Open Liberty Gitter"></a>
            </div>
        </div>         
    </div>

    <div id="footer_bottom_container" class="footer_container container-fluid">
        <div id="footer_bottom_left_section">
            <p id="footer_copyright">© Copyright IBM Corp. 2017, 2023</p>
            <p class="vertical_bar">|</p>
            <a id="footer_privacy_policy_link" href="https://www.ibm.com/privacy/" target="_blank" rel="noopener noreferrer" class="left_footer_link">隐私策略</a>
            <p class="vertical_bar">|</p>
            <a id="footer_license_link" href="https://github.com/OpenLiberty/open-liberty/blob/release/LICENSE" target="_blank" rel="noopener noreferrer" class="left_footer_link">许可证</a>
            <p class="vertical_bar">|</p>
            <a id="footer_logos_link" href="https://github.com/OpenLiberty/logos" target="_blank" rel="noopener noreferrer" class="left_footer_link">洛戈斯</a>
        </div>
        <div id="footer_bottom_right_section">
            <a id="footer_docs_link" href="/docs" aria-label="Open Liberty Docs" class="right_footer_link blue_link_light_background">文档</a>
            <a id="footer_blog_link" href="/blog" aria-label="Open Liberty Blog" class="right_footer_link blue_link_light_background">博客</a>
            <a id="footer_support_link" href="/support" aria-label="Open Liberty Support" class="right_footer_link blue_link_light_background">支持</a>
        </div>
    </div>
</footer>

<!-- PRE-LOADED IMAGES FOR ON HOVER BEHAVIOR -->
<div class="d-none hidden">
    <img src="/img/Footer_GitCat_Hover.svg" alt="OpenLiberty Github link">
    <img src="/img/Footer_TwitterBird_Hover.svg" alt="OpenLibertyIO Twitter link">
    <img src="/img/Footer_StackO_Hover.svg" alt="Open-liberty Stack Overflow link">
    <img src="/img/Footer_GroupsIO_Hover.svg" alt="Openliberty Groups IO link">
    <img src="/img/footer_gitter_hover.svg" alt="Openliberty Gitter link">
</div>

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js" integrity="sha512-lzilC+JFd6YV8+vQRNRtU7DOqv5Sa9Ek53lXt/k91HZTJpytHS1L6l1mMKR9K6VVoDt4LiEXaa6XBrYk1YhGTQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>


<script type="text/javascript" src="/zh-Hans/assets/devEnvironment.js"></script>




  <script type="text/javascript" src="/zh-Hans/assets/guide-common.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/toc.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/tabs.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/guide-static.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/guide-multipane-static.js"></script>


<script type="text/javascript" src="/zh-Hans/assets/openliberty.js"></script>

  </body>

</html>
