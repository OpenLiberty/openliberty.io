<!DOCTYPE html>
<html lang="zh-Hans">

  





<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>
    
      Enabling distributed tracing in Java microservices using Eclipse MicroProfile OpenTracing and the Zipkin tracing system.
    
  </title>
  <meta name="description" content="A getting started tutorial and an example on how to enable distributed tracing in Java microservices to easily trace request flows that span multiple resources by using MicroProfile OpenTracing and Zipkin tracing system.">

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
  

  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/openliberty.css">
  <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/coderay-custom.css">

  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/header.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/header-dark.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/toc-multipane-static.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/end-of-guide.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-card.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/tabs.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-common.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-multipane.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-multipane-static.css">
  

  

  

  <link rel="canonical" href="https://openliberty.io/zh-Hans/guides/microprofile-opentracing">
  <link rel="alternate" type="application/rss+xml" title="Open Liberty" href="/zh-Hans/feed.xml">
  <link href="https://fonts.googleapis.com/css?family=Asap:400,500" rel="stylesheet">
    
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@OpenLibertyIO" />
  <meta name="twitter:title" content="Enabling distributed tracing in Java microservices using Eclipse MicroProfile OpenTracing and the Zipkin tracing system." />
  <meta name="twitter:description" content="A getting started tutorial and an example on how to enable distributed tracing in Java microservices to easily trace request flows that span multiple resources by using MicroProfile OpenTracing and Zipkin tracing system." />

  <meta property='og:title' content="Enabling distributed tracing in Java microservices using Eclipse MicroProfile OpenTracing and the Zipkin tracing system." />
  <meta property='og:image' content="https://openliberty.io/img/twitter_card.jpg" />
  <meta property='og:image:alt' content="Open Liberty Logo" />
  <meta property='og:description' content="A getting started tutorial and an example on how to enable distributed tracing in Java microservices to easily trace request flows that span multiple resources by using MicroProfile OpenTracing and Zipkin tracing system." />
  <meta property='og:url' content="https://openliberty.io/zh-Hans/guides/microprofile-opentracing" />
  <meta property='og:type' content="website" />
  
  <meta name="google-site-verification" content="h2P030H9b66CyL1nEmWfrZB8Fr14h9LmVMG7Ur0caBs" />

  
      <meta name="robots" content="noindex" />
  

  <script async defer src="https://buttons.github.io/buttons.js"></script>
</head>


  <body>
    
    

    


<!--  -->

<header>
    <nav id="nav_bar">
        <div id="nav_header">
            <a id="home_link" href="/" aria-label="Open Liberty Home">
                <img id="ol_logo" src="/img/docs_openliberty_logo.png" alt="Open Liberty Logo">
            </a>
            <button id="hamburger_toggle_button" onclick="$('#nav_bar').toggleClass('responsive');">
                <span id="hamburger_toggle_icon"></span>
            </button>
        </div>
        <div id="hamburger_menu">
            <ul class="nav_list">
                <li class="nav_link">
                    <a href="/start/">入门</a>
                </li>
                <li class="nav_link">
                    <a href="/guides/">指南</a>
                </li>
                <li class="nav_link">
                    <a href="/docs/">文档</a>
                </li>
                <li class="nav_link">
                    <a href="/support/">支持</a>
                </li>
                <li class="nav_link">
                    <a href="/blog/">博客</a>
                </li>
            </ul>
            <div id="header_round_links_container"> 
                <a id="header_twitter_link" class="header_round_button" href="https://twitter.com/OpenLibertyIO" target="_blank" rel="noopener noreferrer" aria-label="Twitter"></a>
                <a id="header_stackoverflow_link" class="header_round_button" href="https://stackoverflow.com/questions/tagged/open-liberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty questions on Stack Overflow"></a>
                <a id="header_groupsio_link" class="header_round_button" href="https://groups.io/g/openliberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Groups.io"></a>
                <a id="header_gitter_link" class="header_round_button" href="https://app.gitter.im/#/room/#OpenLiberty_development:gitter.im" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Gitter"></a>
            </div>
        </div>

    </nav>
</header>


    <main aria-label="Content">

      <!-- Build a list of all the documents in the guides code base -->
  
 

<!-- Remove any documents deemed private (archived, templates, etc) -->


<!-- Count number of guides from past 30 days-->
<!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
 

<!-- Sort list of guides by date with most recent first -->


<div id="background_container">
  <div id="toc_hotspot"></div>
  <!-- Guide's table of contents section -->
  <div id="toc_column" class="collapse inline open">
    <div id="toc_inner">
       
      <div id="close_container">
        <img id="toc_close_white" src="/img/toc_close_white.svg" alt="Close the table of contents" tabindex="0">
      </div>
      <h3 id="toc_title">Contents</h3>
      <div id="toc_container"><ul class="sectlevel1">
<li><a href="#what-youll-learn">What you’ll learn</a></li>
<li>
<a href="#getting-started">Getting started</a>
<ul class="sectlevel2">
<li><a href="#try-what-youll-build">Try what you’ll build</a></li>
</ul>
</li>
<li><a href="#running-the-services">Running the services</a></li>
<li><a href="#existing-tracer-implementation">Existing Tracer implementation</a></li>
<li>
<a href="#enabling-distributed-tracing">Enabling distributed tracing</a>
<ul class="sectlevel2">
<li><a href="#enabling-distributed-tracing-without-code-instrumentation">Enabling distributed tracing without code instrumentation</a></li>
<li><a href="#enabling-explicit-distributed-tracing">Enabling explicit distributed tracing</a></li>
<li><a href="#injecting-a-custom-tracer-object">Injecting a custom Tracer object</a></li>
</ul>
</li>
<li><a href="#testing-the-services">Testing the services</a></li>
<li><a href="#great-work-youre-done">Great work! You’re done!</a></li>
<li><a href="#guide-attribution">Guide Attribution</a></li>
</ul></div>
      <div id="toc_separator"></div>
      
      <h3 id="tag_title">标签</h3>
      <div id="tags_container"></div>
    </div>
  </div>
  <div id="toc_indicator" tabindex="0" aria-label="Open the table of contents" class="hidden">
    <img src="/img/arrow_white.svg" alt="arrow">
  </div>
  <div id="toc_line" class="open"></div>
  <!-- Entire guide section -->
  <div id="guide_column" class="position_relative open">
    <div id="guide_content">
      <!-- Guide header section -->
      <div id="guide_meta" class="sect1" tabindex="0">
        <h1 id="guide_title">Enabling distributed tracing in microservices with Zipkin</h1>
        <div id="duration_container">
          <img src="/img/guide_duration_clock_icon_large.svg" alt="duration">
          <span id="guide_duration">20 minutes</span>

          <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
          <!-- If new posts count is less than 4, use 4 most recent posts -->
           
          <!-- If new posts count is >= 4, use posts from last 30 days-->
          
          <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
          <!-- Count number of guides from past last 12 weeks that is 84 days-->
          <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
          
        </div>
        <div id="mobile_prereqs_section">
          <p id="mobile_prereqs_title">Prerequisites:</p>
          <div class="prereqs_list"></div>
          <div class="skills_network_container">
            <div class="skills_network_description"></div>
          </div>
        </div>
      </div>

      <div class="scroller_anchor"></div>
      <div id="mobile_toc_accordion_container" data-toggle="collapse" data-target="#toc_column" aria-expanded="false" aria-controls="toc_column" role="button">
        <div role="menuitem" id="mobile_toc_accordion">
          <button class="breadcrumb_hamburger toc-toggle collapsed" type="button" tabindex="0">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <img src="/img/toc_close_green.svg" class="TOC_Close_SVG hidden img-responsive" alt="Table of contents close button">
          </button>
          <span>Table of contents</span>
        </div>
      </div>

      <!-- Guide content section -->
      <div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note hidden">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This repository contains the guide documentation source. To view the guide in published form, view it on the <a href="https://openliberty.io/guides/microprofile-opentracing.html">Open Liberty website</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Explore how to enable and customize tracing of JAX-RS and non-JAX-RS methods by using MicroProfile OpenTracing and the Zipkin tracing system.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-youll-learn">What you’ll learn</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You’ll learn how to enable automatic tracing for JAX-RS methods and how to create custom tracers for non-JAX-RS methods by using MicroProfile OpenTracing.</p>
</div>
<div class="paragraph">
<p>OpenTracing is a standard API for instrumenting microservices for distributed tracing. Distributed tracing helps troubleshoot microservices by examining and logging requests as they propagate through a distributed system. Distributed tracing allows developers to tackle the otherwise difficult task of debugging these requests. Without a distributed tracing system in place, analyzing the workflows of operations becomes difficult. Pinpointing when and where a request is received and when responses are sent becomes difficult.</p>
</div>
<div class="paragraph">
<p>MicroProfile OpenTracing enables distributed tracing in microservices without adding any explicit distributed tracing code to the application. Note that the MicroProfile OpenTracing specification does not address the problem of defining, implementing, or configuring the underlying distributed tracing system. Rather, the specification makes it easier to instrument services with distributed tracing given an existing distributed tracing system.</p>
</div>
<div class="paragraph">
<p>You’ll configure the provided <code>inventory</code> and <code>system</code> services to use distributed tracing with MicroProfile OpenTracing. You’ll run these services in two separate JVMs made of two server instances to demonstrate tracing in a distributed environment. If all the components were to run on a single server, then any logging software would do the trick.</p>
</div>
</div>
</div>
<div class="sect1 command">
<h2 id="getting-started">Getting started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The fastest way to work through this guide is to clone the <a href="https://github.com/openliberty/guide-microprofile-opentracing.git" target="_blank" rel="noopener noreferrer">Git repository</a> and use the projects that are provided inside:</p>
</div>
<div id="git_clone" class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>git clone https://github.com/openliberty/guide-microprofile-opentracing.git
cd guide-microprofile-opentracing</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>start</code> directory contains the starting project that you will build upon.</p>
</div>
<div class="paragraph">
<p>The <code>finish</code> directory contains the finished project that you will build.</p>
</div>
<div class="paragraph">
<p>Before you begin, make sure you have all the necessary <span class="prerequisites">prerequisites</span>.</p>
</div>
<div class="paragraph">
<p>For this guide, Zipkin is used as the distributed tracing system. You can find the installation instructions for Zipkin at the Zipkin <a href="https://zipkin.io/pages/quickstart.html" target="_blank" rel="noopener noreferrer">quickstart page</a>. You’re not required to use Zipkin. You may choose to use another tracing system. However, this guide is written using Zipkin. If you use a different tracing system, the required instructions may differ.</p>
</div>
<div class="paragraph">
<p>Before you continue, confirm your Zipkin server is up and running. By default, Zipkin can be found at the <a href="http://localhost:9411" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9411</a> URL.</p>
</div>
<div class="sect2">
<h3 id="try-what-youll-build">Try what you’ll build</h3>
<div class="paragraph">
<p>The <code>finish</code> directory in the root directory of this guide contains two services that are configured to use MicroProfile OpenTracing. Give them a try before you continue.</p>
</div>
<div class="paragraph">
<p>To try out the services, navigate to the <code>finish</code> directory and run the Maven <code>install</code> phase to build the services</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>cd finish
mvn install</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, run the Maven <code>liberty:start-server</code> goal to start them in two Open Liberty servers:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn liberty:start-server</code></pre>
</div>
</div>
<div class="paragraph">
<p>Make sure your Zipkin server is running and point your browser to the <a href="http://localhost:9081/inventory/systems/localhost" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9081/inventory/systems/localhost</a> URL. When you visit this URL, you make two HTTP GET requests, one to the <code>system</code> service and one to the <code>inventory</code> service. Both of these requests are configured to be traced, so a new trace will be recorded in Zipkin. Visit the <a href="http://localhost:9411" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9411</a> URL or another location where you configured Zipkin to run. Run an empty query and sort the traces by latest start time first.</p>
</div>
<div class="paragraph">
<p>Verify that the new trace contains three spans with the following names:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>get:io.openliberty.guides.inventory.inventoryresource.getpropertiesforhost</code></p>
</li>
<li>
<p><code>get:io.openliberty.guides.system.systemresource.getproperties</code></p>
</li>
<li>
<p><code>add() span</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can inspect each span by clicking it to reveal more detailed information, such as the time at which the request was received and the time at which a response was sent back.</p>
</div>
<div class="paragraph">
<p>If you examine the other traces, you might notice a red trace entry, which indicates the span caught an error. In this case, one of the tests accesses the <code>/inventory/systems/badhostname</code> endpoint, which is invalid, so an error is thrown. This behavior is expected.</p>
</div>
<div class="paragraph">
<p>When you’re done checking out the services, stop both Open Liberty servers using the Maven <code>liberty:stop-server</code> goal:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn liberty:stop-server</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-the-services">Running the services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Navigate to the <code>start</code> directory to begin.</p>
</div>
<div class="paragraph">
<p>You’ll need to start the services to see basic traces appear in Zipkin. So, before you proceed, build and start the provided <code>system</code> and <code>inventory</code> services in the starting project by running the Maven <code>install</code> goal:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn install</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, run the <code>liberty:start-server</code> goal:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn liberty:start-server</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the servers start, you can find the <code>system</code> and <code>inventory</code> services at the following URLs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:9080/system/properties" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9080/system/properties</a></p>
</li>
<li>
<p><a href="http://localhost:9081/inventory/systems" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9081/inventory/systems</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="existing-tracer-implementation">Existing Tracer implementation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To collect traces across your systems, you need to implement the OpenTracing <code>Tracer</code> interface. For this guide, you can access a bare-bones <code>Tracer</code> implementation for the Zipkin server in the form of a user feature for Open Liberty.</p>
</div>
<div class="paragraph">
<p>This feature is already configured for you in your <code class="hotspot file=1">pom.xml</code> and <code class="hotspot file=0">server.xml</code> files. It’s automatically downloaded and installed into each service when you run a Maven build. You can find the <code class="hotspot=zipkinUsr file=0">opentracingZipkin</code> feature enabled in your <code class="hotspot file=0">server.xml</code> file.</p>
</div>
<div class="paragraph">
<p>The <code class="hotspot=download file=1">download-maven-plugin</code> Maven plug-in in your <code>pom.xml</code> downloads and installs the <code class="hotspot=zipkinUsr file=0">opentracingZipkin</code> feature.</p>
</div>
<div class="paragraph">
<p>If you want to install this feature yourself, see <a href="https://www.ibm.com/docs/en/was-liberty/base?topic=environment-enabling-distributed-tracing" target="_blank" rel="noopener noreferrer">Enabling distributed tracing</a> in IBM Documentation.</p>
</div>
<div class="paragraph">
<p>server.xml</p>
</div>
<div class="listingblock code_column">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="line-numbers"> 1</span><span class="tag">&lt;server</span> <span class="attribute-name">description</span>=<span class="string"><span class="delimiter">"</span><span class="content">Sample Liberty server</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers"> 2</span>
<span class="line-numbers"> 3</span>  <span class="tag">&lt;featureManager&gt;</span>
<span class="line-numbers"> 4</span>    <span class="tag">&lt;feature&gt;</span>jaxrs-2.1<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 5</span>    <span class="tag">&lt;feature&gt;</span>jsonp-1.1<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 6</span>    <span class="tag">&lt;feature&gt;</span>cdi-2.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 7</span>    <span class="comment">&lt;!-- tag::mpOpenTracing[] --&gt;</span>
<span class="line-numbers"> 8</span>    <span class="tag">&lt;feature&gt;</span>mpOpenTracing-2.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 9</span>    <span class="comment">&lt;!-- end::mpOpenTracing[] --&gt;</span>
<span class="line-numbers">10</span>    <span class="comment">&lt;!-- tag::zipkinUsr[] --&gt;</span>
<span class="line-numbers">11</span>    <span class="tag">&lt;feature&gt;</span>usr:opentracingZipkin-0.33<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers">12</span>    <span class="comment">&lt;!-- end::zipkinUsr[] --&gt;</span>
<span class="line-numbers">13</span>  <span class="tag">&lt;/featureManager&gt;</span>
<span class="line-numbers">14</span>
<span class="line-numbers">15</span>  <span class="tag">&lt;opentracingZipkin</span> <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">"</span><span class="content">localhost</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">16</span>
<span class="line-numbers">17</span>  <span class="tag">&lt;httpEndpoint</span> <span class="attribute-name">httpPort</span>=<span class="string"><span class="delimiter">"</span><span class="content">${default.http.port}</span><span class="delimiter">"</span></span> <span class="attribute-name">httpsPort</span>=<span class="string"><span class="delimiter">"</span><span class="content">${default.https.port}</span><span class="delimiter">"</span></span>
<span class="line-numbers">18</span>      <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">defaultHttpEndpoint</span><span class="delimiter">"</span></span> <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">"</span><span class="content">*</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>
<span class="line-numbers">19</span>      
<span class="line-numbers">20</span>  <span class="tag">&lt;webApplication</span> <span class="attribute-name">location</span>=<span class="string"><span class="delimiter">"</span><span class="content">inventory-service.war</span><span class="delimiter">"</span></span> <span class="attribute-name">contextRoot</span>=<span class="string"><span class="delimiter">"</span><span class="content">/</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers">21</span>    <span class="comment">&lt;!-- enable visibility to third party apis --&gt;</span>
<span class="line-numbers">22</span>    <span class="tag">&lt;classloader</span> <span class="attribute-name">apiTypeVisibility</span>=<span class="string"><span class="delimiter">"</span><span class="content">api,ibm-api,spec,stable,third-party</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">23</span>  <span class="tag">&lt;/webApplication&gt;</span>
<span class="line-numbers">24</span>
<span class="line-numbers">25</span><span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>pom.xml</p>
</div>
<div class="listingblock code_column">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="line-numbers">  1</span><span class="preprocessor">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span>
<span class="line-numbers">  2</span><span class="tag">&lt;project</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://maven.apache.org/POM/4.0.0</span><span class="delimiter">"</span></span> 
<span class="line-numbers">  3</span><span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span> 
<span class="line-numbers">  4</span><span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://maven.apache.org/POM/4.0.0 </span></span>
<span class="line-numbers">  5</span><span class="string"><span class="content">http://maven.apache.org/xsd/maven-4.0.0.xsd</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers">  6</span>    <span class="tag">&lt;modelVersion&gt;</span>4.0.0<span class="tag">&lt;/modelVersion&gt;</span>
<span class="line-numbers">  7</span>
<span class="line-numbers">  8</span>    <span class="tag">&lt;parent&gt;</span>
<span class="line-numbers">  9</span>        <span class="tag">&lt;groupId&gt;</span>io.openliberty.guides<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 10</span>        <span class="tag">&lt;artifactId&gt;</span>guide-microprofile-opentracing<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 11</span>        <span class="tag">&lt;version&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 12</span>    <span class="tag">&lt;/parent&gt;</span>
<span class="line-numbers"> 13</span>
<span class="line-numbers"> 14</span>    <span class="tag">&lt;artifactId&gt;</span>inventory-service<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 15</span>    <span class="tag">&lt;packaging&gt;</span>war<span class="tag">&lt;/packaging&gt;</span>
<span class="line-numbers"> 16</span>
<span class="line-numbers"> 17</span>    <span class="tag">&lt;properties&gt;</span>
<span class="line-numbers"> 18</span>        <span class="comment">&lt;!-- Plugins --&gt;</span>
<span class="line-numbers"> 19</span>        <span class="tag">&lt;version.exec-maven-plugin&gt;</span>1.6.0<span class="tag">&lt;/version.exec-maven-plugin&gt;</span>
<span class="line-numbers"> 20</span>    <span class="tag">&lt;/properties&gt;</span>
<span class="line-numbers"> 21</span>
<span class="line-numbers"> 22</span>    <span class="tag">&lt;dependencies&gt;</span>
<span class="line-numbers"> 23</span>        <span class="comment">&lt;!-- Open Liberty features --&gt;</span>
<span class="line-numbers"> 24</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 25</span>            <span class="tag">&lt;groupId&gt;</span>io.openliberty.features<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 26</span>            <span class="tag">&lt;artifactId&gt;</span>jaxrs-2.1<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 27</span>            <span class="tag">&lt;type&gt;</span>esa<span class="tag">&lt;/type&gt;</span>
<span class="line-numbers"> 28</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 29</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 30</span>            <span class="tag">&lt;groupId&gt;</span>io.openliberty.features<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 31</span>            <span class="tag">&lt;artifactId&gt;</span>jsonp-1.1<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 32</span>            <span class="tag">&lt;type&gt;</span>esa<span class="tag">&lt;/type&gt;</span>
<span class="line-numbers"> 33</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 34</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 35</span>            <span class="tag">&lt;groupId&gt;</span>io.openliberty.features<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 36</span>            <span class="tag">&lt;artifactId&gt;</span>cdi-2.0<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 37</span>            <span class="tag">&lt;type&gt;</span>esa<span class="tag">&lt;/type&gt;</span>
<span class="line-numbers"> 38</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 39</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 40</span>            <span class="tag">&lt;groupId&gt;</span>io.openliberty.features<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 41</span>            <span class="tag">&lt;artifactId&gt;</span>mpOpenTracing-2.0<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 42</span>            <span class="tag">&lt;type&gt;</span>esa<span class="tag">&lt;/type&gt;</span>
<span class="line-numbers"> 43</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 44</span>        <span class="comment">&lt;!-- For tests --&gt;</span>
<span class="line-numbers"> 45</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 46</span>            <span class="tag">&lt;groupId&gt;</span>junit<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 47</span>            <span class="tag">&lt;artifactId&gt;</span>junit<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 48</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 49</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 50</span>            <span class="tag">&lt;groupId&gt;</span>org.apache.cxf<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 51</span>            <span class="tag">&lt;artifactId&gt;</span>cxf-rt-rs-client<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 52</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 53</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 54</span>            <span class="tag">&lt;groupId&gt;</span>org.apache.cxf<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 55</span>            <span class="tag">&lt;artifactId&gt;</span>cxf-rt-rs-extension-providers<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 56</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 57</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 58</span>            <span class="tag">&lt;groupId&gt;</span>org.glassfish<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 59</span>            <span class="tag">&lt;artifactId&gt;</span>javax.json<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 60</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 61</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 62</span>            <span class="tag">&lt;groupId&gt;</span>org.apache.commons<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 63</span>            <span class="tag">&lt;artifactId&gt;</span>commons-lang3<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 64</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 65</span>    <span class="tag">&lt;/dependencies&gt;</span>
<span class="line-numbers"> 66</span>
<span class="line-numbers"> 67</span>    <span class="tag">&lt;profiles&gt;</span>
<span class="line-numbers"> 68</span>        <span class="comment">&lt;!-- Start system service before running tests --&gt;</span>
<span class="line-numbers"> 69</span>        <span class="tag">&lt;profile&gt;</span>
<span class="line-numbers"> 70</span>            <span class="tag">&lt;id&gt;</span>setup-test<span class="tag">&lt;/id&gt;</span>
<span class="line-numbers"> 71</span>            <span class="tag">&lt;activation&gt;</span>
<span class="line-numbers"> 72</span>                <span class="tag">&lt;activeByDefault&gt;</span>true<span class="tag">&lt;/activeByDefault&gt;</span>
<span class="line-numbers"> 73</span>            <span class="tag">&lt;/activation&gt;</span>
<span class="line-numbers"> 74</span>            <span class="tag">&lt;build&gt;</span>
<span class="line-numbers"> 75</span>                <span class="tag">&lt;plugins&gt;</span>
<span class="line-numbers"> 76</span>                    <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers"> 77</span>                        <span class="tag">&lt;groupId&gt;</span>org.codehaus.mojo<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 78</span>                        <span class="tag">&lt;artifactId&gt;</span>exec-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 79</span>                        <span class="tag">&lt;version&gt;</span>${version.exec-maven-plugin}<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 80</span>                        <span class="tag">&lt;executions&gt;</span>
<span class="line-numbers"> 81</span>                            <span class="tag">&lt;execution&gt;</span>
<span class="line-numbers"> 82</span>                                <span class="tag">&lt;id&gt;</span>test-start-system-service<span class="tag">&lt;/id&gt;</span>
<span class="line-numbers"> 83</span>                                <span class="tag">&lt;goals&gt;</span>
<span class="line-numbers"> 84</span>                                    <span class="tag">&lt;goal&gt;</span>exec<span class="tag">&lt;/goal&gt;</span>
<span class="line-numbers"> 85</span>                                <span class="tag">&lt;/goals&gt;</span>
<span class="line-numbers"> 86</span>                                <span class="tag">&lt;phase&gt;</span>pre-integration-test<span class="tag">&lt;/phase&gt;</span>
<span class="line-numbers"> 87</span>                                <span class="tag">&lt;configuration&gt;</span>
<span class="line-numbers"> 88</span>                                    <span class="tag">&lt;workingDirectory&gt;</span>../system<span class="tag">&lt;/workingDirectory&gt;</span>
<span class="line-numbers"> 89</span>                                    <span class="tag">&lt;executable&gt;</span>mvn${mvn.extension}<span class="tag">&lt;/executable&gt;</span>
<span class="line-numbers"> 90</span>                                    <span class="tag">&lt;arguments&gt;</span>
<span class="line-numbers"> 91</span>                                        <span class="tag">&lt;argument&gt;</span>liberty:start-server<span class="tag">&lt;/argument&gt;</span>
<span class="line-numbers"> 92</span>                                    <span class="tag">&lt;/arguments&gt;</span>
<span class="line-numbers"> 93</span>                                <span class="tag">&lt;/configuration&gt;</span>
<span class="line-numbers"> 94</span>                            <span class="tag">&lt;/execution&gt;</span>
<span class="line-numbers"> 95</span>                        <span class="tag">&lt;/executions&gt;</span>
<span class="line-numbers"> 96</span>                    <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers"> 97</span>                <span class="tag">&lt;/plugins&gt;</span>
<span class="line-numbers"> 98</span>            <span class="tag">&lt;/build&gt;</span>
<span class="line-numbers"> 99</span>        <span class="tag">&lt;/profile&gt;</span>
<span class="line-numbers">100</span>        <span class="comment">&lt;!-- Stop system service after running tests --&gt;</span>
<span class="line-numbers">101</span>        <span class="tag">&lt;profile&gt;</span>
<span class="line-numbers">102</span>            <span class="tag">&lt;id&gt;</span>teardown-test<span class="tag">&lt;/id&gt;</span>
<span class="line-numbers">103</span>            <span class="tag">&lt;activation&gt;</span>
<span class="line-numbers">104</span>                <span class="tag">&lt;activeByDefault&gt;</span>false<span class="tag">&lt;/activeByDefault&gt;</span>
<span class="line-numbers">105</span>            <span class="tag">&lt;/activation&gt;</span>
<span class="line-numbers">106</span>            <span class="tag">&lt;build&gt;</span>
<span class="line-numbers">107</span>                <span class="tag">&lt;plugins&gt;</span>
<span class="line-numbers">108</span>                    <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers">109</span>                        <span class="tag">&lt;groupId&gt;</span>org.codehaus.mojo<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">110</span>                        <span class="tag">&lt;artifactId&gt;</span>exec-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">111</span>                        <span class="tag">&lt;version&gt;</span>${version.exec-maven-plugin}<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers">112</span>                        <span class="tag">&lt;executions&gt;</span>
<span class="line-numbers">113</span>                            <span class="tag">&lt;execution&gt;</span>
<span class="line-numbers">114</span>                                <span class="tag">&lt;id&gt;</span>test-stop-system-service<span class="tag">&lt;/id&gt;</span>
<span class="line-numbers">115</span>                                <span class="tag">&lt;goals&gt;</span>
<span class="line-numbers">116</span>                                    <span class="tag">&lt;goal&gt;</span>exec<span class="tag">&lt;/goal&gt;</span>
<span class="line-numbers">117</span>                                <span class="tag">&lt;/goals&gt;</span>
<span class="line-numbers">118</span>                                <span class="tag">&lt;phase&gt;</span>post-integration-test<span class="tag">&lt;/phase&gt;</span>
<span class="line-numbers">119</span>                                <span class="tag">&lt;configuration&gt;</span>
<span class="line-numbers">120</span>                                    <span class="tag">&lt;workingDirectory&gt;</span>../system<span class="tag">&lt;/workingDirectory&gt;</span>
<span class="line-numbers">121</span>                                    <span class="tag">&lt;executable&gt;</span>mvn${mvn.extension}<span class="tag">&lt;/executable&gt;</span>
<span class="line-numbers">122</span>                                    <span class="tag">&lt;arguments&gt;</span>
<span class="line-numbers">123</span>                                        <span class="tag">&lt;argument&gt;</span>liberty:stop-server<span class="tag">&lt;/argument&gt;</span>
<span class="line-numbers">124</span>                                    <span class="tag">&lt;/arguments&gt;</span>
<span class="line-numbers">125</span>                                <span class="tag">&lt;/configuration&gt;</span>
<span class="line-numbers">126</span>                            <span class="tag">&lt;/execution&gt;</span>
<span class="line-numbers">127</span>                        <span class="tag">&lt;/executions&gt;</span>
<span class="line-numbers">128</span>                    <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers">129</span>                <span class="tag">&lt;/plugins&gt;</span>
<span class="line-numbers">130</span>            <span class="tag">&lt;/build&gt;</span>
<span class="line-numbers">131</span>        <span class="tag">&lt;/profile&gt;</span>
<span class="line-numbers">132</span>    <span class="tag">&lt;/profiles&gt;</span>
<span class="line-numbers">133</span>
<span class="line-numbers">134</span>    <span class="tag">&lt;build&gt;</span>
<span class="line-numbers">135</span>        <span class="tag">&lt;plugins&gt;</span>
<span class="line-numbers">136</span>            <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers">137</span>                <span class="tag">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">138</span>                <span class="tag">&lt;artifactId&gt;</span>maven-war-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">139</span>            <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers">140</span>
<span class="line-numbers">141</span>            <span class="comment">&lt;!-- Liberty plugin --&gt;</span>
<span class="line-numbers">142</span>            <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers">143</span>                <span class="tag">&lt;groupId&gt;</span>net.wasdev.wlp.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">144</span>                <span class="tag">&lt;artifactId&gt;</span>liberty-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">145</span>                <span class="tag">&lt;configuration&gt;</span>
<span class="line-numbers">146</span>                    <span class="tag">&lt;configFile&gt;</span>src/main/liberty/config/server.xml<span class="tag">&lt;/configFile&gt;</span>
<span class="line-numbers">147</span>                    <span class="tag">&lt;include&gt;</span>usr<span class="tag">&lt;/include&gt;</span>
<span class="line-numbers">148</span>                    <span class="tag">&lt;bootstrapProperties&gt;</span>
<span class="line-numbers">149</span>                        <span class="tag">&lt;default.http.port&gt;</span>${inv.service.http.port}<span class="tag">&lt;/default.http.port&gt;</span>
<span class="line-numbers">150</span>                        <span class="tag">&lt;default.https.port&gt;</span>${inv.service.https.port}<span class="tag">&lt;/default.https.port&gt;</span>
<span class="line-numbers">151</span>                        <span class="tag">&lt;system.http.port&gt;</span>${sys.service.http.port}<span class="tag">&lt;/system.http.port&gt;</span>
<span class="line-numbers">152</span>                    <span class="tag">&lt;/bootstrapProperties&gt;</span>
<span class="line-numbers">153</span>                <span class="tag">&lt;/configuration&gt;</span>
<span class="line-numbers">154</span>                <span class="tag">&lt;executions&gt;</span>
<span class="line-numbers">155</span>                    <span class="tag">&lt;execution&gt;</span>
<span class="line-numbers">156</span>                        <span class="tag">&lt;id&gt;</span>install-apps<span class="tag">&lt;/id&gt;</span>
<span class="line-numbers">157</span>                        <span class="tag">&lt;configuration&gt;</span>
<span class="line-numbers">158</span>                            <span class="tag">&lt;appsDirectory&gt;</span>apps<span class="tag">&lt;/appsDirectory&gt;</span>
<span class="line-numbers">159</span>                            <span class="tag">&lt;stripVersion&gt;</span>true<span class="tag">&lt;/stripVersion&gt;</span>
<span class="line-numbers">160</span>                            <span class="tag">&lt;installAppPackages&gt;</span>project<span class="tag">&lt;/installAppPackages&gt;</span>
<span class="line-numbers">161</span>                            <span class="tag">&lt;looseApplication&gt;</span>true<span class="tag">&lt;/looseApplication&gt;</span>
<span class="line-numbers">162</span>                        <span class="tag">&lt;/configuration&gt;</span>
<span class="line-numbers">163</span>                    <span class="tag">&lt;/execution&gt;</span>
<span class="line-numbers">164</span>                    <span class="tag">&lt;execution&gt;</span>
<span class="line-numbers">165</span>                        <span class="tag">&lt;id&gt;</span>install-feature<span class="tag">&lt;/id&gt;</span>
<span class="line-numbers">166</span>                        <span class="tag">&lt;configuration&gt;</span>
<span class="line-numbers">167</span>                            <span class="tag">&lt;skip&gt;</span>true<span class="tag">&lt;/skip&gt;</span>
<span class="line-numbers">168</span>                        <span class="tag">&lt;/configuration&gt;</span>
<span class="line-numbers">169</span>                    <span class="tag">&lt;/execution&gt;</span>
<span class="line-numbers">170</span>                <span class="tag">&lt;/executions&gt;</span>
<span class="line-numbers">171</span>            <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers">172</span>
<span class="line-numbers">173</span>            <span class="comment">&lt;!-- For downloading files --&gt;</span>
<span class="line-numbers">174</span>            <span class="comment">&lt;!-- tag::download[] --&gt;</span>
<span class="line-numbers">175</span>            <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers">176</span>                <span class="tag">&lt;groupId&gt;</span>com.googlecode.maven-download-plugin<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">177</span>                <span class="tag">&lt;artifactId&gt;</span>download-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">178</span>                <span class="tag">&lt;version&gt;</span>${version.download-maven-plugin}<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers">179</span>                <span class="tag">&lt;executions&gt;</span>
<span class="line-numbers">180</span>                    <span class="tag">&lt;execution&gt;</span>
<span class="line-numbers">181</span>                        <span class="tag">&lt;id&gt;</span>install-tracer<span class="tag">&lt;/id&gt;</span>
<span class="line-numbers">182</span>                        <span class="tag">&lt;phase&gt;</span>prepare-package<span class="tag">&lt;/phase&gt;</span>
<span class="line-numbers">183</span>                        <span class="tag">&lt;goals&gt;</span>
<span class="line-numbers">184</span>                            <span class="tag">&lt;goal&gt;</span>wget<span class="tag">&lt;/goal&gt;</span>
<span class="line-numbers">185</span>                        <span class="tag">&lt;/goals&gt;</span>
<span class="line-numbers">186</span>                        <span class="tag">&lt;configuration&gt;</span>
<span class="line-numbers">187</span>                            <span class="tag">&lt;url&gt;</span>${zipkin.usr.feature}<span class="tag">&lt;/url&gt;</span>
<span class="line-numbers">188</span>                            <span class="tag">&lt;unpack&gt;</span>true<span class="tag">&lt;/unpack&gt;</span>
<span class="line-numbers">189</span>                            <span class="tag">&lt;outputDirectory&gt;</span>
<span class="line-numbers">190</span>                                ${project.build.directory}/liberty/wlp/usr
<span class="line-numbers">191</span>                            <span class="tag">&lt;/outputDirectory&gt;</span>
<span class="line-numbers">192</span>                        <span class="tag">&lt;/configuration&gt;</span>
<span class="line-numbers">193</span>                    <span class="tag">&lt;/execution&gt;</span>
<span class="line-numbers">194</span>                <span class="tag">&lt;/executions&gt;</span>
<span class="line-numbers">195</span>            <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers">196</span>            <span class="comment">&lt;!-- end::download[] --&gt;</span>
<span class="line-numbers">197</span>
<span class="line-numbers">198</span>            <span class="comment">&lt;!-- Plugin to run unit tests --&gt;</span>
<span class="line-numbers">199</span>            <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers">200</span>                <span class="tag">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">201</span>                <span class="tag">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">202</span>            <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers">203</span>
<span class="line-numbers">204</span>            <span class="comment">&lt;!-- Plugin to run functional tests --&gt;</span>
<span class="line-numbers">205</span>            <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers">206</span>                <span class="tag">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">207</span>                <span class="tag">&lt;artifactId&gt;</span>maven-failsafe-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">208</span>            <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers">209</span>        <span class="tag">&lt;/plugins&gt;</span>
<span class="line-numbers">210</span>    <span class="tag">&lt;/build&gt;</span>
<span class="line-numbers">211</span><span class="tag">&lt;/project&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="enabling-distributed-tracing">Enabling distributed tracing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The MicroProfile OpenTracing feature enables tracing of all JAX-RS methods by default. To further control and customize these traces, use the <code>@Traced</code> annotation to enable and disable tracing of particular methods. You can also inject a custom <code>Tracer</code> object to create and customize spans.</p>
</div>
<div class="sect2">
<h3 id="enabling-distributed-tracing-without-code-instrumentation">Enabling distributed tracing without code instrumentation</h3>
<div class="paragraph">
<p>Because tracing is enabled by default for all JAX-RS methods, you need to enable only the <code class="hotspot=mpOpenTracing file=0">mpOpenTracing</code> feature and the <code class="hotspot=zipkinUsr file=0">usr:opentracingZipkin</code> user feature in the <code>server.xml</code> file to see some basic traces in Zipkin.</p>
</div>
<div class="paragraph">
<p>Both of these features are already enabled in the <code>inventory</code> and <code>system</code> configuration files.</p>
</div>
<div class="paragraph">
<p>Make sure your services are running. Then, point your browser to any of their endpoints and check your Zipkin server for traces.</p>
</div>
<div class="paragraph">
<p>server.xml</p>
</div>
<div class="listingblock code_column">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="line-numbers"> 1</span><span class="tag">&lt;server</span> <span class="attribute-name">description</span>=<span class="string"><span class="delimiter">"</span><span class="content">Sample Liberty server</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers"> 2</span>
<span class="line-numbers"> 3</span>  <span class="tag">&lt;featureManager&gt;</span>
<span class="line-numbers"> 4</span>    <span class="tag">&lt;feature&gt;</span>jaxrs-2.1<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 5</span>    <span class="tag">&lt;feature&gt;</span>jsonp-1.1<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 6</span>    <span class="tag">&lt;feature&gt;</span>cdi-2.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 7</span>    <span class="comment">&lt;!-- tag::mpOpenTracing[] --&gt;</span>
<span class="line-numbers"> 8</span>    <span class="tag">&lt;feature&gt;</span>mpOpenTracing-2.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 9</span>    <span class="comment">&lt;!-- end::mpOpenTracing[] --&gt;</span>
<span class="line-numbers">10</span>    <span class="comment">&lt;!-- tag::zipkinUsr[] --&gt;</span>
<span class="line-numbers">11</span>    <span class="tag">&lt;feature&gt;</span>usr:opentracingZipkin-0.33<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers">12</span>    <span class="comment">&lt;!-- end::zipkinUsr[] --&gt;</span>
<span class="line-numbers">13</span>  <span class="tag">&lt;/featureManager&gt;</span>
<span class="line-numbers">14</span>
<span class="line-numbers">15</span>  <span class="tag">&lt;opentracingZipkin</span> <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">"</span><span class="content">localhost</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">16</span>
<span class="line-numbers">17</span>  <span class="tag">&lt;httpEndpoint</span> <span class="attribute-name">httpPort</span>=<span class="string"><span class="delimiter">"</span><span class="content">${default.http.port}</span><span class="delimiter">"</span></span> <span class="attribute-name">httpsPort</span>=<span class="string"><span class="delimiter">"</span><span class="content">${default.https.port}</span><span class="delimiter">"</span></span>
<span class="line-numbers">18</span>      <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">defaultHttpEndpoint</span><span class="delimiter">"</span></span> <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">"</span><span class="content">*</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>
<span class="line-numbers">19</span>      
<span class="line-numbers">20</span>  <span class="tag">&lt;webApplication</span> <span class="attribute-name">location</span>=<span class="string"><span class="delimiter">"</span><span class="content">inventory-service.war</span><span class="delimiter">"</span></span> <span class="attribute-name">contextRoot</span>=<span class="string"><span class="delimiter">"</span><span class="content">/</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers">21</span>    <span class="comment">&lt;!-- enable visibility to third party apis --&gt;</span>
<span class="line-numbers">22</span>    <span class="tag">&lt;classloader</span> <span class="attribute-name">apiTypeVisibility</span>=<span class="string"><span class="delimiter">"</span><span class="content">api,ibm-api,spec,stable,third-party</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">23</span>  <span class="tag">&lt;/webApplication&gt;</span>
<span class="line-numbers">24</span>
<span class="line-numbers">25</span><span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="enabling-explicit-distributed-tracing">Enabling explicit distributed tracing</h3>
<div class="paragraph">
<p>The <code class="hotspot=Traced file=0">@Traced</code> annotation defines explicit span creation for specific classes and methods. If you place the annotation on a class, then it’s automatically applied to all methods within that class. If you place the annotation on a method, then it overrides the class annotation if one exists.</p>
</div>
<div class="paragraph">
<p>Enable tracing of the <code class="hotspot=list file=0">list()</code> non-JAX-RS method by adding the <code class="hotspot=Traced file=0">@Traced</code> annotation to the method.</p>
</div>
<div class="listingblock code_command hotspot file=0">
<div class="content">
<pre><mark>Replace the <code>InventoryManager</code> class.</mark>
<code>inventory/src/main/java/io/openliberty/guides/inventory/InventoryManager.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>InventoryManager.java</p>
</div>
<div class="listingblock code_column hide_tags=copyright,customTracer,Add">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="Java"><span class="line-numbers"> 1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers"> 2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers"> 3</span><span class="comment"> * Copyright (c) 2017, 2021 IBM Corporation and others.</span>
<span class="line-numbers"> 4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers"> 5</span><span class="comment"> * are made available under the terms of the Eclipse Public License v1.0</span>
<span class="line-numbers"> 6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers"> 7</span><span class="comment"> * http://www.eclipse.org/legal/epl-v10.html</span>
<span class="line-numbers"> 8</span><span class="comment"> *</span>
<span class="line-numbers"> 9</span><span class="comment"> * Contributors:</span>
<span class="line-numbers">10</span><span class="comment"> *     IBM Corporation - Initial implementation</span>
<span class="line-numbers">11</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers">12</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers">13</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.inventory</span>;
<span class="line-numbers">14</span>
<span class="line-numbers">15</span><span class="keyword">import</span> <span class="include">java.util.ArrayList</span>;
<span class="line-numbers">16</span><span class="keyword">import</span> <span class="include">java.util.Collections</span>;
<span class="line-numbers">17</span><span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="line-numbers">18</span><span class="keyword">import</span> <span class="include">java.util.Properties</span>;
<span class="line-numbers">19</span><span class="keyword">import</span> <span class="include">javax.enterprise.context.ApplicationScoped</span>;
<span class="line-numbers">20</span><span class="keyword">import</span> <span class="include">javax.inject.Inject</span>;
<span class="line-numbers">21</span>
<span class="line-numbers">22</span><span class="keyword">import</span> <span class="include">io.openliberty.guides.inventory.client.SystemClient</span>;
<span class="line-numbers">23</span><span class="keyword">import</span> <span class="include">io.openliberty.guides.inventory.model.InventoryList</span>;
<span class="line-numbers">24</span><span class="keyword">import</span> <span class="include">io.openliberty.guides.inventory.model.SystemData</span>;
<span class="line-numbers">25</span><span class="keyword">import</span> <span class="include">io.opentracing.Scope</span>;
<span class="line-numbers">26</span><span class="keyword">import</span> <span class="include">io.opentracing.Span</span>;
<span class="line-numbers">27</span><span class="keyword">import</span> <span class="include">io.opentracing.Tracer</span>;
<span class="line-numbers">28</span>
<span class="line-numbers">29</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.opentracing.Traced</span>;
<span class="line-numbers">30</span>
<span class="line-numbers">31</span><span class="annotation">@ApplicationScoped</span>
<span class="line-numbers">32</span><span class="comment">// tag::InventoryManager[]</span>
<span class="line-numbers">33</span><span class="directive">public</span> <span class="type">class</span> <span class="class">InventoryManager</span> {
<span class="line-numbers">34</span>
<span class="line-numbers">35</span>    <span class="directive">private</span> <span class="predefined-type">List</span>&lt;SystemData&gt; systems = <span class="predefined-type">Collections</span>.synchronizedList(<span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;());
<span class="line-numbers">36</span>    <span class="directive">private</span> SystemClient systemClient = <span class="keyword">new</span> SystemClient();
<span class="line-numbers">37</span>    <span class="comment">// tag::customTracer[]</span>
<span class="line-numbers">38</span>    <span class="annotation">@Inject</span> Tracer tracer;
<span class="line-numbers">39</span>    <span class="comment">// end::customTracer[]</span>
<span class="line-numbers">40</span>
<span class="line-numbers">41</span>    <span class="directive">public</span> <span class="predefined-type">Properties</span> get(<span class="predefined-type">String</span> hostname) {
<span class="line-numbers">42</span>        systemClient.init(hostname, <span class="integer">9080</span>);
<span class="line-numbers">43</span>        <span class="predefined-type">Properties</span> properties = systemClient.getProperties();
<span class="line-numbers">44</span>        <span class="keyword">return</span> properties;
<span class="line-numbers">45</span>    }
<span class="line-numbers">46</span>
<span class="line-numbers">47</span>    <span class="directive">public</span> <span class="type">void</span> add(<span class="predefined-type">String</span> hostname, <span class="predefined-type">Properties</span> systemProps) {
<span class="line-numbers">48</span>        <span class="predefined-type">Properties</span> props = <span class="keyword">new</span> <span class="predefined-type">Properties</span>();
<span class="line-numbers">49</span>        props.setProperty(<span class="string"><span class="delimiter">"</span><span class="content">os.name</span><span class="delimiter">"</span></span>, systemProps.getProperty(<span class="string"><span class="delimiter">"</span><span class="content">os.name</span><span class="delimiter">"</span></span>));
<span class="line-numbers">50</span>        props.setProperty(<span class="string"><span class="delimiter">"</span><span class="content">user.name</span><span class="delimiter">"</span></span>, systemProps.getProperty(<span class="string"><span class="delimiter">"</span><span class="content">user.name</span><span class="delimiter">"</span></span>));
<span class="line-numbers">51</span>
<span class="line-numbers">52</span>        SystemData system = <span class="keyword">new</span> SystemData(hostname, props);
<span class="line-numbers">53</span>        <span class="comment">// tag::Add[]</span>
<span class="line-numbers">54</span>        <span class="keyword">if</span> (!systems.contains(system)) {
<span class="line-numbers">55</span>            <span class="comment">// tag::span[]</span>
<span class="line-numbers">56</span>            Span span = tracer.buildSpan(<span class="string"><span class="delimiter">"</span><span class="content">add() Span</span><span class="delimiter">"</span></span>).start();
<span class="line-numbers">57</span>            <span class="comment">// end::span[]</span>
<span class="line-numbers">58</span>            <span class="comment">// tag::Try[]</span>
<span class="line-numbers">59</span>            <span class="comment">// tag::scope[]</span>
<span class="line-numbers">60</span>            <span class="keyword">try</span> (Scope childScope = tracer.scopeManager()
<span class="line-numbers">61</span>                                          .activate(span)
<span class="line-numbers">62</span>                ) {
<span class="line-numbers">63</span>            <span class="comment">// end::scope[]</span>
<span class="line-numbers">64</span>                <span class="comment">// tag::addToInvList[]</span>
<span class="line-numbers">65</span>                systems.add(system);
<span class="line-numbers">66</span>                <span class="comment">// end::addToInvList[]</span>
<span class="line-numbers">67</span>            } <span class="keyword">finally</span> {
<span class="line-numbers">68</span>                <span class="comment">// tag::spanFinish[]</span>
<span class="line-numbers">69</span>                span.finish();
<span class="line-numbers">70</span>                <span class="comment">// end::spanFinish[]</span>
<span class="line-numbers">71</span>            }
<span class="line-numbers">72</span>            <span class="comment">// end::Try[]</span>
<span class="line-numbers">73</span>        }
<span class="line-numbers">74</span>        <span class="comment">// end::Add[]</span>
<span class="line-numbers">75</span>    }
<span class="line-numbers">76</span>
<span class="line-numbers">77</span>    <span class="comment">// tag::Traced[]</span>
<span class="line-numbers">78</span>    <span class="annotation">@Traced</span>(value = <span class="predefined-constant">true</span>, operationName = <span class="string"><span class="delimiter">"</span><span class="content">InventoryManager.list</span><span class="delimiter">"</span></span>)
<span class="line-numbers">79</span>    <span class="comment">// end::Traced[]</span>
<span class="line-numbers">80</span>    <span class="comment">// tag::list[]</span>
<span class="line-numbers">81</span>    <span class="directive">public</span> InventoryList list() {
<span class="line-numbers">82</span>        <span class="keyword">return</span> <span class="keyword">new</span> InventoryList(systems);
<span class="line-numbers">83</span>    }
<span class="line-numbers">84</span>    <span class="comment">// end::list[]</span>
<span class="line-numbers">85</span>}
<span class="line-numbers">86</span><span class="comment">// end::InventoryManager[]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code class="hotspot=Traced file=0">@Traced</code> annotation can be configured with the following two parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>value=[true|false]</code> parameter indicates whether a particular class or method is traced. For example, while all JAX-RS methods are traced by default, you can disable their tracing by using the <code>@Traced(false)</code> annotation. This parameter is set to <code>true</code> by default.</p>
</li>
<li>
<p>The <code>operationName=&lt;Span name&gt;</code> parameter indicates the name of the span that is assigned to the particular method that is traced. If you omit this parameter, the span will be named with the following form: <code>&lt;package name&gt;.&lt;class name&gt;.&lt;method name&gt;</code>. If you use this parameter at a class level, then all methods within that class will have the same span name unless they’re explicitly overridden by another <code>@Traced</code> annotation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Next, run the following command from the <code>start</code> directory to recompile your services.</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn compile</code></pre>
</div>
</div>
<div class="paragraph">
<p>Visit the <a href="http://localhost:9081/inventory/systems" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9081/inventory/systems</a> URL, check your Zipkin server, and sort the traces by newest first.</p>
</div>
<div class="paragraph">
<p>Look for a new trace record that is two spans long with one span for the <code class="hotspot=listContents file=1">listContents()</code> JAX-RS method in the <code class="hotspot file=1">InventoryResource</code> class and another span for the <code class="hotspot=list file=0">list()</code> method in the <code class="hotspot file=0">InventoryManager</code> class. Verify that these spans have the following names:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>get:io.openliberty.guides.inventory.inventoryresource.listcontents</code></p>
</li>
<li>
<p><code>inventorymanager.list</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now, disable tracing on the <code>InventoryResource</code> class by setting <code class="hotspot=Traced-false file=1">@Traced(false)</code> on the <code class="hotspot=listContents file=1">listContents()</code> JAX-RS method.</p>
</div>
<div class="listingblock code_command hotspot file=1">
<div class="content">
<pre><mark>Replace the <code>InventoryResource</code> class.</mark>
<code>inventory/src/main/java/io/openliberty/guides/inventory/InventoryResource.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>InventoryResource.java</p>
</div>
<div class="listingblock code_column hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="Java"><span class="line-numbers"> 1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers"> 2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers"> 3</span><span class="comment"> * Copyright (c) 2017, 2020 IBM Corporation and others.</span>
<span class="line-numbers"> 4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers"> 5</span><span class="comment"> * are made available under the terms of the Eclipse Public License v1.0</span>
<span class="line-numbers"> 6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers"> 7</span><span class="comment"> * http://www.eclipse.org/legal/epl-v10.html</span>
<span class="line-numbers"> 8</span><span class="comment"> *</span>
<span class="line-numbers"> 9</span><span class="comment"> * Contributors:</span>
<span class="line-numbers">10</span><span class="comment"> *     IBM Corporation - Initial implementation</span>
<span class="line-numbers">11</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers">12</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers">13</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.inventory</span>;
<span class="line-numbers">14</span>
<span class="line-numbers">15</span><span class="keyword">import</span> <span class="include">java.util.Properties</span>;
<span class="line-numbers">16</span><span class="keyword">import</span> <span class="include">javax.enterprise.context.RequestScoped</span>;
<span class="line-numbers">17</span><span class="keyword">import</span> <span class="include">javax.inject.Inject</span>;
<span class="line-numbers">18</span><span class="keyword">import</span> <span class="include">javax.ws.rs.GET</span>;
<span class="line-numbers">19</span><span class="keyword">import</span> <span class="include">javax.ws.rs.Path</span>;
<span class="line-numbers">20</span><span class="keyword">import</span> <span class="include">javax.ws.rs.PathParam</span>;
<span class="line-numbers">21</span><span class="keyword">import</span> <span class="include">javax.ws.rs.Produces</span>;
<span class="line-numbers">22</span><span class="keyword">import</span> <span class="include">javax.ws.rs.core.MediaType</span>;
<span class="line-numbers">23</span><span class="keyword">import</span> <span class="include">javax.ws.rs.core.Response</span>;
<span class="line-numbers">24</span>
<span class="line-numbers">25</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.opentracing.Traced</span>;
<span class="line-numbers">26</span>
<span class="line-numbers">27</span><span class="keyword">import</span> <span class="include">io.openliberty.guides.inventory.model.InventoryList</span>;
<span class="line-numbers">28</span>
<span class="line-numbers">29</span><span class="annotation">@RequestScoped</span>
<span class="line-numbers">30</span><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">"</span><span class="content">/systems</span><span class="delimiter">"</span></span>)
<span class="line-numbers">31</span><span class="comment">// tag::InventoryResource[]</span>
<span class="line-numbers">32</span><span class="directive">public</span> <span class="type">class</span> <span class="class">InventoryResource</span> {
<span class="line-numbers">33</span>
<span class="line-numbers">34</span>    <span class="annotation">@Inject</span> InventoryManager manager;
<span class="line-numbers">35</span>
<span class="line-numbers">36</span>    <span class="annotation">@GET</span>
<span class="line-numbers">37</span>    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">"</span><span class="content">/{hostname}</span><span class="delimiter">"</span></span>)
<span class="line-numbers">38</span>    <span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
<span class="line-numbers">39</span>    <span class="comment">// tag::getPropertiesForHost[]</span>
<span class="line-numbers">40</span>    <span class="directive">public</span> Response getPropertiesForHost(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">"</span><span class="content">hostname</span><span class="delimiter">"</span></span>) <span class="predefined-type">String</span> hostname) {
<span class="line-numbers">41</span>        <span class="predefined-type">Properties</span> props = manager.get(hostname);
<span class="line-numbers">42</span>        <span class="keyword">if</span> (props == <span class="predefined-constant">null</span>) {
<span class="line-numbers">43</span>            <span class="keyword">return</span> Response.status(Response.Status.NOT_FOUND)
<span class="line-numbers">44</span>                           .entity(<span class="string"><span class="delimiter">"</span><span class="content">{ </span><span class="char">\"</span><span class="content">error</span><span class="char">\"</span><span class="content"> : </span><span class="char">\"</span><span class="content">Unknown hostname or the system service </span><span class="delimiter">"</span></span> 
<span class="line-numbers">45</span>                           + <span class="string"><span class="delimiter">"</span><span class="content">may not be running on </span><span class="delimiter">"</span></span> + hostname + <span class="string"><span class="delimiter">"</span><span class="char">\"</span><span class="content"> }</span><span class="delimiter">"</span></span>)
<span class="line-numbers">46</span>                           .build();
<span class="line-numbers">47</span>        }
<span class="line-numbers">48</span>        manager.add(hostname, props);
<span class="line-numbers">49</span>        <span class="keyword">return</span> Response.ok(props).build();
<span class="line-numbers">50</span>    }
<span class="line-numbers">51</span>    <span class="comment">// end::getPropertiesForHost[]</span>
<span class="line-numbers">52</span>    
<span class="line-numbers">53</span>    <span class="annotation">@GET</span>
<span class="line-numbers">54</span>    <span class="comment">// tag::Traced-false[]</span>
<span class="line-numbers">55</span>    <span class="annotation">@Traced</span>(<span class="predefined-constant">false</span>)
<span class="line-numbers">56</span>    <span class="comment">// end::Traced-false[]</span>
<span class="line-numbers">57</span>    <span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
<span class="line-numbers">58</span>    <span class="comment">// tag::listContents[]</span>
<span class="line-numbers">59</span>    <span class="directive">public</span> InventoryList listContents() {
<span class="line-numbers">60</span>        <span class="keyword">return</span> manager.list();
<span class="line-numbers">61</span>    }
<span class="line-numbers">62</span>    <span class="comment">// end::listContents[]</span>
<span class="line-numbers">63</span>}
<span class="line-numbers">64</span><span class="comment">// end::InventoryResource[]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, run the <code>mvn compile</code> command from the <code>start</code> directory to recompile your services:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn compile</code></pre>
</div>
</div>
<div class="paragraph">
<p>Visit the <a href="http://localhost:9081/inventory/systems" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9081/inventory/systems</a> URL again, check your Zipkin server, and sort the traces by newest first.</p>
</div>
<div class="paragraph">
<p>Look for a new trace record that is just one span long for the remaining <code class="hotspot=list file=0">list()</code> method in the <code>InventoryManager</code> class. Verify that this span has the following name:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>inventorymanager.list</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="injecting-a-custom-tracer-object">Injecting a custom Tracer object</h3>
<div class="paragraph">
<p>The MicroProfile OpenTracing specification also makes the underlying OpenTracing <code>Tracer</code> instance available. The configured <code>Tracer</code> is accessed by injecting it into a bean by using the <code class="hotspot=customTracer file=0">@Inject</code> annotation from the Contexts and Dependency Injections API.</p>
</div>
<div class="paragraph">
<p>After injecting it, the <code class="hotspot=customTracer file=0">Tracer</code> will be used to build a <code class="hotspot=span file=0">Span</code>. The <code>Span</code> will be activated and used in a <code class="hotspot=scope file=0">Scope</code>.</p>
</div>
<div class="listingblock code_command hotspot file=0">
<div class="content">
<pre><mark>Replace the <code>InventoryManager</code> class.</mark>
<code>inventory/src/main/java/io/openliberty/guides/inventory/InventoryManager.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>InventoryManager.java</p>
</div>
<div class="listingblock code_column hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="Java"><span class="line-numbers"> 1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers"> 2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers"> 3</span><span class="comment"> * Copyright (c) 2017, 2021 IBM Corporation and others.</span>
<span class="line-numbers"> 4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers"> 5</span><span class="comment"> * are made available under the terms of the Eclipse Public License v1.0</span>
<span class="line-numbers"> 6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers"> 7</span><span class="comment"> * http://www.eclipse.org/legal/epl-v10.html</span>
<span class="line-numbers"> 8</span><span class="comment"> *</span>
<span class="line-numbers"> 9</span><span class="comment"> * Contributors:</span>
<span class="line-numbers">10</span><span class="comment"> *     IBM Corporation - Initial implementation</span>
<span class="line-numbers">11</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers">12</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers">13</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.inventory</span>;
<span class="line-numbers">14</span>
<span class="line-numbers">15</span><span class="keyword">import</span> <span class="include">java.util.ArrayList</span>;
<span class="line-numbers">16</span><span class="keyword">import</span> <span class="include">java.util.Collections</span>;
<span class="line-numbers">17</span><span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="line-numbers">18</span><span class="keyword">import</span> <span class="include">java.util.Properties</span>;
<span class="line-numbers">19</span><span class="keyword">import</span> <span class="include">javax.enterprise.context.ApplicationScoped</span>;
<span class="line-numbers">20</span><span class="keyword">import</span> <span class="include">javax.inject.Inject</span>;
<span class="line-numbers">21</span>
<span class="line-numbers">22</span><span class="keyword">import</span> <span class="include">io.openliberty.guides.inventory.client.SystemClient</span>;
<span class="line-numbers">23</span><span class="keyword">import</span> <span class="include">io.openliberty.guides.inventory.model.InventoryList</span>;
<span class="line-numbers">24</span><span class="keyword">import</span> <span class="include">io.openliberty.guides.inventory.model.SystemData</span>;
<span class="line-numbers">25</span><span class="keyword">import</span> <span class="include">io.opentracing.Scope</span>;
<span class="line-numbers">26</span><span class="keyword">import</span> <span class="include">io.opentracing.Span</span>;
<span class="line-numbers">27</span><span class="keyword">import</span> <span class="include">io.opentracing.Tracer</span>;
<span class="line-numbers">28</span>
<span class="line-numbers">29</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.opentracing.Traced</span>;
<span class="line-numbers">30</span>
<span class="line-numbers">31</span><span class="annotation">@ApplicationScoped</span>
<span class="line-numbers">32</span><span class="comment">// tag::InventoryManager[]</span>
<span class="line-numbers">33</span><span class="directive">public</span> <span class="type">class</span> <span class="class">InventoryManager</span> {
<span class="line-numbers">34</span>
<span class="line-numbers">35</span>    <span class="directive">private</span> <span class="predefined-type">List</span>&lt;SystemData&gt; systems = <span class="predefined-type">Collections</span>.synchronizedList(<span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;());
<span class="line-numbers">36</span>    <span class="directive">private</span> SystemClient systemClient = <span class="keyword">new</span> SystemClient();
<span class="line-numbers">37</span>    <span class="comment">// tag::customTracer[]</span>
<span class="line-numbers">38</span>    <span class="annotation">@Inject</span> Tracer tracer;
<span class="line-numbers">39</span>    <span class="comment">// end::customTracer[]</span>
<span class="line-numbers">40</span>
<span class="line-numbers">41</span>    <span class="directive">public</span> <span class="predefined-type">Properties</span> get(<span class="predefined-type">String</span> hostname) {
<span class="line-numbers">42</span>        systemClient.init(hostname, <span class="integer">9080</span>);
<span class="line-numbers">43</span>        <span class="predefined-type">Properties</span> properties = systemClient.getProperties();
<span class="line-numbers">44</span>        <span class="keyword">return</span> properties;
<span class="line-numbers">45</span>    }
<span class="line-numbers">46</span>
<span class="line-numbers">47</span>    <span class="directive">public</span> <span class="type">void</span> add(<span class="predefined-type">String</span> hostname, <span class="predefined-type">Properties</span> systemProps) {
<span class="line-numbers">48</span>        <span class="predefined-type">Properties</span> props = <span class="keyword">new</span> <span class="predefined-type">Properties</span>();
<span class="line-numbers">49</span>        props.setProperty(<span class="string"><span class="delimiter">"</span><span class="content">os.name</span><span class="delimiter">"</span></span>, systemProps.getProperty(<span class="string"><span class="delimiter">"</span><span class="content">os.name</span><span class="delimiter">"</span></span>));
<span class="line-numbers">50</span>        props.setProperty(<span class="string"><span class="delimiter">"</span><span class="content">user.name</span><span class="delimiter">"</span></span>, systemProps.getProperty(<span class="string"><span class="delimiter">"</span><span class="content">user.name</span><span class="delimiter">"</span></span>));
<span class="line-numbers">51</span>
<span class="line-numbers">52</span>        SystemData system = <span class="keyword">new</span> SystemData(hostname, props);
<span class="line-numbers">53</span>        <span class="comment">// tag::Add[]</span>
<span class="line-numbers">54</span>        <span class="keyword">if</span> (!systems.contains(system)) {
<span class="line-numbers">55</span>            <span class="comment">// tag::span[]</span>
<span class="line-numbers">56</span>            Span span = tracer.buildSpan(<span class="string"><span class="delimiter">"</span><span class="content">add() Span</span><span class="delimiter">"</span></span>).start();
<span class="line-numbers">57</span>            <span class="comment">// end::span[]</span>
<span class="line-numbers">58</span>            <span class="comment">// tag::Try[]</span>
<span class="line-numbers">59</span>            <span class="comment">// tag::scope[]</span>
<span class="line-numbers">60</span>            <span class="keyword">try</span> (Scope childScope = tracer.scopeManager()
<span class="line-numbers">61</span>                                          .activate(span)
<span class="line-numbers">62</span>                ) {
<span class="line-numbers">63</span>            <span class="comment">// end::scope[]</span>
<span class="line-numbers">64</span>                <span class="comment">// tag::addToInvList[]</span>
<span class="line-numbers">65</span>                systems.add(system);
<span class="line-numbers">66</span>                <span class="comment">// end::addToInvList[]</span>
<span class="line-numbers">67</span>            } <span class="keyword">finally</span> {
<span class="line-numbers">68</span>                <span class="comment">// tag::spanFinish[]</span>
<span class="line-numbers">69</span>                span.finish();
<span class="line-numbers">70</span>                <span class="comment">// end::spanFinish[]</span>
<span class="line-numbers">71</span>            }
<span class="line-numbers">72</span>            <span class="comment">// end::Try[]</span>
<span class="line-numbers">73</span>        }
<span class="line-numbers">74</span>        <span class="comment">// end::Add[]</span>
<span class="line-numbers">75</span>    }
<span class="line-numbers">76</span>
<span class="line-numbers">77</span>    <span class="comment">// tag::Traced[]</span>
<span class="line-numbers">78</span>    <span class="annotation">@Traced</span>(value = <span class="predefined-constant">true</span>, operationName = <span class="string"><span class="delimiter">"</span><span class="content">InventoryManager.list</span><span class="delimiter">"</span></span>)
<span class="line-numbers">79</span>    <span class="comment">// end::Traced[]</span>
<span class="line-numbers">80</span>    <span class="comment">// tag::list[]</span>
<span class="line-numbers">81</span>    <span class="directive">public</span> InventoryList list() {
<span class="line-numbers">82</span>        <span class="keyword">return</span> <span class="keyword">new</span> InventoryList(systems);
<span class="line-numbers">83</span>    }
<span class="line-numbers">84</span>    <span class="comment">// end::list[]</span>
<span class="line-numbers">85</span>}
<span class="line-numbers">86</span><span class="comment">// end::InventoryManager[]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code class="hotspot=scope file=0">Scope</code> is used in a <code class="hotspot=Try file=0">try</code> block. The <code class="hotspot=Try file=0">try</code> block that you see here is called a <code>try-with-resources</code> statement, meaning that the <code class="hotspot=scope file=0">Scope</code> object is closed at the end of the statement. Defining custom spans inside such statements is a good practice. Otherwise, any exceptions that are thrown before the span is closed will leak the active span. The <code class="hotspot=spanFinish file=0">finish()</code> method sets the ending timestamp and records the span.</p>
</div>
<div class="paragraph">
<p>Next, run the following command from the <code>start</code> directory to recompile your services.</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn compile</code></pre>
</div>
</div>
<div class="paragraph">
<p>Visit the <a href="http://localhost:9081/inventory/systems/localhost" target="_blank" rel="noopener noreferrer" class="notranslate">http://localhost:9081/inventory/systems/localhost</a> URL, check your Zipkin server, and sort the traces by newest first.</p>
</div>
<div class="paragraph">
<p>Look for two new trace records, one for the <code>system</code> service and one for the <code>inventory</code> service. The <code>system</code> trace contains one span for the <code class="hotspot=Properties file=1">getProperties()</code> method in the <code class="hotspot file=1">SystemResource</code> class. The <code>inventory</code> trace contains two spans. The first span is for the <code class="hotspot=getPropertiesForHost file=2">getPropertiesForHost()</code> method in the <code class="hotspot file=2">InventoryResource</code> class. The second span is the custom span that you created around the <code class="hotspot=Add file=0">add()</code> call. Verify that all of these spans have the following names:</p>
</div>
<div class="paragraph">
<p>The <code>system</code> trace:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>get:io.openliberty.guides.system.systemresource.getproperties</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>inventory</code> trace:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>get:io.openliberty.guides.inventory.inventoryresource.getpropertiesforhost</code></p>
</li>
<li>
<p><code>add() span</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This simple example shows what you can do with the injected <code>Tracer</code> object. More configuration options are available, including setting a timestamp for when a span was created and destroyed. However, these options require an implementation of their own, which does not come as a part of the Zipkin user feature that is provided. In a real-world scenario, implement all the OpenTracing interfaces that you consider necessary, which might include the <code>SpanBuilder</code> interface. You can use this interface for span creation and customization, including setting timestamps.</p>
</div>
<div class="paragraph">
<p>SystemResource.java</p>
</div>
<div class="listingblock code_column hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="Java"><span class="line-numbers"> 1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers"> 2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers"> 3</span><span class="comment"> * Copyright (c) 2017, 2020 IBM Corporation and others.</span>
<span class="line-numbers"> 4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers"> 5</span><span class="comment"> * are made available under the terms of the Eclipse Public License v1.0</span>
<span class="line-numbers"> 6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers"> 7</span><span class="comment"> * http://www.eclipse.org/legal/epl-v10.html</span>
<span class="line-numbers"> 8</span><span class="comment"> *</span>
<span class="line-numbers"> 9</span><span class="comment"> * Contributors:</span>
<span class="line-numbers">10</span><span class="comment"> *     IBM Corporation - Initial implementation</span>
<span class="line-numbers">11</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers">12</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers">13</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.system</span>;
<span class="line-numbers">14</span>
<span class="line-numbers">15</span><span class="keyword">import</span> <span class="include">java.util.Properties</span>;
<span class="line-numbers">16</span>
<span class="line-numbers">17</span><span class="comment">// CDI</span>
<span class="line-numbers">18</span><span class="keyword">import</span> <span class="include">javax.enterprise.context.RequestScoped</span>;
<span class="line-numbers">19</span><span class="keyword">import</span> <span class="include">javax.ws.rs.GET</span>;
<span class="line-numbers">20</span><span class="comment">// JAX-RS</span>
<span class="line-numbers">21</span><span class="keyword">import</span> <span class="include">javax.ws.rs.Path</span>;
<span class="line-numbers">22</span><span class="keyword">import</span> <span class="include">javax.ws.rs.Produces</span>;
<span class="line-numbers">23</span><span class="keyword">import</span> <span class="include">javax.ws.rs.core.MediaType</span>;
<span class="line-numbers">24</span>
<span class="line-numbers">25</span><span class="annotation">@RequestScoped</span>
<span class="line-numbers">26</span><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">"</span><span class="content">properties</span><span class="delimiter">"</span></span>)
<span class="line-numbers">27</span><span class="directive">public</span> <span class="type">class</span> <span class="class">SystemResource</span> {
<span class="line-numbers">28</span>
<span class="line-numbers">29</span>  <span class="annotation">@GET</span>
<span class="line-numbers">30</span>  <span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
<span class="line-numbers">31</span>  <span class="comment">// tag::Properties[]</span>
<span class="line-numbers">32</span>  <span class="directive">public</span> <span class="predefined-type">Properties</span> getProperties() {
<span class="line-numbers">33</span>    <span class="keyword">return</span> <span class="predefined-type">System</span>.getProperties();
<span class="line-numbers">34</span>  }
<span class="line-numbers">35</span>  <span class="comment">// end::Properties[]</span>
<span class="line-numbers">36</span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>InventoryResource.java</p>
</div>
<div class="listingblock code_column hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="Java"><span class="line-numbers"> 1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers"> 2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers"> 3</span><span class="comment"> * Copyright (c) 2017, 2020 IBM Corporation and others.</span>
<span class="line-numbers"> 4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers"> 5</span><span class="comment"> * are made available under the terms of the Eclipse Public License v1.0</span>
<span class="line-numbers"> 6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers"> 7</span><span class="comment"> * http://www.eclipse.org/legal/epl-v10.html</span>
<span class="line-numbers"> 8</span><span class="comment"> *</span>
<span class="line-numbers"> 9</span><span class="comment"> * Contributors:</span>
<span class="line-numbers">10</span><span class="comment"> *     IBM Corporation - Initial implementation</span>
<span class="line-numbers">11</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers">12</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers">13</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.inventory</span>;
<span class="line-numbers">14</span>
<span class="line-numbers">15</span><span class="keyword">import</span> <span class="include">java.util.Properties</span>;
<span class="line-numbers">16</span><span class="keyword">import</span> <span class="include">javax.enterprise.context.RequestScoped</span>;
<span class="line-numbers">17</span><span class="keyword">import</span> <span class="include">javax.inject.Inject</span>;
<span class="line-numbers">18</span><span class="keyword">import</span> <span class="include">javax.ws.rs.GET</span>;
<span class="line-numbers">19</span><span class="keyword">import</span> <span class="include">javax.ws.rs.Path</span>;
<span class="line-numbers">20</span><span class="keyword">import</span> <span class="include">javax.ws.rs.PathParam</span>;
<span class="line-numbers">21</span><span class="keyword">import</span> <span class="include">javax.ws.rs.Produces</span>;
<span class="line-numbers">22</span><span class="keyword">import</span> <span class="include">javax.ws.rs.core.MediaType</span>;
<span class="line-numbers">23</span><span class="keyword">import</span> <span class="include">javax.ws.rs.core.Response</span>;
<span class="line-numbers">24</span>
<span class="line-numbers">25</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.opentracing.Traced</span>;
<span class="line-numbers">26</span>
<span class="line-numbers">27</span><span class="keyword">import</span> <span class="include">io.openliberty.guides.inventory.model.InventoryList</span>;
<span class="line-numbers">28</span>
<span class="line-numbers">29</span><span class="annotation">@RequestScoped</span>
<span class="line-numbers">30</span><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">"</span><span class="content">/systems</span><span class="delimiter">"</span></span>)
<span class="line-numbers">31</span><span class="comment">// tag::InventoryResource[]</span>
<span class="line-numbers">32</span><span class="directive">public</span> <span class="type">class</span> <span class="class">InventoryResource</span> {
<span class="line-numbers">33</span>
<span class="line-numbers">34</span>    <span class="annotation">@Inject</span> InventoryManager manager;
<span class="line-numbers">35</span>
<span class="line-numbers">36</span>    <span class="annotation">@GET</span>
<span class="line-numbers">37</span>    <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">"</span><span class="content">/{hostname}</span><span class="delimiter">"</span></span>)
<span class="line-numbers">38</span>    <span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
<span class="line-numbers">39</span>    <span class="comment">// tag::getPropertiesForHost[]</span>
<span class="line-numbers">40</span>    <span class="directive">public</span> Response getPropertiesForHost(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">"</span><span class="content">hostname</span><span class="delimiter">"</span></span>) <span class="predefined-type">String</span> hostname) {
<span class="line-numbers">41</span>        <span class="predefined-type">Properties</span> props = manager.get(hostname);
<span class="line-numbers">42</span>        <span class="keyword">if</span> (props == <span class="predefined-constant">null</span>) {
<span class="line-numbers">43</span>            <span class="keyword">return</span> Response.status(Response.Status.NOT_FOUND)
<span class="line-numbers">44</span>                           .entity(<span class="string"><span class="delimiter">"</span><span class="content">{ </span><span class="char">\"</span><span class="content">error</span><span class="char">\"</span><span class="content"> : </span><span class="char">\"</span><span class="content">Unknown hostname or the system service </span><span class="delimiter">"</span></span> 
<span class="line-numbers">45</span>                           + <span class="string"><span class="delimiter">"</span><span class="content">may not be running on </span><span class="delimiter">"</span></span> + hostname + <span class="string"><span class="delimiter">"</span><span class="char">\"</span><span class="content"> }</span><span class="delimiter">"</span></span>)
<span class="line-numbers">46</span>                           .build();
<span class="line-numbers">47</span>        }
<span class="line-numbers">48</span>        manager.add(hostname, props);
<span class="line-numbers">49</span>        <span class="keyword">return</span> Response.ok(props).build();
<span class="line-numbers">50</span>    }
<span class="line-numbers">51</span>    <span class="comment">// end::getPropertiesForHost[]</span>
<span class="line-numbers">52</span>    
<span class="line-numbers">53</span>    <span class="annotation">@GET</span>
<span class="line-numbers">54</span>    <span class="comment">// tag::Traced-false[]</span>
<span class="line-numbers">55</span>    <span class="annotation">@Traced</span>(<span class="predefined-constant">false</span>)
<span class="line-numbers">56</span>    <span class="comment">// end::Traced-false[]</span>
<span class="line-numbers">57</span>    <span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
<span class="line-numbers">58</span>    <span class="comment">// tag::listContents[]</span>
<span class="line-numbers">59</span>    <span class="directive">public</span> InventoryList listContents() {
<span class="line-numbers">60</span>        <span class="keyword">return</span> manager.list();
<span class="line-numbers">61</span>    }
<span class="line-numbers">62</span>    <span class="comment">// end::listContents[]</span>
<span class="line-numbers">63</span>}
<span class="line-numbers">64</span><span class="comment">// end::InventoryResource[]</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing-the-services">Testing the services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>No automated tests are provided to verify the correctness of the traces. Manually verify these traces by viewing them on the Zipkin server.</p>
</div>
<div class="paragraph">
<p>A few tests are included for you to test the basic functionality of the services. If a test failure occurs, then you might have introduced a bug into the code. These tests will run automatically as a part of the Maven build process when you run the <code>mvn install</code> command. You can also run these tests separately from the build by using the <code>mvn verify</code> command, but first make sure the servers are stopped.</p>
</div>
<div class="paragraph">
<p>When you’re done checking out the services, stop the server by using the Maven
<code>liberty:stop-server</code> goal:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn liberty:stop-server</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="great-work-youre-done">Great work! You’re done!</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You have just used MicroProfile OpenTracing in Open Liberty to customize how and which traces are delivered to Zipkin.</p>
</div>
<div class="paragraph">
<p>Feel free to try one of the related MicroProfile guides. They demonstrate additional technologies that you can learn to expand on top of what you built here.</p>
</div>
</div>
</div>
<div class="sect1 command">
<h2 id="guide-attribution">Guide Attribution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Enabling distributed tracing in microservices with Zipkin <span class="licensedClass">by</span> Open Liberty <span class="licensedClass">is licensed under</span> CC BY-ND 4.0</p>
</div>
</div>
</div>
    </div>
  </div>

  <!-- Code section -->
  <div id="code_column" class="position_relative" tabindex="0">
    <div id="code_column_title_container">
      <div id="code_column_tabs_container" class="dimmed">
        <ul id="code_column_tabs" class="nav" role="tablist"></ul>
      </div>
      <div class="copyFileButton" tabindex="0">
        <img src="/img/guides_copy_button.svg" alt="Copy file contents" title="Copy file contents">
        <div id="code_section_copied_confirmation">Copied to clipboard </div>
      </div>
    </div>
    <div id="code_column_content"></div>

    <div id="prereqs_container">
      <p id="prereqs_title">Prerequisites:</p>
      <div class="prereqs_list"></div>
      <div class="skills_network_container">
        <div class="skills_network_description"></div>
      </div>
    </div>

    <button id="dismiss_button" aria-label="Back to text" tabindex="0">
      Back to text
    </button>
  </div>
</div>

<!-- Build a list of all the documents in the guides code base -->






<!-- Remove any documents deemed private (archived, templates, etc) -->


<!-- Count number of guides from past 30 days-->


    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    


<!-- Sort list of guides by date with most recent first -->





<div id="end_of_guide">
        <h2 tabindex="0">Nice work! Where to next?</h2>
        <div id="end_of_guide_left_section">
            <p id="guide_attribution"></p>
            
            <h3 id="feedback_rating_question">What did you think of this guide?</h3>
            <div id="feedback_ratings">
                <img class="guide_rating" id="extreme_dislike" src="/img/1_Extreme_Dislike.png" onclick="$('#dislike_popup').show(); $('.popup_content').focus();" alt="Extreme Dislike" data-guide-rating="1" tabindex="0" aria-label="Rate this guide as extreme dislike">
                <img class="guide_rating" id="dislike" src="/img/2_Dislike.png" onclick="$('#dislike_popup').show(); $('.popup_content').focus();" alt="Dislike" data-guide-rating="2" tabindex="0" aria-label="Rate this guide as dislike">
                <img class="guide_rating" id="like" src="/img/3_Like.png" onclick="$('#like_popup').show(); $('.popup_content').focus();" alt="Like" data-guide-rating="3" tabindex="0" aria-label="Rate this guide as like">
                <img class="guide_rating" id="extreme_like" src="/img/4_Extreme_Like.png" onclick="$('#like_popup').show(); $('.popup_content').focus();" alt="Extreme Like" data-guide-rating="4" tabindex="0" aria-label="Rate this guide as extreme like">
            </div>

            <div id="like_popup" class="popup">
                <div class="popup_content" tabindex="0">
                    <p class="popup_title">Thank you for your feedback!</p>
                    <button id="close_button" class="popup_button" onclick="$('#like_popup').hide();">Close</button>
                </div>
            </div>

            <div id="dislike_popup" class="popup">
                <div class="popup_content" tabindex="0">
                    <p class="popup_title">Thank you for your feedback!</p>
                    <p id="open_issue">Would you like to open an issue in GitHub?</p>
                    
                        <a href="https://github.com/OpenLiberty/guide-microprofile-opentracing/issues/new" target="_blank" id="yes_button" class="popup_button" onclick="$('#dislike_popup').hide();" rel="noopener noreferrer">Yes</a>
                    
                    <button id="no_button" class="popup_button" onclick="$('#dislike_popup').hide();">No, thank you</button>
                </div>
            </div>

            <h3 id="improve_guide_feedback">What could make this guide better?</h3>
            
                <p><a target="_blank" rel="noopener noreferrer" href="https://github.com/OpenLiberty/guide-microprofile-opentracing/issues">Raise an issue</a> to share feedback</p>
                <p><a target="_blank" rel="noopener noreferrer" href="https://github.com/OpenLiberty/guide-microprofile-opentracing/pulls">Create a pull request</a> to contribute to this guide</p>
            

            <h3 id="need_help">Need help?</h3>
            <p><a target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/questions/tagged/open-liberty">Ask a question on Stack Overflow</a></p>

            <h3>Like Open Liberty? Star our repo on GitHub.</h3>
            <a class="github-button" href="https://github.com/OpenLiberty/open-liberty" data-icon="octicon-star" aria-label="Star OpenLiberty/open-liberty on GitHub" target="_blank" rel="noopener noreferrer">Star</a>
        </div>
        <div id="end_of_guide_right_section">
            <h3 id="where_to_next">Where to next?</h3>

            
            

            <!-- Related guides section -->
            
            <div id="related-guides">
                <div id="related-guides-cards" class="row">
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/cdi-intro.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Injecting dependencies into microservices</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">15 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/microprofile-opentracing-jaeger.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Enabling distributed tracing in microservices with Jaeger</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">20 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                </div>
            </div>
            
        </div>
    </div>



    </main>

    



<footer>
    <div id="footer_gray_background">
        <div id="footer_top_container" class="footer_container container-fluid">
            <div id="footer_project_container">
                <span id="footer_open_liberty"></span>
                <p id="footer_project">IBM 开放式源代码项目</p>
            </div>
            <div id="footer_round_links_container">
                <a id="footer_github_link" class="footer_round_btn" href="https://github.com/OpenLiberty/" target="_blank" rel="noopener noreferrer" aria-label="Github"></a>
                <a id="footer_twitter_link" class="footer_round_btn" href="https://twitter.com/OpenLibertyIO" target="_blank" rel="noopener noreferrer" aria-label="Twitter"></a>
                <a id="footer_stackoverflow_link" class="footer_round_btn" href="https://stackoverflow.com/questions/tagged/open-liberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty questions on Stack Overflow"></a>
                <a id="footer_groupsio_link" class="footer_round_btn" href="https://groups.io/g/openliberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Groups.io"></a>
                <a id="footer_gitter_link" class="footer_round_btn" href="https://app.gitter.im/#/room/#OpenLiberty_development:gitter.im" target="_blank" rel="noopener" aria-label="Open Liberty Gitter"></a>
            </div>
        </div>         
    </div>

    <div id="footer_bottom_container" class="footer_container container-fluid">
        <div id="footer_bottom_left_section">
            <p id="footer_copyright">© Copyright IBM Corp. 2017, 2023</p>
            <p class="vertical_bar">|</p>
            <a id="footer_privacy_policy_link" href="https://www.ibm.com/privacy/" target="_blank" rel="noopener noreferrer" class="left_footer_link">隐私策略</a>
            <p class="vertical_bar">|</p>
            <a id="footer_license_link" href="https://github.com/OpenLiberty/open-liberty/blob/release/LICENSE" target="_blank" rel="noopener noreferrer" class="left_footer_link">许可证</a>
            <p class="vertical_bar">|</p>
            <a id="footer_logos_link" href="https://github.com/OpenLiberty/logos" target="_blank" rel="noopener noreferrer" class="left_footer_link">洛戈斯</a>
        </div>
        <div id="footer_bottom_right_section">
            <a id="footer_docs_link" href="/docs" aria-label="Open Liberty Docs" class="right_footer_link blue_link_light_background">文档</a>
            <a id="footer_blog_link" href="/blog" aria-label="Open Liberty Blog" class="right_footer_link blue_link_light_background">博客</a>
            <a id="footer_support_link" href="/support" aria-label="Open Liberty Support" class="right_footer_link blue_link_light_background">支持</a>
        </div>
    </div>
</footer>

<!-- PRE-LOADED IMAGES FOR ON HOVER BEHAVIOR -->
<div class="d-none hidden">
    <img src="/img/Footer_GitCat_Hover.svg" alt="OpenLiberty Github link">
    <img src="/img/Footer_TwitterBird_Hover.svg" alt="OpenLibertyIO Twitter link">
    <img src="/img/Footer_StackO_Hover.svg" alt="Open-liberty Stack Overflow link">
    <img src="/img/Footer_GroupsIO_Hover.svg" alt="Openliberty Groups IO link">
    <img src="/img/footer_gitter_hover.svg" alt="Openliberty Gitter link">
</div>

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js" integrity="sha512-lzilC+JFd6YV8+vQRNRtU7DOqv5Sa9Ek53lXt/k91HZTJpytHS1L6l1mMKR9K6VVoDt4LiEXaa6XBrYk1YhGTQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>


<script type="text/javascript" src="/zh-Hans/assets/devEnvironment.js"></script>




  <script type="text/javascript" src="/zh-Hans/assets/guide-common.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/toc.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/tabs.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/guide-static.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/guide-multipane-static.js"></script>


<script type="text/javascript" src="/zh-Hans/assets/openliberty.js"></script>

  </body>

</html>
