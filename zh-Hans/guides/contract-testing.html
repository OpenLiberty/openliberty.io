<!DOCTYPE html>
<html lang="zh-Hans">

  





<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>
    
      Implement consumer-driven contract testing for Java microservices using the Pact framework
    
  </title>
  <meta name="description" content="A getting started tutorial with examples on how to implement consumer-driven contract testing using the Pact framework for Java microservices and cloud-native applications written using MicroProfile and Jakarta EE API.">

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
  

  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/openliberty.css">
  <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/coderay-custom.css">

  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/header.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/header-dark.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/toc-multipane-static.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/end-of-guide.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-card.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/tabs.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-common.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-multipane.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-multipane-static.css">
  

  

  

  <link rel="canonical" href="https://openliberty.io/zh-Hans/guides/contract-testing">
  <link rel="alternate" type="application/rss+xml" title="Open Liberty" href="/zh-Hans/feed.xml">
  <link href="https://fonts.googleapis.com/css?family=Asap:400,500" rel="stylesheet">
    
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@OpenLibertyIO" />
  <meta name="twitter:title" content="Implement consumer-driven contract testing for Java microservices using the Pact framework" />
  <meta name="twitter:description" content="A getting started tutorial with examples on how to implement consumer-driven contract testing using the Pact framework for Java microservices and cloud-native applications written using MicroProfile and Jakarta EE API." />

  <meta property='og:title' content="Implement consumer-driven contract testing for Java microservices using the Pact framework" />
  <meta property='og:image' content="https://openliberty.io/img/twitter_card.jpg" />
  <meta property='og:image:alt' content="Open Liberty Logo" />
  <meta property='og:description' content="A getting started tutorial with examples on how to implement consumer-driven contract testing using the Pact framework for Java microservices and cloud-native applications written using MicroProfile and Jakarta EE API." />
  <meta property='og:url' content="https://openliberty.io/zh-Hans/guides/contract-testing" />
  <meta property='og:type' content="website" />
  
  <meta name="google-site-verification" content="h2P030H9b66CyL1nEmWfrZB8Fr14h9LmVMG7Ur0caBs" />

  
      <meta name="robots" content="noindex" />
  

  <script async defer src="https://buttons.github.io/buttons.js"></script>
</head>


  <body>
    
    

    


<!--  -->

<header>
    <nav id="nav_bar">
        <div id="nav_header">
            <a id="home_link" href="/" aria-label="Open Liberty Home">
                <img id="ol_logo" src="/img/docs_openliberty_logo.png" alt="Open Liberty Logo">
            </a>
            <button id="hamburger_toggle_button" onclick="$('#nav_bar').toggleClass('responsive');">
                <span id="hamburger_toggle_icon"></span>
            </button>
        </div>
        <div id="hamburger_menu">
            <ul class="nav_list">
                <li class="nav_link">
                    <a href="/start/">入门</a>
                </li>
                <li class="nav_link">
                    <a href="/guides/">指南</a>
                </li>
                <li class="nav_link">
                    <a href="/docs/">文档</a>
                </li>
                <li class="nav_link">
                    <a href="/support/">支持</a>
                </li>
                <li class="nav_link">
                    <a href="/blog/">博客</a>
                </li>
            </ul>
            <div id="header_round_links_container"> 
                <a id="header_twitter_link" class="header_round_button" href="https://twitter.com/OpenLibertyIO" target="_blank" rel="noopener noreferrer" aria-label="Twitter"></a>
                <a id="header_stackoverflow_link" class="header_round_button" href="https://stackoverflow.com/questions/tagged/open-liberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty questions on Stack Overflow"></a>
                <a id="header_groupsio_link" class="header_round_button" href="https://groups.io/g/openliberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Groups.io"></a>
                <a id="header_gitter_link" class="header_round_button" href="https://app.gitter.im/#/room/#OpenLiberty_development:gitter.im" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Gitter"></a>
            </div>
        </div>

    </nav>
</header>


    <main aria-label="Content">

      <!-- Build a list of all the documents in the guides code base -->
  
 

<!-- Remove any documents deemed private (archived, templates, etc) -->


<!-- Count number of guides from past 30 days-->
<!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
 

<!-- Sort list of guides by date with most recent first -->


<div id="background_container">
  <div id="toc_hotspot"></div>
  <!-- Guide's table of contents section -->
  <div id="toc_column" class="collapse inline open">
    <div id="toc_inner">
       
      <div id="close_container">
        <img id="toc_close_white" src="/img/toc_close_white.svg" alt="Close the table of contents" tabindex="0">
      </div>
      <h3 id="toc_title">Contents</h3>
      <div id="toc_container"><ul class="sectlevel1">
<li><a href="#what-youll-learn">What you’ll learn</a></li>
<li><a href="#additional-prerequisites">Additional prerequisites</a></li>
<li>
<a href="#getting-started">Getting started</a>
<ul class="sectlevel2">
<li><a href="#starting-the-pact-broker">Starting the Pact Broker</a></li>
</ul>
</li>
<li><a href="#implementing-pact-testing-in-the-inventory-service">Implementing pact testing in the inventory service</a></li>
<li><a href="#verifying-the-pact-in-the-pact-broker">Verifying the pact in the Pact Broker</a></li>
<li><a href="#implementing-pact-testing-in-the-system-service">Implementing pact testing in the system service</a></li>
<li><a href="#verifying-the-contract">Verifying the contract</a></li>
<li><a href="#tearing-down-the-environment">Tearing down the environment</a></li>
<li><a href="#great-work-youre-done">Great work! You’re done!</a></li>
<li><a href="#related-links">Related Links</a></li>
<li><a href="#guide-attribution">Guide Attribution</a></li>
</ul></div>
      <div id="toc_separator"></div>
      
      <h3 id="tag_title">标签</h3>
      <div id="tags_container"></div>
    </div>
  </div>
  <div id="toc_indicator" tabindex="0" aria-label="Open the table of contents" class="hidden">
    <img src="/img/arrow_white.svg" alt="arrow">
  </div>
  <div id="toc_line" class="open"></div>
  <!-- Entire guide section -->
  <div id="guide_column" class="position_relative open">
    <div id="guide_content">
      <!-- Guide header section -->
      <div id="guide_meta" class="sect1" tabindex="0">
        <h1 id="guide_title">Testing microservices with consumer-driven contracts</h1>
        <div id="duration_container">
          <img src="/img/guide_duration_clock_icon_large.svg" alt="duration">
          <span id="guide_duration">30 minutes</span>

          <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
          <!-- If new posts count is less than 4, use 4 most recent posts -->
           
          <!-- If new posts count is >= 4, use posts from last 30 days-->
          
          <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
          <!-- Count number of guides from past last 12 weeks that is 84 days-->
          <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
          
        </div>
        <div id="mobile_prereqs_section">
          <p id="mobile_prereqs_title">Prerequisites:</p>
          <div class="prereqs_list"></div>
          <div class="skills_network_container">
            <div class="skills_network_description"></div>
          </div>
        </div>
      </div>

      <div class="scroller_anchor"></div>
      <div id="mobile_toc_accordion_container" data-toggle="collapse" data-target="#toc_column" aria-expanded="false" aria-controls="toc_column" role="button">
        <div role="menuitem" id="mobile_toc_accordion">
          <button class="breadcrumb_hamburger toc-toggle collapsed" type="button" tabindex="0">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <img src="/img/toc_close_green.svg" class="TOC_Close_SVG hidden img-responsive" alt="Table of contents close button">
          </button>
          <span>Table of contents</span>
        </div>
      </div>

      <!-- Guide content section -->
      <div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note hidden">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This repository contains the guide documentation source. To view the guide in published form, view it on the <a href="https://openliberty.io/guides/contract-testing.html">Open Liberty website</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Learn how to test Java microservices with consumer-driven contracts in Open Liberty.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-youll-learn">What you’ll learn</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With a microservices-based architecture, you need robust testing to ensure that microservices that depend on one another are able to communicate effectively.  Typically, to prevent multiple points of failure at different integration points, a combination of unit, integration, and end-to-end tests are used. While unit tests are fast, they are less trustworthy because they run in isolation and usually rely on mock data.</p>
</div>
<div class="paragraph">
<p>Integration tests address this issue by testing against real running services. However, they tend to be slow as the tests depend on other microservices and are less reliable because they are prone to external changes.</p>
</div>
<div class="paragraph">
<p>Usually, end-to-end tests are more trustworthy because they verify functionality from the perspective of a user. However, a graphical user interface (GUI) component is often required to perform end-to-end tests, and GUI components rely on third-party software, such as Selenium, which requires heavy computation time and resources.</p>
</div>
<div class="paragraph">
<p><strong>What is contract testing?</strong></p>
</div>
<div class="paragraph">
<p>Contract testing bridges the gaps among the shortcomings of these different testing methodologies. Contract testing is a technique for testing an integration point by isolating each microservice and checking whether the HTTP requests and responses that the microservice transmits conform to a shared understanding that is documented in a contract. This way, contract testing ensures that microservices can communicate with each other.</p>
</div>
<div class="paragraph">
<p><a href="https://docs.pact.io/" target="_blank" rel="noopener noreferrer">Pact</a> is an open source contract testing tool for testing HTTP requests, responses, and message integrations by using contract tests.</p>
</div>
<div class="paragraph">
<p>The <a href="https://docs.pact.io/pact_broker/docker_images" target="_blank" rel="noopener noreferrer">Pact Broker</a> is an application for sharing Pact contracts and verification results. The Pact Broker is also an important piece for integrating Pact into continuous integration and continuous delivery (CI/CD) pipelines.</p>
</div>
<div class="paragraph">
<p>The two microservices you will interact with are called <code>system</code> and <code>inventory</code>. The <code>system</code> microservice returns the JVM system properties of its host. The <code>inventory</code> microservice retrieves specific properties from the <code>system</code> microservice.</p>
</div>
<div class="paragraph">
<p>You will learn how to use the Pact framework to write contract tests for the <code>inventory</code> microservice that will then be verified by the <code>system</code> microservice.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="additional-prerequisites">Additional prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you begin, you need to install Docker if it is not already installed. For installation instructions, refer to the <a href="https://docs.docker.com/get-docker/" target="_blank" rel="noopener noreferrer">official Docker documentation</a>. You will deploy the Pact Broker in a Docker container.</p>
</div>
<div class="paragraph">
<p>Start your Docker daemon before you proceed.</p>
</div>
</div>
</div>
<div class="sect1 command">
<h2 id="getting-started">Getting started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The fastest way to work through this guide is to clone the <a href="https://github.com/openliberty/guide-contract-testing.git" target="_blank" rel="noopener noreferrer">Git repository</a> and use the projects that are provided inside:</p>
</div>
<div id="git_clone" class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>git clone https://github.com/openliberty/guide-contract-testing.git
cd guide-contract-testing</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>start</code> directory contains the starting project that you will build upon.</p>
</div>
<div class="paragraph">
<p>The <code>finish</code> directory contains the finished project that you will build.</p>
</div>
<div class="paragraph">
<p>Before you begin, make sure you have all the necessary <span class="prerequisites">prerequisites</span>.</p>
</div>
<div class="sect2">
<h3 id="starting-the-pact-broker">Starting the Pact Broker</h3>
<div class="paragraph">
<p>Run the following command to start the Pact Broker:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker-compose -f "pact-broker/docker-compose.yml" up -d --build</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the Pact Broker is running, you’ll see the following output:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre class="CodeRay highlight"><code>Creating pact-broker_postgres_1 ... done
Creating pact-broker_pact-broker_1 ... done</code></pre>
</div>
</div>
<div class="paragraph">
<p>Go to the <a href="http://localhost:9292/" class="notranslate bare" target="_blank" rel="noopener noreferrer">http://localhost:9292/</a> URL to confirm that you can access the user interface (UI) of the Pact Broker.</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="/img/guide/contract-testing/pact-broker-webpage.png" alt="Pact Broker webpage">
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="paragraph">
<p>You can refer to the <a href="https://docs.pact.io/pact_broker/docker_images/pactfoundation" target="_blank" rel="noopener noreferrer">official Pact Broker documentation</a> for more information about the components of the Docker Compose file.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="implementing-pact-testing-in-the-inventory-service">Implementing pact testing in the inventory service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Navigate to the <code>start/inventory</code> directory to begin.</p>
</div>
<div class="paragraph command">
<p>When you run Open Liberty in <a href="https://openliberty.io/docs/latest/development-mode.html" target="_blank" rel="noopener">dev mode</a>, dev mode listens for file changes and automatically recompiles and deploys your updates whenever you save a new change. Run the following goal to start Open Liberty in dev mode:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn liberty:dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>After you see the following message, your Liberty instance is ready in dev mode:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>**************************************************************
*    Liberty is running in dev mode.</pre>
</div>
</div>
<div class="paragraph">
<p>Dev mode holds your command-line session to listen for file changes. Open another command-line session to continue, or open the project in your editor.</p>
</div>
<div class="paragraph">
<p>Navigate back to the <code>start</code> directory.</p>
</div>
<div class="listingblock code_command hotspot file=0">
<div class="content">
<pre><mark>Create the InventoryPactIT class file.</mark>
<code>inventory/src/test/java/io/openliberty/guides/inventory/InventoryPactIT.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>InventoryPactIT.java</p>
</div>
<div class="listingblock code_column hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="line-numbers">  1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers">  2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers">  3</span><span class="comment"> * Copyright (c) 2021 IBM Corporation and others.</span>
<span class="line-numbers">  4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers">  5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers">  6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers">  7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers">  8</span><span class="comment"> *</span>
<span class="line-numbers">  9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers"> 10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers"> 11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers"> 12</span>
<span class="line-numbers"> 13</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.inventory</span>;
<span class="line-numbers"> 14</span>
<span class="line-numbers"> 15</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.consumer.dsl.PactDslJsonArray</span>;
<span class="line-numbers"> 16</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.consumer.dsl.PactDslJsonBody</span>;
<span class="line-numbers"> 17</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.consumer.dsl.PactDslWithProvider</span>;
<span class="line-numbers"> 18</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.consumer.junit.PactProviderRule</span>;
<span class="line-numbers"> 19</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.consumer.junit.PactVerification</span>;
<span class="line-numbers"> 20</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.core.model.RequestResponsePact</span>;
<span class="line-numbers"> 21</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.core.model.annotations.Pact</span>;
<span class="line-numbers"> 22</span>
<span class="line-numbers"> 23</span><span class="keyword">import</span> <span class="include">org.junit.Rule</span>;
<span class="line-numbers"> 24</span><span class="keyword">import</span> <span class="include">org.junit.Test</span>;
<span class="line-numbers"> 25</span>
<span class="line-numbers"> 26</span><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.Assert.assertEquals</span>;
<span class="line-numbers"> 27</span>
<span class="line-numbers"> 28</span><span class="keyword">import</span> <span class="include">java.util.HashMap</span>;
<span class="line-numbers"> 29</span><span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="line-numbers"> 30</span>
<span class="line-numbers"> 31</span><span class="directive">public</span> <span class="type">class</span> <span class="class">InventoryPactIT</span> {
<span class="line-numbers"> 32</span>  <span class="comment">// tag::mockprovider[]</span>
<span class="line-numbers"> 33</span>  <span class="annotation">@Rule</span>
<span class="line-numbers"> 34</span>  <span class="directive">public</span> PactProviderRule mockProvider = <span class="keyword">new</span> PactProviderRule(<span class="string"><span class="delimiter">"</span><span class="content">System</span><span class="delimiter">"</span></span>, <span class="local-variable">this</span>);
<span class="line-numbers"> 35</span>  <span class="comment">// end::mockprovider[]</span>
<span class="line-numbers"> 36</span>
<span class="line-numbers"> 37</span>  <span class="comment">// tag::pact[]</span>
<span class="line-numbers"> 38</span>  <span class="annotation">@Pact</span>(consumer = <span class="string"><span class="delimiter">"</span><span class="content">Inventory</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 39</span>  <span class="comment">// end::pact[]</span>
<span class="line-numbers"> 40</span>  <span class="comment">// tag::builder[]</span>
<span class="line-numbers"> 41</span>  <span class="directive">public</span> RequestResponsePact createPactServer(PactDslWithProvider builder) {
<span class="line-numbers"> 42</span>    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; headers = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;();
<span class="line-numbers"> 43</span>    headers.put(<span class="string"><span class="delimiter">"</span><span class="content">Content-Type</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">application/json</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 44</span>
<span class="line-numbers"> 45</span>    <span class="keyword">return</span> builder
<span class="line-numbers"> 46</span>      <span class="comment">// tag::given[]</span>
<span class="line-numbers"> 47</span>      .given(<span class="string"><span class="delimiter">"</span><span class="content">wlp.server.name is defaultServer</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 48</span>      <span class="comment">// end::given[]</span>
<span class="line-numbers"> 49</span>      .uponReceiving(<span class="string"><span class="delimiter">"</span><span class="content">a request for server name</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 50</span>      .path(<span class="string"><span class="delimiter">"</span><span class="content">/system/properties/key/wlp.server.name</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 51</span>      .method(<span class="string"><span class="delimiter">"</span><span class="content">GET</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 52</span>      .willRespondWith()
<span class="line-numbers"> 53</span>      .headers(headers)
<span class="line-numbers"> 54</span>      .status(<span class="integer">200</span>)
<span class="line-numbers"> 55</span>      .body(<span class="keyword">new</span> PactDslJsonArray().object()
<span class="line-numbers"> 56</span>        .stringValue(<span class="string"><span class="delimiter">"</span><span class="content">wlp.server.name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">defaultServer</span><span class="delimiter">"</span></span>))
<span class="line-numbers"> 57</span>      .toPact();
<span class="line-numbers"> 58</span>  }
<span class="line-numbers"> 59</span>  <span class="comment">// end::builder[]</span>
<span class="line-numbers"> 60</span>
<span class="line-numbers"> 61</span>  <span class="annotation">@Pact</span>(consumer = <span class="string"><span class="delimiter">"</span><span class="content">Inventory</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 62</span>  <span class="directive">public</span> RequestResponsePact createPactEdition(PactDslWithProvider builder) {
<span class="line-numbers"> 63</span>    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; headers = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;();
<span class="line-numbers"> 64</span>    headers.put(<span class="string"><span class="delimiter">"</span><span class="content">Content-Type</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">application/json</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 65</span>
<span class="line-numbers"> 66</span>    <span class="keyword">return</span> builder
<span class="line-numbers"> 67</span>      .given(<span class="string"><span class="delimiter">"</span><span class="content">Default directory is true</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 68</span>      .uponReceiving(<span class="string"><span class="delimiter">"</span><span class="content">a request to check for the default directory</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 69</span>      .path(<span class="string"><span class="delimiter">"</span><span class="content">/system/properties/key/wlp.user.dir.isDefault</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 70</span>      .method(<span class="string"><span class="delimiter">"</span><span class="content">GET</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 71</span>      .willRespondWith()
<span class="line-numbers"> 72</span>      .headers(headers)
<span class="line-numbers"> 73</span>      .status(<span class="integer">200</span>)
<span class="line-numbers"> 74</span>      .body(<span class="keyword">new</span> PactDslJsonArray().object()
<span class="line-numbers"> 75</span>        .stringValue(<span class="string"><span class="delimiter">"</span><span class="content">wlp.user.dir.isDefault</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">true</span><span class="delimiter">"</span></span>))
<span class="line-numbers"> 76</span>      .toPact();
<span class="line-numbers"> 77</span>  }
<span class="line-numbers"> 78</span>
<span class="line-numbers"> 79</span>  <span class="annotation">@Pact</span>(consumer = <span class="string"><span class="delimiter">"</span><span class="content">Inventory</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 80</span>  <span class="directive">public</span> RequestResponsePact createPactVersion(PactDslWithProvider builder) {
<span class="line-numbers"> 81</span>    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; headers = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;();
<span class="line-numbers"> 82</span>    headers.put(<span class="string"><span class="delimiter">"</span><span class="content">Content-Type</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">application/json</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 83</span>
<span class="line-numbers"> 84</span>    <span class="keyword">return</span> builder
<span class="line-numbers"> 85</span>      .given(<span class="string"><span class="delimiter">"</span><span class="content">version is 1.1</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 86</span>      .uponReceiving(<span class="string"><span class="delimiter">"</span><span class="content">a request for the version</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 87</span>      .path(<span class="string"><span class="delimiter">"</span><span class="content">/system/properties/version</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 88</span>      .method(<span class="string"><span class="delimiter">"</span><span class="content">GET</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 89</span>      .willRespondWith()
<span class="line-numbers"> 90</span>      .headers(headers)
<span class="line-numbers"> 91</span>      .status(<span class="integer">200</span>)
<span class="line-numbers"> 92</span>      .body(<span class="keyword">new</span> PactDslJsonBody()
<span class="line-numbers"> 93</span>        .decimalType(<span class="string"><span class="delimiter">"</span><span class="content">system.properties.version</span><span class="delimiter">"</span></span>, <span class="float">1.1</span>))
<span class="line-numbers"> 94</span>      .toPact();
<span class="line-numbers"> 95</span>  }
<span class="line-numbers"> 96</span>
<span class="line-numbers"> 97</span>  <span class="annotation">@Pact</span>(consumer = <span class="string"><span class="delimiter">"</span><span class="content">Inventory</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 98</span>  <span class="directive">public</span> RequestResponsePact createPactInvalid(PactDslWithProvider builder) {
<span class="line-numbers"> 99</span>
<span class="line-numbers">100</span>    <span class="keyword">return</span> builder
<span class="line-numbers">101</span>      .given(<span class="string"><span class="delimiter">"</span><span class="content">invalid property</span><span class="delimiter">"</span></span>)
<span class="line-numbers">102</span>      .uponReceiving(<span class="string"><span class="delimiter">"</span><span class="content">a request with an invalid property</span><span class="delimiter">"</span></span>)
<span class="line-numbers">103</span>      .path(<span class="string"><span class="delimiter">"</span><span class="content">/system/properties/invalidProperty</span><span class="delimiter">"</span></span>)
<span class="line-numbers">104</span>      .method(<span class="string"><span class="delimiter">"</span><span class="content">GET</span><span class="delimiter">"</span></span>)
<span class="line-numbers">105</span>      .willRespondWith()
<span class="line-numbers">106</span>      .status(<span class="integer">404</span>)
<span class="line-numbers">107</span>      .toPact();
<span class="line-numbers">108</span>  }
<span class="line-numbers">109</span>
<span class="line-numbers">110</span>  <span class="annotation">@Test</span>
<span class="line-numbers">111</span>  <span class="comment">// tag::verification[]</span>
<span class="line-numbers">112</span>  <span class="annotation">@PactVerification</span>(value = <span class="string"><span class="delimiter">"</span><span class="content">System</span><span class="delimiter">"</span></span>, fragment = <span class="string"><span class="delimiter">"</span><span class="content">createPactServer</span><span class="delimiter">"</span></span>)
<span class="line-numbers">113</span>  <span class="comment">// end::verification[]</span>
<span class="line-numbers">114</span>  <span class="directive">public</span> <span class="type">void</span> runServerTest() {
<span class="line-numbers">115</span>    <span class="comment">// tag::mockTest[]</span>
<span class="line-numbers">116</span>    <span class="predefined-type">String</span> serverName = <span class="keyword">new</span> Inventory(mockProvider.getUrl()).getServerName();
<span class="line-numbers">117</span>    <span class="comment">// end::mockTest[]</span>
<span class="line-numbers">118</span>    <span class="comment">// tag::unitTest[]</span>
<span class="line-numbers">119</span>    assertEquals(<span class="string"><span class="delimiter">"</span><span class="content">Expected server name does not match</span><span class="delimiter">"</span></span>,
<span class="line-numbers">120</span>      <span class="string"><span class="delimiter">"</span><span class="content">[{</span><span class="char">\"</span><span class="content">wlp.server.name</span><span class="char">\"</span><span class="content">:</span><span class="char">\"</span><span class="content">defaultServer</span><span class="char">\"</span><span class="content">}]</span><span class="delimiter">"</span></span>, serverName);
<span class="line-numbers">121</span>    <span class="comment">// end::unitTest[]</span>
<span class="line-numbers">122</span>  }
<span class="line-numbers">123</span>
<span class="line-numbers">124</span>  <span class="annotation">@Test</span>
<span class="line-numbers">125</span>  <span class="annotation">@PactVerification</span>(value = <span class="string"><span class="delimiter">"</span><span class="content">System</span><span class="delimiter">"</span></span>, fragment = <span class="string"><span class="delimiter">"</span><span class="content">createPactEdition</span><span class="delimiter">"</span></span>)
<span class="line-numbers">126</span>  <span class="directive">public</span> <span class="type">void</span> runEditionTest() {
<span class="line-numbers">127</span>    <span class="predefined-type">String</span> edition = <span class="keyword">new</span> Inventory(mockProvider.getUrl()).getEdition();
<span class="line-numbers">128</span>    assertEquals(<span class="string"><span class="delimiter">"</span><span class="content">Expected edition does not match</span><span class="delimiter">"</span></span>,
<span class="line-numbers">129</span>      <span class="string"><span class="delimiter">"</span><span class="content">[{</span><span class="char">\"</span><span class="content">wlp.user.dir.isDefault</span><span class="char">\"</span><span class="content">:</span><span class="char">\"</span><span class="content">true</span><span class="char">\"</span><span class="content">}]</span><span class="delimiter">"</span></span>, edition);
<span class="line-numbers">130</span>  }
<span class="line-numbers">131</span>
<span class="line-numbers">132</span>  <span class="annotation">@Test</span>
<span class="line-numbers">133</span>  <span class="annotation">@PactVerification</span>(value = <span class="string"><span class="delimiter">"</span><span class="content">System</span><span class="delimiter">"</span></span>, fragment = <span class="string"><span class="delimiter">"</span><span class="content">createPactVersion</span><span class="delimiter">"</span></span>)
<span class="line-numbers">134</span>  <span class="directive">public</span> <span class="type">void</span> runVersionTest() {
<span class="line-numbers">135</span>    <span class="predefined-type">String</span> version = <span class="keyword">new</span> Inventory(mockProvider.getUrl()).getVersion();
<span class="line-numbers">136</span>    assertEquals(<span class="string"><span class="delimiter">"</span><span class="content">Expected version does not match</span><span class="delimiter">"</span></span>,
<span class="line-numbers">137</span>      <span class="string"><span class="delimiter">"</span><span class="content">{</span><span class="char">\"</span><span class="content">system.properties.version</span><span class="char">\"</span><span class="content">:1.1}</span><span class="delimiter">"</span></span>, version);
<span class="line-numbers">138</span>  }
<span class="line-numbers">139</span>
<span class="line-numbers">140</span>  <span class="annotation">@Test</span>
<span class="line-numbers">141</span>  <span class="annotation">@PactVerification</span>(value = <span class="string"><span class="delimiter">"</span><span class="content">System</span><span class="delimiter">"</span></span>, fragment = <span class="string"><span class="delimiter">"</span><span class="content">createPactInvalid</span><span class="delimiter">"</span></span>)
<span class="line-numbers">142</span>  <span class="directive">public</span> <span class="type">void</span> runInvalidTest() {
<span class="line-numbers">143</span>    <span class="predefined-type">String</span> invalid = <span class="keyword">new</span> Inventory(mockProvider.getUrl()).getInvalidProperty();
<span class="line-numbers">144</span>    assertEquals(<span class="string"><span class="delimiter">"</span><span class="content">Expected invalid property response does not match</span><span class="delimiter">"</span></span>,
<span class="line-numbers">145</span>      <span class="string"><span class="delimiter">"</span><span class="delimiter">"</span></span>, invalid);
<span class="line-numbers">146</span>  }
<span class="line-numbers">147</span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>InventoryPactIT</code> class contains a <code class="hotspot=mockprovider file=0">PactProviderRule</code> mock provider that mimics the HTTP responses from the <code>system</code> microservice. The <code class="hotspot=pact file=0">@Pact</code> annotation takes the name of the microservice as a parameter, which makes it easier to differentiate microservices from each other when you have multiple applications.</p>
</div>
<div class="paragraph">
<p>The <code class="hotspot=builder file=0">createPactServer()</code> method defines the minimal expected responsezfor a specific endpoint, which is known as an interaction. For each interaction, the expected request and the response are registered with the mock service by using the <code class="hotspot=verification file=0">@PactVerification</code> annotation.</p>
</div>
<div class="paragraph">
<p>The test sends a real request with the <code class="hotspot=mockTest file=0">getUrl()</code> method of the mock provider. The mock provider compares the actual request with the expected request and confirms whether the comparison is successful. Finally, the <code class="hotspot=unitTest file=0">assertEquals()</code> method confirms that the response is correct.</p>
</div>
<div class="listingblock code_command hotspot file=1">
<div class="content">
<pre><mark>Replace the inventory Maven project file.</mark>
<code>inventory/pom.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>inventory/pom.xml</p>
</div>
<div class="listingblock code_column">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="line-numbers">  1</span><span class="preprocessor">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span>
<span class="line-numbers">  2</span><span class="tag">&lt;project</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://maven.apache.org/POM/4.0.0</span><span class="delimiter">"</span></span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span> <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers">  3</span>
<span class="line-numbers">  4</span>    <span class="tag">&lt;modelVersion&gt;</span>4.0.0<span class="tag">&lt;/modelVersion&gt;</span>
<span class="line-numbers">  5</span>
<span class="line-numbers">  6</span>    <span class="tag">&lt;groupId&gt;</span>io.openliberty.guides<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">  7</span>    <span class="tag">&lt;artifactId&gt;</span>guide-contract-testing-inventory<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">  8</span>    <span class="tag">&lt;version&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers">  9</span>    <span class="tag">&lt;packaging&gt;</span>war<span class="tag">&lt;/packaging&gt;</span>
<span class="line-numbers"> 10</span>
<span class="line-numbers"> 11</span>    <span class="tag">&lt;properties&gt;</span>
<span class="line-numbers"> 12</span>        <span class="tag">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="tag">&lt;/project.build.sourceEncoding&gt;</span>
<span class="line-numbers"> 13</span>        <span class="tag">&lt;project.reporting.outputEncoding&gt;</span>UTF-8<span class="tag">&lt;/project.reporting.outputEncoding&gt;</span>
<span class="line-numbers"> 14</span>        <span class="tag">&lt;maven.compiler.source&gt;</span>11<span class="tag">&lt;/maven.compiler.source&gt;</span>
<span class="line-numbers"> 15</span>        <span class="tag">&lt;maven.compiler.target&gt;</span>11<span class="tag">&lt;/maven.compiler.target&gt;</span>
<span class="line-numbers"> 16</span>        <span class="comment">&lt;!-- Liberty configuration --&gt;</span>
<span class="line-numbers"> 17</span>        <span class="tag">&lt;liberty.var.default.http.port&gt;</span>9081<span class="tag">&lt;/liberty.var.default.http.port&gt;</span>
<span class="line-numbers"> 18</span>        <span class="tag">&lt;liberty.var.default.https.port&gt;</span>9443<span class="tag">&lt;/liberty.var.default.https.port&gt;</span>
<span class="line-numbers"> 19</span>    <span class="tag">&lt;/properties&gt;</span>
<span class="line-numbers"> 20</span>
<span class="line-numbers"> 21</span>    <span class="tag">&lt;dependencies&gt;</span>
<span class="line-numbers"> 22</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 23</span>            <span class="tag">&lt;groupId&gt;</span>org.eclipse.microprofile<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 24</span>            <span class="tag">&lt;artifactId&gt;</span>microprofile<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 25</span>            <span class="tag">&lt;version&gt;</span>6.0<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 26</span>            <span class="tag">&lt;type&gt;</span>pom<span class="tag">&lt;/type&gt;</span>
<span class="line-numbers"> 27</span>            <span class="tag">&lt;scope&gt;</span>provided<span class="tag">&lt;/scope&gt;</span>
<span class="line-numbers"> 28</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 29</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 30</span>            <span class="tag">&lt;groupId&gt;</span>jakarta.platform<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 31</span>            <span class="tag">&lt;artifactId&gt;</span>jakarta.jakartaee-api<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 32</span>            <span class="tag">&lt;version&gt;</span>10.0.0<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 33</span>            <span class="tag">&lt;scope&gt;</span>provided<span class="tag">&lt;/scope&gt;</span>
<span class="line-numbers"> 34</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 35</span>        <span class="comment">&lt;!-- For tests --&gt;</span>
<span class="line-numbers"> 36</span>        <span class="comment">&lt;!-- tag::pactJunit[] --&gt;</span>
<span class="line-numbers"> 37</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 38</span>            <span class="tag">&lt;groupId&gt;</span>au.com.dius<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 39</span>            <span class="tag">&lt;artifactId&gt;</span>pact-jvm-consumer-junit<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 40</span>            <span class="tag">&lt;version&gt;</span>4.0.10<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 41</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 42</span>        <span class="comment">&lt;!-- end::pactJunit[] --&gt;</span>
<span class="line-numbers"> 43</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 44</span>            <span class="tag">&lt;groupId&gt;</span>org.slf4j<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 45</span>            <span class="tag">&lt;artifactId&gt;</span>slf4j-simple<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 46</span>            <span class="tag">&lt;version&gt;</span>2.0.7<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 47</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 48</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers"> 49</span>            <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 50</span>            <span class="tag">&lt;artifactId&gt;</span>resteasy-client<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 51</span>            <span class="tag">&lt;version&gt;</span>6.2.3.Final<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 52</span>            <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="line-numbers"> 53</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers"> 54</span>    <span class="tag">&lt;/dependencies&gt;</span>
<span class="line-numbers"> 55</span>
<span class="line-numbers"> 56</span>    <span class="tag">&lt;build&gt;</span>
<span class="line-numbers"> 57</span>        <span class="tag">&lt;finalName&gt;</span>${project.artifactId}<span class="tag">&lt;/finalName&gt;</span>
<span class="line-numbers"> 58</span>        <span class="tag">&lt;plugins&gt;</span>
<span class="line-numbers"> 59</span>            <span class="comment">&lt;!-- tag::pactPlugin[] --&gt;</span>
<span class="line-numbers"> 60</span>            <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers"> 61</span>                <span class="tag">&lt;groupId&gt;</span>au.com.dius.pact.provider<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 62</span>                <span class="tag">&lt;artifactId&gt;</span>maven<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 63</span>                <span class="tag">&lt;version&gt;</span>4.5.6<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 64</span>                <span class="tag">&lt;configuration&gt;</span>
<span class="line-numbers"> 65</span>                    <span class="tag">&lt;serviceProviders&gt;</span>
<span class="line-numbers"> 66</span>                        // tag::serviceProvider[]
<span class="line-numbers"> 67</span>                        <span class="tag">&lt;serviceProvider&gt;</span>
<span class="line-numbers"> 68</span>                            <span class="tag">&lt;name&gt;</span>System<span class="tag">&lt;/name&gt;</span>
<span class="line-numbers"> 69</span>                            <span class="tag">&lt;protocol&gt;</span>http<span class="tag">&lt;/protocol&gt;</span>
<span class="line-numbers"> 70</span>                            <span class="tag">&lt;host&gt;</span>localhost<span class="tag">&lt;/host&gt;</span>
<span class="line-numbers"> 71</span>                            <span class="tag">&lt;port&gt;</span>9080<span class="tag">&lt;/port&gt;</span>
<span class="line-numbers"> 72</span>                            <span class="tag">&lt;path&gt;</span>/<span class="tag">&lt;/path&gt;</span>
<span class="line-numbers"> 73</span>                            // tag::pactDirectory[]
<span class="line-numbers"> 74</span>                            <span class="tag">&lt;pactFileDirectory&gt;</span>target/pacts<span class="tag">&lt;/pactFileDirectory&gt;</span>
<span class="line-numbers"> 75</span>                            // end::pactDirectory[]
<span class="line-numbers"> 76</span>                        <span class="tag">&lt;/serviceProvider&gt;</span>
<span class="line-numbers"> 77</span>                        // end::serviceProvider[]
<span class="line-numbers"> 78</span>                    <span class="tag">&lt;/serviceProviders&gt;</span>
<span class="line-numbers"> 79</span>                    <span class="tag">&lt;projectVersion&gt;</span>${project.version}<span class="tag">&lt;/projectVersion&gt;</span>
<span class="line-numbers"> 80</span>                    <span class="tag">&lt;skipPactPublish&gt;</span>false<span class="tag">&lt;/skipPactPublish&gt;</span>
<span class="line-numbers"> 81</span>                    <span class="tag">&lt;pactBrokerUrl&gt;</span>http://localhost:9292<span class="tag">&lt;/pactBrokerUrl&gt;</span>
<span class="line-numbers"> 82</span>                    <span class="tag">&lt;tags&gt;</span>
<span class="line-numbers"> 83</span>                        <span class="tag">&lt;tag&gt;</span>open-liberty-pact<span class="tag">&lt;/tag&gt;</span>
<span class="line-numbers"> 84</span>                    <span class="tag">&lt;/tags&gt;</span>
<span class="line-numbers"> 85</span>                <span class="tag">&lt;/configuration&gt;</span>
<span class="line-numbers"> 86</span>            <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers"> 87</span>            <span class="comment">&lt;!-- end::pactPlugin[] --&gt;</span>
<span class="line-numbers"> 88</span>            <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers"> 89</span>                <span class="tag">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 90</span>                <span class="tag">&lt;artifactId&gt;</span>maven-war-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 91</span>                <span class="tag">&lt;version&gt;</span>3.3.2<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 92</span>            <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers"> 93</span>            <span class="comment">&lt;!-- Plugin to run functional tests --&gt;</span>
<span class="line-numbers"> 94</span>            <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers"> 95</span>                <span class="tag">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 96</span>                <span class="tag">&lt;artifactId&gt;</span>maven-failsafe-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 97</span>                <span class="tag">&lt;version&gt;</span>3.0.0<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers"> 98</span>                <span class="tag">&lt;configuration&gt;</span>
<span class="line-numbers"> 99</span>                    <span class="tag">&lt;systemPropertyVariables&gt;</span>
<span class="line-numbers">100</span>                        <span class="tag">&lt;http.port&gt;</span>${liberty.var.default.http.port}<span class="tag">&lt;/http.port&gt;</span>
<span class="line-numbers">101</span>                    <span class="tag">&lt;/systemPropertyVariables&gt;</span>
<span class="line-numbers">102</span>                <span class="tag">&lt;/configuration&gt;</span>
<span class="line-numbers">103</span>            <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers">104</span>            <span class="comment">&lt;!-- Enable liberty-maven plugin --&gt;</span>
<span class="line-numbers">105</span>            <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers">106</span>                <span class="tag">&lt;groupId&gt;</span>io.openliberty.tools<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">107</span>                <span class="tag">&lt;artifactId&gt;</span>liberty-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">108</span>                <span class="tag">&lt;version&gt;</span>3.8.2<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers">109</span>            <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers">110</span>        <span class="tag">&lt;/plugins&gt;</span>
<span class="line-numbers">111</span>    <span class="tag">&lt;/build&gt;</span>
<span class="line-numbers">112</span><span class="tag">&lt;/project&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The Pact framework provides a <code class="hotspot=pactPlugin file=1">Maven</code> plugin that can be added to the build section of the <code>pom.xml</code> file. The <code class="hotspot=serviceProvider file=1">serviceProvider</code> element defines the endpoint URL for the <code>system</code> microservice and the <code class="hotspot=pactDirectory file=1">pactFileDirectory</code> directory where you want to store the pact file. The <code class="hotspot=pactJunit file=1">pact-jvm-consumer-junit</code> dependency provides the base test class that you can use with JUnit to build unit tests.</p>
</div>
<div class="paragraph">
<p>After you create the <code>InventoryPactIT.java</code> class and replace the <code>pom.xml</code> file, Open Liberty automatically reloads its configuration.</p>
</div>
<div class="paragraph">
<p>The contract between the <code>inventory</code> and <code>system</code> microservices is known as a pact. Each pact is a collection of interactions. In this guide, those interactions are defined in the <code>InventoryPactIT</code> class.</p>
</div>
<div class="paragraph">
<p>Press the <code>enter/return</code> key to run the tests and generate the pact file from the command-line session where you started the <code>inventory</code> microservice.</p>
</div>
<div class="paragraph">
<p>When completed, you’ll see a similar output to the following example:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre class="CodeRay highlight"><code>[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running io.openliberty.guides.inventory.InventoryPactIT
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.631 s - in io.openliberty.guides.inventory.InventoryPactIT
[INFO]
[INFO] Results:
[INFO]
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you integrate the Pact framework in a CI/CD build pipeline, you can use the <code>mvn failsafe:integration-test</code> goal to generate the pact file. The Maven failsafe plug-in provides a lifecycle phase for running integration tests that run after unit tests. By default, it looks for classes that are suffixed with <code>IT</code>, which stands for Integration Test. You can refer to the <a href="https://maven.apache.org/surefire/maven-failsafe-plugin/" target="_blank" rel="noopener noreferrer">Maven failsafe plug-in documentation</a> for more information.</p>
</div>
<div class="paragraph">
<p>The generated pact file is named <code>Inventory-System.json</code> and is located in the <code>inventory/target/pacts</code> directory. The pact file contains the defined interactions in JSON format:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>{
...
"interactions": [
{
      "description": "a request for server name",
      "request": {
        "method": "GET",
        "path": "/system/properties/key/wlp.server.name"
      },
      "response": {
        "status": 200,
        "headers": {
          "Content-Type": "application/json"
        },
        "body": [
          {
            "wlp.server.name": "defaultServer"
          }
        ]
      },
      "providerStates": [
        {
          "name": "wlp.server.name is defaultServer"
        }
      ]
    }
...
  ]
}</pre>
</div>
</div>
<div class="paragraph">
<p>Now, navigate to the <code>start/inventory</code> directory again.</p>
</div>
<div class="paragraph">
<p>Publish the generated pact file to the Pact Broker by running the following command:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn pact:publish</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the file is published, you’ll see a similar output to the following example:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre class="CodeRay highlight"><code>--- maven:4.1.21:publish (default-cli) @ inventory ---
Publishing 'Inventory-System.json' with tags 'open-liberty-pact' ... OK</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="verifying-the-pact-in-the-pact-broker">Verifying the pact in the Pact Broker</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Refresh the Pact Broker webpage at the <a href="http://localhost:9292/" class="notranslate bare" target="_blank" rel="noopener noreferrer">http://localhost:9292/</a> URL to verify that a new entry exists. The last verified column doesn’t show a timestamp because the <code>system</code> microservice hasn’t verified the pact yet.</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="/img/guide/contract-testing/pact-broker-webpage-refresh.png" alt="Pact Broker webpage for new entry">
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="paragraph">
<p>You can see detailed insights about each interaction by going to the <a href="http://localhost:9292/pacts/provider/System/consumer/Inventory/latest" class="notranslate bare" target="_blank" rel="noopener noreferrer">http://localhost:9292/pacts/provider/System/consumer/Inventory/latest</a> URL, as shown in the following image:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="/img/guide/contract-testing/pact-broker-interactions.png" alt="Pact Broker webpage for Interactions">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="implementing-pact-testing-in-the-system-service">Implementing pact testing in the system service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Open another command-line session and navigate to the <code>start/system</code> directory.</p>
</div>
<div class="paragraph">
<p>Start Open Liberty in dev mode for the <code>system</code> microservice:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn liberty:dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>After you see the following message, your Liberty instance is ready in dev mode:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre>**************************************************************
*    Liberty is running in dev mode.</pre>
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="paragraph">
<p>Open another command-line session and navigate back to the <code>start</code> directory to continue.</p>
</div>
<div class="listingblock code_command hotspot file=0">
<div class="content">
<pre><mark>Create the SystemBrokerIT class file.</mark>
<code>system/src/test/java/it/io/openliberty/guides/system/SystemBrokerIT.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>SystemBrokerIT.java</p>
</div>
<div class="listingblock code_column hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="line-numbers"> 1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers"> 2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers"> 3</span><span class="comment"> * Copyright (c) 2021 IBM Corporation and others.</span>
<span class="line-numbers"> 4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers"> 5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers"> 6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers"> 7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers"> 8</span><span class="comment"> *</span>
<span class="line-numbers"> 9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers">10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers">11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers">12</span><span class="keyword">package</span> <span class="namespace">it.io.openliberty.guides.system</span>;
<span class="line-numbers">13</span>
<span class="line-numbers">14</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.provider.junit5.HttpTestTarget</span>;
<span class="line-numbers">15</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.provider.junit5.PactVerificationContext</span>;
<span class="line-numbers">16</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.provider.junit5.PactVerificationInvocationContextProvider</span>;
<span class="line-numbers">17</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.provider.junitsupport.Consumer</span>;
<span class="line-numbers">18</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.provider.junitsupport.Provider</span>;
<span class="line-numbers">19</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.provider.junitsupport.State</span>;
<span class="line-numbers">20</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.provider.junitsupport.loader.PactBroker</span>;
<span class="line-numbers">21</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.provider.junitsupport.loader.VersionSelector</span>;
<span class="line-numbers">22</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.BeforeAll</span>;
<span class="line-numbers">23</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.BeforeEach</span>;
<span class="line-numbers">24</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.TestTemplate</span>;
<span class="line-numbers">25</span><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.extension.ExtendWith</span>;
<span class="line-numbers">26</span>
<span class="line-numbers">27</span><span class="annotation">@Provider</span>(<span class="string"><span class="delimiter">"</span><span class="content">System</span><span class="delimiter">"</span></span>)
<span class="line-numbers">28</span><span class="annotation">@Consumer</span>(<span class="string"><span class="delimiter">"</span><span class="content">Inventory</span><span class="delimiter">"</span></span>)
<span class="line-numbers">29</span><span class="comment">// tag::connectionInfo[]</span>
<span class="line-numbers">30</span><span class="annotation">@PactBroker</span>(
<span class="line-numbers">31</span>  host = <span class="string"><span class="delimiter">"</span><span class="content">localhost</span><span class="delimiter">"</span></span>,
<span class="line-numbers">32</span>  port = <span class="string"><span class="delimiter">"</span><span class="content">9292</span><span class="delimiter">"</span></span>,
<span class="line-numbers">33</span>  consumerVersionSelectors = {
<span class="line-numbers">34</span>    <span class="annotation">@VersionSelector</span>(tag = <span class="string"><span class="delimiter">"</span><span class="content">open-liberty-pact</span><span class="delimiter">"</span></span>)
<span class="line-numbers">35</span>  })
<span class="line-numbers">36</span><span class="comment">// end::connectionInfo[]</span>
<span class="line-numbers">37</span><span class="directive">public</span> <span class="type">class</span> <span class="class">SystemBrokerIT</span> {
<span class="line-numbers">38</span>  <span class="comment">// tag::invocation[]</span>
<span class="line-numbers">39</span>  <span class="annotation">@TestTemplate</span>
<span class="line-numbers">40</span>  <span class="annotation">@ExtendWith</span>(PactVerificationInvocationContextProvider.class)
<span class="line-numbers">41</span>  <span class="comment">// tag::context[]</span>
<span class="line-numbers">42</span>  <span class="type">void</span> pactVerificationTestTemplate(PactVerificationContext context) {
<span class="line-numbers">43</span>    context.verifyInteraction();
<span class="line-numbers">44</span>  }
<span class="line-numbers">45</span>  <span class="comment">// end::context[]</span>
<span class="line-numbers">46</span>  <span class="comment">// end::invocation[]</span>
<span class="line-numbers">47</span>
<span class="line-numbers">48</span>  <span class="annotation">@BeforeAll</span>
<span class="line-numbers">49</span>  <span class="comment">// tag::publish[]</span>
<span class="line-numbers">50</span>  <span class="directive">static</span> <span class="type">void</span> enablePublishingPact() {
<span class="line-numbers">51</span>    <span class="predefined-type">System</span>.setProperty(<span class="string"><span class="delimiter">"</span><span class="content">pact.verifier.publishResults</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">true</span><span class="delimiter">"</span></span>);
<span class="line-numbers">52</span>  }
<span class="line-numbers">53</span>  <span class="comment">// end::publish[]</span>
<span class="line-numbers">54</span>
<span class="line-numbers">55</span>  <span class="annotation">@BeforeEach</span>
<span class="line-numbers">56</span>  <span class="type">void</span> before(PactVerificationContext context) {
<span class="line-numbers">57</span>    <span class="type">int</span> port = <span class="predefined-type">Integer</span>.parseInt(<span class="predefined-type">System</span>.getProperty(<span class="string"><span class="delimiter">"</span><span class="content">http.port</span><span class="delimiter">"</span></span>));
<span class="line-numbers">58</span>    context.setTarget(<span class="keyword">new</span> HttpTestTarget(<span class="string"><span class="delimiter">"</span><span class="content">localhost</span><span class="delimiter">"</span></span>, port));
<span class="line-numbers">59</span>  }
<span class="line-numbers">60</span>
<span class="line-numbers">61</span>  <span class="comment">// tag::state[]</span>
<span class="line-numbers">62</span>  <span class="annotation">@State</span>(<span class="string"><span class="delimiter">"</span><span class="content">wlp.server.name is defaultServer</span><span class="delimiter">"</span></span>)
<span class="line-numbers">63</span>  <span class="comment">// end::state[]</span>
<span class="line-numbers">64</span>  <span class="directive">public</span> <span class="type">void</span> validServerName() {
<span class="line-numbers">65</span>  }
<span class="line-numbers">66</span>
<span class="line-numbers">67</span>  <span class="annotation">@State</span>(<span class="string"><span class="delimiter">"</span><span class="content">Default directory is true</span><span class="delimiter">"</span></span>)
<span class="line-numbers">68</span>  <span class="directive">public</span> <span class="type">void</span> validEdition() {
<span class="line-numbers">69</span>  }
<span class="line-numbers">70</span>
<span class="line-numbers">71</span>  <span class="annotation">@State</span>(<span class="string"><span class="delimiter">"</span><span class="content">version is 1.1</span><span class="delimiter">"</span></span>)
<span class="line-numbers">72</span>  <span class="directive">public</span> <span class="type">void</span> validVersion() {
<span class="line-numbers">73</span>  }
<span class="line-numbers">74</span>
<span class="line-numbers">75</span>  <span class="annotation">@State</span>(<span class="string"><span class="delimiter">"</span><span class="content">invalid property</span><span class="delimiter">"</span></span>)
<span class="line-numbers">76</span>  <span class="directive">public</span> <span class="type">void</span> invalidProperty() {
<span class="line-numbers">77</span>  }
<span class="line-numbers">78</span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>InventoryPactIT.java</p>
</div>
<div class="listingblock code_column hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="line-numbers">  1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers">  2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers">  3</span><span class="comment"> * Copyright (c) 2021 IBM Corporation and others.</span>
<span class="line-numbers">  4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers">  5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers">  6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers">  7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers">  8</span><span class="comment"> *</span>
<span class="line-numbers">  9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers"> 10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers"> 11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers"> 12</span>
<span class="line-numbers"> 13</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.inventory</span>;
<span class="line-numbers"> 14</span>
<span class="line-numbers"> 15</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.consumer.dsl.PactDslJsonArray</span>;
<span class="line-numbers"> 16</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.consumer.dsl.PactDslJsonBody</span>;
<span class="line-numbers"> 17</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.consumer.dsl.PactDslWithProvider</span>;
<span class="line-numbers"> 18</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.consumer.junit.PactProviderRule</span>;
<span class="line-numbers"> 19</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.consumer.junit.PactVerification</span>;
<span class="line-numbers"> 20</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.core.model.RequestResponsePact</span>;
<span class="line-numbers"> 21</span><span class="keyword">import</span> <span class="include">au.com.dius.pact.core.model.annotations.Pact</span>;
<span class="line-numbers"> 22</span>
<span class="line-numbers"> 23</span><span class="keyword">import</span> <span class="include">org.junit.Rule</span>;
<span class="line-numbers"> 24</span><span class="keyword">import</span> <span class="include">org.junit.Test</span>;
<span class="line-numbers"> 25</span>
<span class="line-numbers"> 26</span><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.Assert.assertEquals</span>;
<span class="line-numbers"> 27</span>
<span class="line-numbers"> 28</span><span class="keyword">import</span> <span class="include">java.util.HashMap</span>;
<span class="line-numbers"> 29</span><span class="keyword">import</span> <span class="include">java.util.Map</span>;
<span class="line-numbers"> 30</span>
<span class="line-numbers"> 31</span><span class="directive">public</span> <span class="type">class</span> <span class="class">InventoryPactIT</span> {
<span class="line-numbers"> 32</span>  <span class="comment">// tag::mockprovider[]</span>
<span class="line-numbers"> 33</span>  <span class="annotation">@Rule</span>
<span class="line-numbers"> 34</span>  <span class="directive">public</span> PactProviderRule mockProvider = <span class="keyword">new</span> PactProviderRule(<span class="string"><span class="delimiter">"</span><span class="content">System</span><span class="delimiter">"</span></span>, <span class="local-variable">this</span>);
<span class="line-numbers"> 35</span>  <span class="comment">// end::mockprovider[]</span>
<span class="line-numbers"> 36</span>
<span class="line-numbers"> 37</span>  <span class="comment">// tag::pact[]</span>
<span class="line-numbers"> 38</span>  <span class="annotation">@Pact</span>(consumer = <span class="string"><span class="delimiter">"</span><span class="content">Inventory</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 39</span>  <span class="comment">// end::pact[]</span>
<span class="line-numbers"> 40</span>  <span class="comment">// tag::builder[]</span>
<span class="line-numbers"> 41</span>  <span class="directive">public</span> RequestResponsePact createPactServer(PactDslWithProvider builder) {
<span class="line-numbers"> 42</span>    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; headers = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;();
<span class="line-numbers"> 43</span>    headers.put(<span class="string"><span class="delimiter">"</span><span class="content">Content-Type</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">application/json</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 44</span>
<span class="line-numbers"> 45</span>    <span class="keyword">return</span> builder
<span class="line-numbers"> 46</span>      <span class="comment">// tag::given[]</span>
<span class="line-numbers"> 47</span>      .given(<span class="string"><span class="delimiter">"</span><span class="content">wlp.server.name is defaultServer</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 48</span>      <span class="comment">// end::given[]</span>
<span class="line-numbers"> 49</span>      .uponReceiving(<span class="string"><span class="delimiter">"</span><span class="content">a request for server name</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 50</span>      .path(<span class="string"><span class="delimiter">"</span><span class="content">/system/properties/key/wlp.server.name</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 51</span>      .method(<span class="string"><span class="delimiter">"</span><span class="content">GET</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 52</span>      .willRespondWith()
<span class="line-numbers"> 53</span>      .headers(headers)
<span class="line-numbers"> 54</span>      .status(<span class="integer">200</span>)
<span class="line-numbers"> 55</span>      .body(<span class="keyword">new</span> PactDslJsonArray().object()
<span class="line-numbers"> 56</span>        .stringValue(<span class="string"><span class="delimiter">"</span><span class="content">wlp.server.name</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">defaultServer</span><span class="delimiter">"</span></span>))
<span class="line-numbers"> 57</span>      .toPact();
<span class="line-numbers"> 58</span>  }
<span class="line-numbers"> 59</span>  <span class="comment">// end::builder[]</span>
<span class="line-numbers"> 60</span>
<span class="line-numbers"> 61</span>  <span class="annotation">@Pact</span>(consumer = <span class="string"><span class="delimiter">"</span><span class="content">Inventory</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 62</span>  <span class="directive">public</span> RequestResponsePact createPactEdition(PactDslWithProvider builder) {
<span class="line-numbers"> 63</span>    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; headers = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;();
<span class="line-numbers"> 64</span>    headers.put(<span class="string"><span class="delimiter">"</span><span class="content">Content-Type</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">application/json</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 65</span>
<span class="line-numbers"> 66</span>    <span class="keyword">return</span> builder
<span class="line-numbers"> 67</span>      .given(<span class="string"><span class="delimiter">"</span><span class="content">Default directory is true</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 68</span>      .uponReceiving(<span class="string"><span class="delimiter">"</span><span class="content">a request to check for the default directory</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 69</span>      .path(<span class="string"><span class="delimiter">"</span><span class="content">/system/properties/key/wlp.user.dir.isDefault</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 70</span>      .method(<span class="string"><span class="delimiter">"</span><span class="content">GET</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 71</span>      .willRespondWith()
<span class="line-numbers"> 72</span>      .headers(headers)
<span class="line-numbers"> 73</span>      .status(<span class="integer">200</span>)
<span class="line-numbers"> 74</span>      .body(<span class="keyword">new</span> PactDslJsonArray().object()
<span class="line-numbers"> 75</span>        .stringValue(<span class="string"><span class="delimiter">"</span><span class="content">wlp.user.dir.isDefault</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">true</span><span class="delimiter">"</span></span>))
<span class="line-numbers"> 76</span>      .toPact();
<span class="line-numbers"> 77</span>  }
<span class="line-numbers"> 78</span>
<span class="line-numbers"> 79</span>  <span class="annotation">@Pact</span>(consumer = <span class="string"><span class="delimiter">"</span><span class="content">Inventory</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 80</span>  <span class="directive">public</span> RequestResponsePact createPactVersion(PactDslWithProvider builder) {
<span class="line-numbers"> 81</span>    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; headers = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;();
<span class="line-numbers"> 82</span>    headers.put(<span class="string"><span class="delimiter">"</span><span class="content">Content-Type</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">application/json</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 83</span>
<span class="line-numbers"> 84</span>    <span class="keyword">return</span> builder
<span class="line-numbers"> 85</span>      .given(<span class="string"><span class="delimiter">"</span><span class="content">version is 1.1</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 86</span>      .uponReceiving(<span class="string"><span class="delimiter">"</span><span class="content">a request for the version</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 87</span>      .path(<span class="string"><span class="delimiter">"</span><span class="content">/system/properties/version</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 88</span>      .method(<span class="string"><span class="delimiter">"</span><span class="content">GET</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 89</span>      .willRespondWith()
<span class="line-numbers"> 90</span>      .headers(headers)
<span class="line-numbers"> 91</span>      .status(<span class="integer">200</span>)
<span class="line-numbers"> 92</span>      .body(<span class="keyword">new</span> PactDslJsonBody()
<span class="line-numbers"> 93</span>        .decimalType(<span class="string"><span class="delimiter">"</span><span class="content">system.properties.version</span><span class="delimiter">"</span></span>, <span class="float">1.1</span>))
<span class="line-numbers"> 94</span>      .toPact();
<span class="line-numbers"> 95</span>  }
<span class="line-numbers"> 96</span>
<span class="line-numbers"> 97</span>  <span class="annotation">@Pact</span>(consumer = <span class="string"><span class="delimiter">"</span><span class="content">Inventory</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 98</span>  <span class="directive">public</span> RequestResponsePact createPactInvalid(PactDslWithProvider builder) {
<span class="line-numbers"> 99</span>
<span class="line-numbers">100</span>    <span class="keyword">return</span> builder
<span class="line-numbers">101</span>      .given(<span class="string"><span class="delimiter">"</span><span class="content">invalid property</span><span class="delimiter">"</span></span>)
<span class="line-numbers">102</span>      .uponReceiving(<span class="string"><span class="delimiter">"</span><span class="content">a request with an invalid property</span><span class="delimiter">"</span></span>)
<span class="line-numbers">103</span>      .path(<span class="string"><span class="delimiter">"</span><span class="content">/system/properties/invalidProperty</span><span class="delimiter">"</span></span>)
<span class="line-numbers">104</span>      .method(<span class="string"><span class="delimiter">"</span><span class="content">GET</span><span class="delimiter">"</span></span>)
<span class="line-numbers">105</span>      .willRespondWith()
<span class="line-numbers">106</span>      .status(<span class="integer">404</span>)
<span class="line-numbers">107</span>      .toPact();
<span class="line-numbers">108</span>  }
<span class="line-numbers">109</span>
<span class="line-numbers">110</span>  <span class="annotation">@Test</span>
<span class="line-numbers">111</span>  <span class="comment">// tag::verification[]</span>
<span class="line-numbers">112</span>  <span class="annotation">@PactVerification</span>(value = <span class="string"><span class="delimiter">"</span><span class="content">System</span><span class="delimiter">"</span></span>, fragment = <span class="string"><span class="delimiter">"</span><span class="content">createPactServer</span><span class="delimiter">"</span></span>)
<span class="line-numbers">113</span>  <span class="comment">// end::verification[]</span>
<span class="line-numbers">114</span>  <span class="directive">public</span> <span class="type">void</span> runServerTest() {
<span class="line-numbers">115</span>    <span class="comment">// tag::mockTest[]</span>
<span class="line-numbers">116</span>    <span class="predefined-type">String</span> serverName = <span class="keyword">new</span> Inventory(mockProvider.getUrl()).getServerName();
<span class="line-numbers">117</span>    <span class="comment">// end::mockTest[]</span>
<span class="line-numbers">118</span>    <span class="comment">// tag::unitTest[]</span>
<span class="line-numbers">119</span>    assertEquals(<span class="string"><span class="delimiter">"</span><span class="content">Expected server name does not match</span><span class="delimiter">"</span></span>,
<span class="line-numbers">120</span>      <span class="string"><span class="delimiter">"</span><span class="content">[{</span><span class="char">\"</span><span class="content">wlp.server.name</span><span class="char">\"</span><span class="content">:</span><span class="char">\"</span><span class="content">defaultServer</span><span class="char">\"</span><span class="content">}]</span><span class="delimiter">"</span></span>, serverName);
<span class="line-numbers">121</span>    <span class="comment">// end::unitTest[]</span>
<span class="line-numbers">122</span>  }
<span class="line-numbers">123</span>
<span class="line-numbers">124</span>  <span class="annotation">@Test</span>
<span class="line-numbers">125</span>  <span class="annotation">@PactVerification</span>(value = <span class="string"><span class="delimiter">"</span><span class="content">System</span><span class="delimiter">"</span></span>, fragment = <span class="string"><span class="delimiter">"</span><span class="content">createPactEdition</span><span class="delimiter">"</span></span>)
<span class="line-numbers">126</span>  <span class="directive">public</span> <span class="type">void</span> runEditionTest() {
<span class="line-numbers">127</span>    <span class="predefined-type">String</span> edition = <span class="keyword">new</span> Inventory(mockProvider.getUrl()).getEdition();
<span class="line-numbers">128</span>    assertEquals(<span class="string"><span class="delimiter">"</span><span class="content">Expected edition does not match</span><span class="delimiter">"</span></span>,
<span class="line-numbers">129</span>      <span class="string"><span class="delimiter">"</span><span class="content">[{</span><span class="char">\"</span><span class="content">wlp.user.dir.isDefault</span><span class="char">\"</span><span class="content">:</span><span class="char">\"</span><span class="content">true</span><span class="char">\"</span><span class="content">}]</span><span class="delimiter">"</span></span>, edition);
<span class="line-numbers">130</span>  }
<span class="line-numbers">131</span>
<span class="line-numbers">132</span>  <span class="annotation">@Test</span>
<span class="line-numbers">133</span>  <span class="annotation">@PactVerification</span>(value = <span class="string"><span class="delimiter">"</span><span class="content">System</span><span class="delimiter">"</span></span>, fragment = <span class="string"><span class="delimiter">"</span><span class="content">createPactVersion</span><span class="delimiter">"</span></span>)
<span class="line-numbers">134</span>  <span class="directive">public</span> <span class="type">void</span> runVersionTest() {
<span class="line-numbers">135</span>    <span class="predefined-type">String</span> version = <span class="keyword">new</span> Inventory(mockProvider.getUrl()).getVersion();
<span class="line-numbers">136</span>    assertEquals(<span class="string"><span class="delimiter">"</span><span class="content">Expected version does not match</span><span class="delimiter">"</span></span>,
<span class="line-numbers">137</span>      <span class="string"><span class="delimiter">"</span><span class="content">{</span><span class="char">\"</span><span class="content">system.properties.version</span><span class="char">\"</span><span class="content">:1.1}</span><span class="delimiter">"</span></span>, version);
<span class="line-numbers">138</span>  }
<span class="line-numbers">139</span>
<span class="line-numbers">140</span>  <span class="annotation">@Test</span>
<span class="line-numbers">141</span>  <span class="annotation">@PactVerification</span>(value = <span class="string"><span class="delimiter">"</span><span class="content">System</span><span class="delimiter">"</span></span>, fragment = <span class="string"><span class="delimiter">"</span><span class="content">createPactInvalid</span><span class="delimiter">"</span></span>)
<span class="line-numbers">142</span>  <span class="directive">public</span> <span class="type">void</span> runInvalidTest() {
<span class="line-numbers">143</span>    <span class="predefined-type">String</span> invalid = <span class="keyword">new</span> Inventory(mockProvider.getUrl()).getInvalidProperty();
<span class="line-numbers">144</span>    assertEquals(<span class="string"><span class="delimiter">"</span><span class="content">Expected invalid property response does not match</span><span class="delimiter">"</span></span>,
<span class="line-numbers">145</span>      <span class="string"><span class="delimiter">"</span><span class="delimiter">"</span></span>, invalid);
<span class="line-numbers">146</span>  }
<span class="line-numbers">147</span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The connection information for the Pact Broker is provided with the <code class="hotspot=connectionInfo file=0">@PactBroker</code> annotation. The dependency also provides a JUnit5 Invocation Context Provider with the <code class="hotspot=invocation file=0">pactVerificationTestTemplate()</code> method to generate a test for each of the interactions.</p>
</div>
<div class="paragraph">
<p>The <code class="hotspot=publish file=0">pact.verifier.publishResults</code> property is set to <code>true</code> so that the results are sent to the Pact Broker after the tests are completed.</p>
</div>
<div class="paragraph">
<p>The test target is defined in the <code class="hotspot=context file=0">PactVerificationContext</code> context to point to the running endpoint of the <code>system</code> microservice.</p>
</div>
<div class="paragraph">
<p>The <code class="hotspot=state file=0">@State</code> annotation must match the <code class="hotspot=given file=1">given()</code> parameter that was provided in the <code>inventory</code> test class so that Pact can identify which test case to run against which endpoint.</p>
</div>
<div class="listingblock code_command hotspot file=1">
<div class="content">
<pre><mark>Replace the system Maven project file.</mark>
<code>system/pom.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>system/pom.xml</p>
</div>
<div class="listingblock code_column hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="line-numbers"> 1</span><span class="preprocessor">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span>
<span class="line-numbers"> 2</span><span class="tag">&lt;project</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://maven.apache.org/POM/4.0.0</span><span class="delimiter">"</span></span>
<span class="line-numbers"> 3</span>         <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
<span class="line-numbers"> 4</span>         <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers"> 5</span>    <span class="tag">&lt;modelVersion&gt;</span>4.0.0<span class="tag">&lt;/modelVersion&gt;</span>
<span class="line-numbers"> 6</span>
<span class="line-numbers"> 7</span>    <span class="tag">&lt;groupId&gt;</span>io.openliberty.guides<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers"> 8</span>    <span class="tag">&lt;artifactId&gt;</span>guide-contract-testing-system<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers"> 9</span>    <span class="tag">&lt;version&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers">10</span>    <span class="tag">&lt;packaging&gt;</span>war<span class="tag">&lt;/packaging&gt;</span>
<span class="line-numbers">11</span>
<span class="line-numbers">12</span>    <span class="tag">&lt;properties&gt;</span>
<span class="line-numbers">13</span>        <span class="tag">&lt;maven.compiler.source&gt;</span>11<span class="tag">&lt;/maven.compiler.source&gt;</span>
<span class="line-numbers">14</span>        <span class="tag">&lt;maven.compiler.target&gt;</span>11<span class="tag">&lt;/maven.compiler.target&gt;</span>
<span class="line-numbers">15</span>        <span class="tag">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="tag">&lt;/project.build.sourceEncoding&gt;</span>
<span class="line-numbers">16</span>        <span class="tag">&lt;project.reporting.outputEncoding&gt;</span>UTF-8<span class="tag">&lt;/project.reporting.outputEncoding&gt;</span>
<span class="line-numbers">17</span>        <span class="comment">&lt;!-- Liberty configuration --&gt;</span>
<span class="line-numbers">18</span>        <span class="tag">&lt;liberty.var.default.http.port&gt;</span>9080<span class="tag">&lt;/liberty.var.default.http.port&gt;</span>
<span class="line-numbers">19</span>        <span class="tag">&lt;liberty.var.default.https.port&gt;</span>9443<span class="tag">&lt;/liberty.var.default.https.port&gt;</span>
<span class="line-numbers">20</span>        <span class="tag">&lt;debugPort&gt;</span>8787<span class="tag">&lt;/debugPort&gt;</span>
<span class="line-numbers">21</span>    <span class="tag">&lt;/properties&gt;</span>
<span class="line-numbers">22</span>
<span class="line-numbers">23</span>    <span class="tag">&lt;dependencies&gt;</span>
<span class="line-numbers">24</span>        <span class="comment">&lt;!-- Provided dependencies --&gt;</span>
<span class="line-numbers">25</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers">26</span>            <span class="tag">&lt;groupId&gt;</span>org.eclipse.microprofile<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">27</span>            <span class="tag">&lt;artifactId&gt;</span>microprofile<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">28</span>            <span class="tag">&lt;version&gt;</span>6.0<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers">29</span>            <span class="tag">&lt;type&gt;</span>pom<span class="tag">&lt;/type&gt;</span>
<span class="line-numbers">30</span>            <span class="tag">&lt;scope&gt;</span>provided<span class="tag">&lt;/scope&gt;</span>
<span class="line-numbers">31</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers">32</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers">33</span>            <span class="tag">&lt;groupId&gt;</span>jakarta.platform<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">34</span>            <span class="tag">&lt;artifactId&gt;</span>jakarta.jakartaee-api<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">35</span>            <span class="tag">&lt;version&gt;</span>10.0.0<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers">36</span>            <span class="tag">&lt;scope&gt;</span>provided<span class="tag">&lt;/scope&gt;</span>
<span class="line-numbers">37</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers">38</span>        <span class="comment">&lt;!-- tag::pactDependency[] --&gt;</span>
<span class="line-numbers">39</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers">40</span>            <span class="tag">&lt;groupId&gt;</span>au.com.dius.pact.provider<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">41</span>            <span class="tag">&lt;artifactId&gt;</span>junit5<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">42</span>            <span class="tag">&lt;version&gt;</span>4.5.6<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers">43</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers">44</span>        <span class="comment">&lt;!-- end::pactDependency[] --&gt;</span>
<span class="line-numbers">45</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers">46</span>            <span class="tag">&lt;groupId&gt;</span>org.slf4j<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">47</span>            <span class="tag">&lt;artifactId&gt;</span>slf4j-simple<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">48</span>            <span class="tag">&lt;version&gt;</span>2.0.7<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers">49</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers">50</span>        <span class="tag">&lt;dependency&gt;</span>
<span class="line-numbers">51</span>            <span class="tag">&lt;groupId&gt;</span>org.jboss.resteasy<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">52</span>            <span class="tag">&lt;artifactId&gt;</span>resteasy-client<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">53</span>            <span class="tag">&lt;version&gt;</span>6.2.3.Final<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers">54</span>            <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="line-numbers">55</span>        <span class="tag">&lt;/dependency&gt;</span>
<span class="line-numbers">56</span>    <span class="tag">&lt;/dependencies&gt;</span>
<span class="line-numbers">57</span>
<span class="line-numbers">58</span>    <span class="tag">&lt;build&gt;</span>
<span class="line-numbers">59</span>        <span class="tag">&lt;finalName&gt;</span>${project.artifactId}<span class="tag">&lt;/finalName&gt;</span>
<span class="line-numbers">60</span>        <span class="tag">&lt;plugins&gt;</span>
<span class="line-numbers">61</span>            <span class="comment">&lt;!-- Enable liberty-maven plugin --&gt;</span>
<span class="line-numbers">62</span>            <span class="comment">&lt;!-- tag::libertyMavenPlugin[] --&gt;</span>
<span class="line-numbers">63</span>            <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers">64</span>                <span class="tag">&lt;groupId&gt;</span>io.openliberty.tools<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">65</span>                <span class="tag">&lt;artifactId&gt;</span>liberty-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">66</span>                <span class="tag">&lt;version&gt;</span>3.8.2<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers">67</span>            <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers">68</span>            <span class="comment">&lt;!-- end::libertyMavenPlugin[] --&gt;</span>
<span class="line-numbers">69</span>            <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers">70</span>                <span class="tag">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">71</span>                <span class="tag">&lt;artifactId&gt;</span>maven-war-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">72</span>                <span class="tag">&lt;version&gt;</span>3.3.2<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers">73</span>            <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers">74</span>            <span class="comment">&lt;!-- Plugin to run functional tests --&gt;</span>
<span class="line-numbers">75</span>            <span class="tag">&lt;plugin&gt;</span>
<span class="line-numbers">76</span>                <span class="tag">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
<span class="line-numbers">77</span>                <span class="tag">&lt;artifactId&gt;</span>maven-failsafe-plugin<span class="tag">&lt;/artifactId&gt;</span>
<span class="line-numbers">78</span>                <span class="tag">&lt;version&gt;</span>3.0.0<span class="tag">&lt;/version&gt;</span>
<span class="line-numbers">79</span>                <span class="tag">&lt;configuration&gt;</span>
<span class="line-numbers">80</span>                    <span class="tag">&lt;systemPropertyVariables&gt;</span>
<span class="line-numbers">81</span>                        <span class="tag">&lt;http.port&gt;</span>${liberty.var.default.http.port}<span class="tag">&lt;/http.port&gt;</span>
<span class="line-numbers">82</span>                        <span class="comment">&lt;!-- tag::version[] --&gt;</span>
<span class="line-numbers">83</span>                        <span class="tag">&lt;pact.provider.version&gt;</span>${project.version}<span class="tag">&lt;/pact.provider.version&gt;</span>
<span class="line-numbers">84</span>                        <span class="comment">&lt;!-- end::version[] --&gt;</span>
<span class="line-numbers">85</span>                    <span class="tag">&lt;/systemPropertyVariables&gt;</span>
<span class="line-numbers">86</span>                <span class="tag">&lt;/configuration&gt;</span>
<span class="line-numbers">87</span>            <span class="tag">&lt;/plugin&gt;</span>
<span class="line-numbers">88</span>        <span class="tag">&lt;/plugins&gt;</span>
<span class="line-numbers">89</span>    <span class="tag">&lt;/build&gt;</span>
<span class="line-numbers">90</span><span class="tag">&lt;/project&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>system</code> microservice uses the <code class="hotspot=pactDependency file=2">junit5</code> pact provider dependency to connect to the Pact Broker and verify the pact file. Ideally, in a CI/CD build pipeline, the <code class="hotspot=version file=2">pact.provider.version</code> element is dynamically set to the build number so that you can identify where a breaking change is introduced.</p>
</div>
<div class="paragraph">
<p>After you create the <code>SystemBrokerIT.java</code> class and replace the <code>pom.xml</code> file, Open Liberty automatically reloads its configuration.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="verifying-the-contract">Verifying the contract</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the command-line session where you started the <code>system</code> microservice, press the <code>enter/return</code> key to run the tests to verify the pact file. When you integrate the Pact framework into a CI/CD build pipeline, you can use the <code>mvn failsafe:integration-test</code> goal to verify the pact file from the Pact Broker.</p>
</div>
<div class="paragraph">
<p>The tests fail with the following errors:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre class="CodeRay highlight"><code>[ERROR] Failures:
[ERROR]   SystemBrokerIT.pactVerificationTestTemplate:28 Pact between Inventory (1.0-SNAPSHOT) and System - Upon a request for the version
Failures:

1) Verifying a pact between Inventory and System - a request for the version has a matching body

    1.1) body: $.system.properties.version Expected "1.1" (String) to be a decimal number


[INFO]
[ERROR] Tests run: 4, Failures: 1, Errors: 0, Skipped: 0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The test from the <code>system</code> microservice fails because the <code>inventory</code> microservice was expecting a decimal, <code>1.1</code>, for the value of the <code>system.properties.version</code> property, but it received a string, <code>"1.1"</code>.</p>
</div>
<div class="paragraph">
<p>Correct the value of the <code class="hotspot=decimal file=0">system.properties.version</code> property to a decimal.</p>
</div>
<div class="listingblock code_command hotspot file=0">
<div class="content">
<pre><mark>Replace the SystemResource class file.</mark>
<code>system/src/main/java/io/openliberty/guides/system/SystemResource.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>SystemResource.java</p>
</div>
<div class="listingblock code_column hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="line-numbers"> 1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers"> 2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers"> 3</span><span class="comment"> * Copyright (c) 2021, 2022 IBM Corporation and others.</span>
<span class="line-numbers"> 4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers"> 5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers"> 6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers"> 7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers"> 8</span><span class="comment"> *</span>
<span class="line-numbers"> 9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers">10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers">11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers">12</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.system</span>;
<span class="line-numbers">13</span>
<span class="line-numbers">14</span><span class="keyword">import</span> <span class="include">jakarta.json.Json</span>;
<span class="line-numbers">15</span><span class="keyword">import</span> <span class="include">jakarta.json.JsonArray</span>;
<span class="line-numbers">16</span><span class="keyword">import</span> <span class="include">jakarta.json.JsonObject</span>;
<span class="line-numbers">17</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.PathParam</span>;
<span class="line-numbers">18</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.Response</span>;
<span class="line-numbers">19</span>
<span class="line-numbers">20</span><span class="keyword">import</span> <span class="include">jakarta.enterprise.context.RequestScoped</span>;
<span class="line-numbers">21</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.GET</span>;
<span class="line-numbers">22</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.Path</span>;
<span class="line-numbers">23</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.Produces</span>;
<span class="line-numbers">24</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.MediaType</span>;
<span class="line-numbers">25</span>
<span class="line-numbers">26</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.metrics.annotation.Counted</span>;
<span class="line-numbers">27</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.metrics.annotation.Timed</span>;
<span class="line-numbers">28</span>
<span class="line-numbers">29</span><span class="annotation">@RequestScoped</span>
<span class="line-numbers">30</span><span class="annotation">@Path</span>(<span class="string"><span class="delimiter">"</span><span class="content">/properties</span><span class="delimiter">"</span></span>)
<span class="line-numbers">31</span><span class="directive">public</span> <span class="type">class</span> <span class="class">SystemResource</span> {
<span class="line-numbers">32</span>
<span class="line-numbers">33</span>  <span class="annotation">@GET</span>
<span class="line-numbers">34</span>  <span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
<span class="line-numbers">35</span>  <span class="annotation">@Timed</span>(name = <span class="string"><span class="delimiter">"</span><span class="content">getPropertiesTime</span><span class="delimiter">"</span></span>,
<span class="line-numbers">36</span>    description = <span class="string"><span class="delimiter">"</span><span class="content">Time needed to get the JVM system properties</span><span class="delimiter">"</span></span>)
<span class="line-numbers">37</span>  <span class="annotation">@Counted</span>(absolute = <span class="predefined-constant">true</span>,
<span class="line-numbers">38</span>    description = <span class="string"><span class="delimiter">"</span><span class="content">Number of times the JVM system properties are requested</span><span class="delimiter">"</span></span>)
<span class="line-numbers">39</span>
<span class="line-numbers">40</span>  <span class="directive">public</span> Response getProperties() {
<span class="line-numbers">41</span>    <span class="keyword">return</span> Response.ok(<span class="predefined-type">System</span>.getProperties()).build();
<span class="line-numbers">42</span>  }
<span class="line-numbers">43</span>
<span class="line-numbers">44</span>  <span class="annotation">@GET</span>
<span class="line-numbers">45</span>  <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">"</span><span class="content">/key/{key}</span><span class="delimiter">"</span></span>)
<span class="line-numbers">46</span>  <span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
<span class="line-numbers">47</span>  <span class="directive">public</span> Response getPropertiesByKey(<span class="annotation">@PathParam</span>(<span class="string"><span class="delimiter">"</span><span class="content">key</span><span class="delimiter">"</span></span>) <span class="predefined-type">String</span> key) {
<span class="line-numbers">48</span>    <span class="keyword">try</span> {
<span class="line-numbers">49</span>      JsonArray response = Json.createArrayBuilder()
<span class="line-numbers">50</span>        .add(Json.createObjectBuilder()
<span class="line-numbers">51</span>          .add(key, <span class="predefined-type">System</span>.getProperties().get(key).toString()))
<span class="line-numbers">52</span>        .build();
<span class="line-numbers">53</span>      <span class="keyword">return</span> Response.ok(response, MediaType.APPLICATION_JSON).build();
<span class="line-numbers">54</span>    } <span class="keyword">catch</span> (java.lang.NullPointerException exception) {
<span class="line-numbers">55</span>        <span class="keyword">return</span> Response.status(Response.Status.NOT_FOUND).build();
<span class="line-numbers">56</span>    }
<span class="line-numbers">57</span>  }
<span class="line-numbers">58</span>
<span class="line-numbers">59</span>  <span class="annotation">@GET</span>
<span class="line-numbers">60</span>  <span class="annotation">@Path</span>(<span class="string"><span class="delimiter">"</span><span class="content">/version</span><span class="delimiter">"</span></span>)
<span class="line-numbers">61</span>  <span class="annotation">@Produces</span>(MediaType.APPLICATION_JSON)
<span class="line-numbers">62</span>  <span class="directive">public</span> JsonObject getVersion() {
<span class="line-numbers">63</span>    <span class="comment">// tag::decimal[]</span>
<span class="line-numbers">64</span>    JsonObject response = Json.createObjectBuilder()
<span class="line-numbers">65</span>                          .add(<span class="string"><span class="delimiter">"</span><span class="content">system.properties.version</span><span class="delimiter">"</span></span>, <span class="float">1.1</span>)
<span class="line-numbers">66</span>                          .build();
<span class="line-numbers">67</span>    <span class="comment">// end::decimal[]</span>
<span class="line-numbers">68</span>    <span class="keyword">return</span> response;
<span class="line-numbers">69</span>  }
<span class="line-numbers">70</span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Press the <code>enter/return</code> key to rerun the tests from the command-line session where you started the <code>system</code> microservice.</p>
</div>
<div class="paragraph">
<p>If the tests are successful, you’ll see a similar output to the following example:</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre class="CodeRay highlight"><code>...
Verifying a pact between pact between Inventory (1.0-SNAPSHOT) and System

  Notices:
    1) The pact at http://localhost:9292/pacts/provider/System/consumer/Inventory/pact-version/XXX is being verified because it matches the following configured selection criterion: latest pact for a consumer version tagged 'open-liberty-pact'

  [from Pact Broker http://localhost:9292/pacts/provider/System/consumer/Inventory/pact-version/XXX]
  Given version is 1.1
  a request for the version
    returns a response which
      has status code 200 (OK)
      has a matching body (OK)
[main] INFO au.com.dius.pact.provider.DefaultVerificationReporter - Published verification result of 'au.com.dius.pact.core.pactbroker.TestResult$Ok@4d84dfe7' for consumer 'Consumer(name=Inventory)'
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.835 s - in it.io.openliberty.guides.system.SystemBrokerIT
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the tests are complete, refresh the Pact Broker webpage at the <a href="http://localhost:9292/" class="notranslate bare" target="_blank" rel="noopener noreferrer">http://localhost:9292/</a> URL to confirm that the last verified column now shows a timestamp:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="/img/guide/contract-testing/pact-broker-webpage-verified.png" alt="Pact Broker webpage for verified">
</div>
</div>
<div class="paragraph">
<p><br></p>
</div>
<div class="paragraph">
<p>The pact file that’s created by the <code>inventory</code> microservice was successfully verified by the <code>system</code> microservice through the Pact Broker. This ensures that responses from the <code>system</code> microservice meet the expectations of the <code>inventory</code> microservice.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tearing-down-the-environment">Tearing down the environment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you are done checking out the service, exit dev mode by pressing <code>CTRL+C</code> in the command-line sessions where you ran the Liberty instances for the <code>system</code> and <code>inventory</code> microservices, or by typing <code>q</code> and then pressing the <code>enter/return</code> key.</p>
</div>
<div class="paragraph">
<p>Navigate back to the <code>/guide-contract-testing</code> directory and run the following commands to remove the Pact Broker:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker-compose -f "pact-broker/docker-compose.yml" down
docker rmi postgres:15
docker rmi pactfoundation/pact-broker:2.106.0.1
docker volume rm pact-broker_postgres-volume</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="great-work-youre-done">Great work! You’re done!</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You implemented contract testing in Java microservices by using Pact and verified the contract with the Pact Broker.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="related-links">Related Links</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Learn more about the Pact framework.</p>
</div>
<div class="paragraph">
<p><a href="https://pact.io/" target="_blank" rel="noopener noreferrer">Go to the Pact website.</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="guide-attribution">Guide Attribution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Testing microservices with consumer-driven contracts <span class="licensedClass">by</span> Open Liberty <span class="licensedClass">is licensed under</span> CC BY-ND 4.0</p>
</div>
</div>
</div>
    </div>
  </div>

  <!-- Code section -->
  <div id="code_column" class="position_relative" tabindex="0">
    <div id="code_column_title_container">
      <div id="code_column_tabs_container" class="dimmed">
        <ul id="code_column_tabs" class="nav" role="tablist"></ul>
      </div>
      <div class="copyFileButton" tabindex="0">
        <img src="/img/guides_copy_button.svg" alt="Copy file contents" title="Copy file contents">
        <div id="code_section_copied_confirmation">Copied to clipboard </div>
      </div>
    </div>
    <div id="code_column_content"></div>

    <div id="prereqs_container">
      <p id="prereqs_title">Prerequisites:</p>
      <div class="prereqs_list"></div>
      <div class="skills_network_container">
        <div class="skills_network_description"></div>
      </div>
    </div>

    <button id="dismiss_button" aria-label="Back to text" tabindex="0">
      Back to text
    </button>
  </div>
</div>

<!-- Build a list of all the documents in the guides code base -->






<!-- Remove any documents deemed private (archived, templates, etc) -->


<!-- Count number of guides from past 30 days-->


    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    


<!-- Sort list of guides by date with most recent first -->





<div id="end_of_guide">
        <h2 tabindex="0">Nice work! Where to next?</h2>
        <div id="end_of_guide_left_section">
            <p id="guide_attribution"></p>
            
            <h3 id="feedback_rating_question">What did you think of this guide?</h3>
            <div id="feedback_ratings">
                <img class="guide_rating" id="extreme_dislike" src="/img/1_Extreme_Dislike.png" onclick="$('#dislike_popup').show(); $('.popup_content').focus();" alt="Extreme Dislike" data-guide-rating="1" tabindex="0" aria-label="Rate this guide as extreme dislike">
                <img class="guide_rating" id="dislike" src="/img/2_Dislike.png" onclick="$('#dislike_popup').show(); $('.popup_content').focus();" alt="Dislike" data-guide-rating="2" tabindex="0" aria-label="Rate this guide as dislike">
                <img class="guide_rating" id="like" src="/img/3_Like.png" onclick="$('#like_popup').show(); $('.popup_content').focus();" alt="Like" data-guide-rating="3" tabindex="0" aria-label="Rate this guide as like">
                <img class="guide_rating" id="extreme_like" src="/img/4_Extreme_Like.png" onclick="$('#like_popup').show(); $('.popup_content').focus();" alt="Extreme Like" data-guide-rating="4" tabindex="0" aria-label="Rate this guide as extreme like">
            </div>

            <div id="like_popup" class="popup">
                <div class="popup_content" tabindex="0">
                    <p class="popup_title">Thank you for your feedback!</p>
                    <button id="close_button" class="popup_button" onclick="$('#like_popup').hide();">Close</button>
                </div>
            </div>

            <div id="dislike_popup" class="popup">
                <div class="popup_content" tabindex="0">
                    <p class="popup_title">Thank you for your feedback!</p>
                    <p id="open_issue">Would you like to open an issue in GitHub?</p>
                    
                        <a href="https://github.com/OpenLiberty/guide-contract-testing/issues/new" target="_blank" id="yes_button" class="popup_button" onclick="$('#dislike_popup').hide();" rel="noopener noreferrer">Yes</a>
                    
                    <button id="no_button" class="popup_button" onclick="$('#dislike_popup').hide();">No, thank you</button>
                </div>
            </div>

            <h3 id="improve_guide_feedback">What could make this guide better?</h3>
            
                <p><a target="_blank" rel="noopener noreferrer" href="https://github.com/OpenLiberty/guide-contract-testing/issues">Raise an issue</a> to share feedback</p>
                <p><a target="_blank" rel="noopener noreferrer" href="https://github.com/OpenLiberty/guide-contract-testing/pulls">Create a pull request</a> to contribute to this guide</p>
            

            <h3 id="need_help">Need help?</h3>
            <p><a target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/questions/tagged/open-liberty">Ask a question on Stack Overflow</a></p>

            <h3>Like Open Liberty? Star our repo on GitHub.</h3>
            <a class="github-button" href="https://github.com/OpenLiberty/open-liberty" data-icon="octicon-star" aria-label="Star OpenLiberty/open-liberty on GitHub" target="_blank" rel="noopener noreferrer">Star</a>
        </div>
        <div id="end_of_guide_right_section">
            <h3 id="where_to_next">Where to next?</h3>

            
            

            <!-- Related guides section -->
            
            <div id="related-guides">
                <div id="related-guides-cards" class="row">
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/microshed-testing.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Testing a MicroProfile or Jakarta EE application</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">20 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/reactive-service-testing.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Testing reactive Java microservices</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">20 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/arquillian-managed.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Testing microservices with the Arquillian managed container</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">15 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                </div>
            </div>
            
        </div>
    </div>



    </main>

    



<footer>
    <div id="footer_gray_background">
        <div id="footer_top_container" class="footer_container container-fluid">
            <div id="footer_project_container">
                <span id="footer_open_liberty"></span>
                <p id="footer_project">IBM 开放式源代码项目</p>
            </div>
            <div id="footer_round_links_container">
                <a id="footer_github_link" class="footer_round_btn" href="https://github.com/OpenLiberty/" target="_blank" rel="noopener noreferrer" aria-label="Github"></a>
                <a id="footer_twitter_link" class="footer_round_btn" href="https://twitter.com/OpenLibertyIO" target="_blank" rel="noopener noreferrer" aria-label="Twitter"></a>
                <a id="footer_stackoverflow_link" class="footer_round_btn" href="https://stackoverflow.com/questions/tagged/open-liberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty questions on Stack Overflow"></a>
                <a id="footer_groupsio_link" class="footer_round_btn" href="https://groups.io/g/openliberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Groups.io"></a>
                <a id="footer_gitter_link" class="footer_round_btn" href="https://app.gitter.im/#/room/#OpenLiberty_development:gitter.im" target="_blank" rel="noopener" aria-label="Open Liberty Gitter"></a>
            </div>
        </div>         
    </div>

    <div id="footer_bottom_container" class="footer_container container-fluid">
        <div id="footer_bottom_left_section">
            <p id="footer_copyright">© Copyright IBM Corp. 2017, 2023</p>
            <p class="vertical_bar">|</p>
            <a id="footer_privacy_policy_link" href="https://www.ibm.com/privacy/" target="_blank" rel="noopener noreferrer" class="left_footer_link">隐私策略</a>
            <p class="vertical_bar">|</p>
            <a id="footer_license_link" href="https://github.com/OpenLiberty/open-liberty/blob/release/LICENSE" target="_blank" rel="noopener noreferrer" class="left_footer_link">许可证</a>
            <p class="vertical_bar">|</p>
            <a id="footer_logos_link" href="https://github.com/OpenLiberty/logos" target="_blank" rel="noopener noreferrer" class="left_footer_link">洛戈斯</a>
        </div>
        <div id="footer_bottom_right_section">
            <a id="footer_docs_link" href="/docs" aria-label="Open Liberty Docs" class="right_footer_link blue_link_light_background">文档</a>
            <a id="footer_blog_link" href="/blog" aria-label="Open Liberty Blog" class="right_footer_link blue_link_light_background">博客</a>
            <a id="footer_support_link" href="/support" aria-label="Open Liberty Support" class="right_footer_link blue_link_light_background">支持</a>
        </div>
    </div>
</footer>

<!-- PRE-LOADED IMAGES FOR ON HOVER BEHAVIOR -->
<div class="d-none hidden">
    <img src="/img/Footer_GitCat_Hover.svg" alt="OpenLiberty Github link">
    <img src="/img/Footer_TwitterBird_Hover.svg" alt="OpenLibertyIO Twitter link">
    <img src="/img/Footer_StackO_Hover.svg" alt="Open-liberty Stack Overflow link">
    <img src="/img/Footer_GroupsIO_Hover.svg" alt="Openliberty Groups IO link">
    <img src="/img/footer_gitter_hover.svg" alt="Openliberty Gitter link">
</div>

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js" integrity="sha512-lzilC+JFd6YV8+vQRNRtU7DOqv5Sa9Ek53lXt/k91HZTJpytHS1L6l1mMKR9K6VVoDt4LiEXaa6XBrYk1YhGTQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>


<script type="text/javascript" src="/zh-Hans/assets/devEnvironment.js"></script>




  <script type="text/javascript" src="/zh-Hans/assets/guide-common.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/toc.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/tabs.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/guide-static.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/guide-multipane-static.js"></script>


<script type="text/javascript" src="/zh-Hans/assets/openliberty.js"></script>

  </body>

</html>
