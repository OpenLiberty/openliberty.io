<!DOCTYPE html>
<html lang="zh-Hans">

  





<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>
    
      Configuring Java microservices on Kubernetes with Eclipse MicroProfile Config
    
  </title>
  <meta name="description" content="A getting started tutorial with examples of how to externalize configuration with Eclipse MicroProfile Config and use Kubernetes ConfigMaps and Secrets to configure your Java microservices.">

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
  

  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/openliberty.css">
  <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/coderay-custom.css">

  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/header.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/header-dark.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/toc-multipane-static.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/end-of-guide.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-card.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/tabs.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-common.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-multipane.css">
  
    <link type="text/css" rel="stylesheet" href="/zh-Hans/assets/guide-multipane-static.css">
  

  

  

  <link rel="canonical" href="https://openliberty.io/zh-Hans/guides/kubernetes-microprofile-config">
  <link rel="alternate" type="application/rss+xml" title="Open Liberty" href="/zh-Hans/feed.xml">
  <link href="https://fonts.googleapis.com/css?family=Asap:400,500" rel="stylesheet">
    
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@OpenLibertyIO" />
  <meta name="twitter:title" content="Configuring Java microservices on Kubernetes with Eclipse MicroProfile Config" />
  <meta name="twitter:description" content="A getting started tutorial with examples of how to externalize configuration with Eclipse MicroProfile Config and use Kubernetes ConfigMaps and Secrets to configure your Java microservices." />

  <meta property='og:title' content="Configuring Java microservices on Kubernetes with Eclipse MicroProfile Config" />
  <meta property='og:image' content="https://openliberty.io/img/twitter_card.jpg" />
  <meta property='og:image:alt' content="Open Liberty Logo" />
  <meta property='og:description' content="A getting started tutorial with examples of how to externalize configuration with Eclipse MicroProfile Config and use Kubernetes ConfigMaps and Secrets to configure your Java microservices." />
  <meta property='og:url' content="https://openliberty.io/zh-Hans/guides/kubernetes-microprofile-config" />
  <meta property='og:type' content="website" />
  
  <meta name="google-site-verification" content="h2P030H9b66CyL1nEmWfrZB8Fr14h9LmVMG7Ur0caBs" />

  
      <meta name="robots" content="noindex" />
  

  <script async defer src="https://buttons.github.io/buttons.js"></script>
</head>


  <body>
    
    

    


<!--  -->

<header>
    <nav id="nav_bar">
        <div id="nav_header">
            <a id="home_link" href="/" aria-label="Open Liberty Home">
                <img id="ol_logo" src="/img/docs_openliberty_logo.png" alt="Open Liberty Logo">
            </a>
            <button id="hamburger_toggle_button" onclick="$('#nav_bar').toggleClass('responsive');">
                <span id="hamburger_toggle_icon"></span>
            </button>
        </div>
        <div id="hamburger_menu">
            <ul class="nav_list">
                <li class="nav_link">
                    <a href="/start/">入门</a>
                </li>
                <li class="nav_link">
                    <a href="/guides/">指南</a>
                </li>
                <li class="nav_link">
                    <a href="/docs/">文档</a>
                </li>
                <li class="nav_link">
                    <a href="/support/">支持</a>
                </li>
                <li class="nav_link">
                    <a href="/blog/">博客</a>
                </li>
            </ul>
            <div id="header_round_links_container"> 
                <a id="header_twitter_link" class="header_round_button" href="https://twitter.com/OpenLibertyIO" target="_blank" rel="noopener noreferrer" aria-label="Twitter"></a>
                <a id="header_stackoverflow_link" class="header_round_button" href="https://stackoverflow.com/questions/tagged/open-liberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty questions on Stack Overflow"></a>
                <a id="header_groupsio_link" class="header_round_button" href="https://groups.io/g/openliberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Groups.io"></a>
                <a id="header_gitter_link" class="header_round_button" href="https://app.gitter.im/#/room/#OpenLiberty_development:gitter.im" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Gitter"></a>
            </div>
        </div>

    </nav>
</header>


    <main aria-label="Content">

      <!-- Build a list of all the documents in the guides code base -->
  
 

<!-- Remove any documents deemed private (archived, templates, etc) -->


<!-- Count number of guides from past 30 days-->
<!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
 

<!-- Sort list of guides by date with most recent first -->


<div id="background_container">
  <div id="toc_hotspot"></div>
  <!-- Guide's table of contents section -->
  <div id="toc_column" class="collapse inline open">
    <div id="toc_inner">
       
      <div id="close_container">
        <img id="toc_close_white" src="/img/toc_close_white.svg" alt="Close the table of contents" tabindex="0">
      </div>
      <h3 id="toc_title">Contents</h3>
      <div id="toc_container"><ul class="sectlevel1">
<li><a href="#what-youll-learn">What you’ll learn</a></li>
<li><a href="#additional-prerequisites">Additional prerequisites</a></li>
<li><a href="#getting-started">Getting started</a></li>
<li><a href="#starting-and-preparing-your-cluster-for-deployment">Starting and preparing your cluster for deployment</a></li>
<li><a href="#deploying-the-microservices">Deploying the microservices</a></li>
<li><a href="#modifying-system-microservice">Modifying system microservice</a></li>
<li><a href="#modifying-inventory-microservice">Modifying inventory microservice</a></li>
<li><a href="#creating-a-configmap-and-secret">Creating a ConfigMap and Secret</a></li>
<li><a href="#updating-kubernetes-resources">Updating Kubernetes resources</a></li>
<li><a href="#deploying-your-changes">Deploying your changes</a></li>
<li><a href="#testing-the-microservices">Testing the microservices</a></li>
<li><a href="#tearing-down-the-environment">Tearing down the environment</a></li>
<li><a href="#great-work-youre-done">Great work! You’re done!</a></li>
<li><a href="#guide-attribution">Guide Attribution</a></li>
</ul></div>
      <div id="toc_separator"></div>
      
      <h3 id="tag_title">标签</h3>
      <div id="tags_container"></div>
    </div>
  </div>
  <div id="toc_indicator" tabindex="0" aria-label="Open the table of contents" class="hidden">
    <img src="/img/arrow_white.svg" alt="arrow">
  </div>
  <div id="toc_line" class="open"></div>
  <!-- Entire guide section -->
  <div id="guide_column" class="position_relative open">
    <div id="guide_content">
      <!-- Guide header section -->
      <div id="guide_meta" class="sect1" tabindex="0">
        <h1 id="guide_title">Configuring microservices running in Kubernetes</h1>
        <div id="duration_container">
          <img src="/img/guide_duration_clock_icon_large.svg" alt="duration">
          <span id="guide_duration">15 minutes</span>

          <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
          <!-- If new posts count is less than 4, use 4 most recent posts -->
           
          <!-- If new posts count is >= 4, use posts from last 30 days-->
          
          <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
          <!-- Count number of guides from past last 12 weeks that is 84 days-->
          <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
          
        </div>
        <div id="mobile_prereqs_section">
          <p id="mobile_prereqs_title">Prerequisites:</p>
          <div class="prereqs_list"></div>
          <div class="skills_network_container">
            <div class="skills_network_description"></div>
          </div>
        </div>
      </div>

      <div class="scroller_anchor"></div>
      <div id="mobile_toc_accordion_container" data-toggle="collapse" data-target="#toc_column" aria-expanded="false" aria-controls="toc_column" role="button">
        <div role="menuitem" id="mobile_toc_accordion">
          <button class="breadcrumb_hamburger toc-toggle collapsed" type="button" tabindex="0">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <img src="/img/toc_close_green.svg" class="TOC_Close_SVG hidden img-responsive" alt="Table of contents close button">
          </button>
          <span>Table of contents</span>
        </div>
      </div>

      <!-- Guide content section -->
      <div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note hidden">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This repository contains the guide documentation source. To view the guide in published form, view it on the <a href="https://openliberty.io/guides/kubernetes-microprofile-config.html">Open Liberty website</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Explore how to externalize configuration using MicroProfile Config and configure your microservices using Kubernetes ConfigMaps and Secrets.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-youll-learn">What you’ll learn</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You will learn how and why to externalize your microservice’s configuration. Externalized configuration is useful because configuration usually changes depending on your environment. You will also learn how to configure the environment by providing required values to your application using Kubernetes.</p>
</div>
<div class="paragraph">
<p>MicroProfile Config provides useful annotations that you can use to inject configured values into your code. These values can come from any configuration source, such as environment variables. Using environment variables allows for easier deployment to different environments. To learn more about MicroProfile Config, read the <a href="https://openliberty.io/guides/microprofile-config.html" target="_blank" rel="noopener">Configuring microservices</a> guide.</p>
</div>
<div class="paragraph">
<p>Furthermore, you’ll learn how to set these environment variables with ConfigMaps and Secrets. These resources are provided by Kubernetes and act as a data source for your environment variables. You can use a ConfigMap or Secret to set environment variables for any number of containers.</p>
</div>
</div>
</div>
<div class="sect1 command">
<h2 id="additional-prerequisites">Additional prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you begin, you need a containerization software for building containers. Kubernetes supports various container runtimes. You will use <code>Docker</code> in this guide. For Docker installation instructions, refer to the official <a href="https://docs.docker.com/install/" target="_blank" rel="noopener noreferrer">Docker documentation</a>.</p>
</div>
<div class="paragraph tab_link windows_link">
<p><code><strong>WINDOWS</strong></code></p>
</div>
<div class="paragraph tab_link mac_link">
<p><code><strong>MAC</strong></code></p>
</div>
<div class="paragraph tab_link linux_link">
<p><code><strong>LINUX</strong></code></p>
</div>
<div class="openblock tab_content windows_section">
<div class="content">
<div class="paragraph">
<p>Use Docker Desktop, where a local Kubernetes environment is pre-installed and enabled. If you do not see the <em>Kubernetes</em> tab, then upgrade to the latest version of Docker Desktop.</p>
</div>
<div class="paragraph">
<p>Complete the setup for your operating system:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set up  <a href="https://docs.docker.com/docker-for-windows/#kubernetes" target="_blank" rel="noopener noreferrer">Docker for Windows</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After you complete the Docker setup instructions for your operating system, ensure that Kubernetes (not Swarm) is selected as the orchestrator in Docker Preferences.</p>
</div>
</div>
</div>
<div class="openblock tab_content mac_section">
<div class="content">
<div class="paragraph">
<p>Use Docker Desktop, where a local Kubernetes environment is pre-installed and enabled. If you do not see the <em>Kubernetes</em> tab, then upgrade to the latest version of Docker Desktop.</p>
</div>
<div class="paragraph">
<p>Complete the setup for your operating system:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set up <a href="https://docs.docker.com/docker-for-mac/#kubernetes" target="_blank" rel="noopener noreferrer">Docker for Mac</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After you complete the Docker setup instructions for your operating system, ensure that Kubernetes (not Swarm) is selected as the orchestrator in Docker Preferences.</p>
</div>
</div>
</div>
<div class="openblock tab_content linux_section">
<div class="content">
<div class="paragraph">
<p>You will use <code>Minikube</code> as a single-node Kubernetes cluster that runs locally in a virtual machine.
Make sure you have <code>kubectl</code> installed. If you need to install <code>kubectl</code>, see the <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/#install-kubectl-on-linux" target="_blank" rel="noopener noreferrer">kubectl installation instructions</a>.
For Minikube installation instructions, see the <a href="https://github.com/kubernetes/minikube#installation" target="_blank" rel="noopener noreferrer">Minikube documentation</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 command">
<h2 id="getting-started">Getting started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The fastest way to work through this guide is to clone the <a href="https://github.com/openliberty/guide-kubernetes-microprofile-config.git" target="_blank" rel="noopener noreferrer">Git repository</a> and use the projects that are provided inside:</p>
</div>
<div id="git_clone" class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>git clone https://github.com/openliberty/guide-kubernetes-microprofile-config.git
cd guide-kubernetes-microprofile-config</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>start</code> directory contains the starting project that you will build upon.</p>
</div>
<div class="paragraph">
<p>The <code>finish</code> directory contains the finished project that you will build.</p>
</div>
<div class="paragraph">
<p>Before you begin, make sure you have all the necessary <span class="prerequisites">prerequisites</span>.</p>
</div>
</div>
</div>
<div class="sect1 command">
<h2 id="starting-and-preparing-your-cluster-for-deployment">Starting and preparing your cluster for deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Start your Kubernetes cluster.</p>
</div>
<div class="paragraph tab_link windows_link">
<p><code><strong>WINDOWS</strong></code></p>
</div>
<div class="paragraph tab_link mac_link">
<p><code><strong>MAC</strong></code></p>
</div>
<div class="paragraph tab_link linux_link">
<p><code><strong>LINUX</strong></code></p>
</div>
<div class="openblock tab_content windows_section mac_section">
<div class="content">
<div class="paragraph">
<p>Start your Docker Desktop environment.</p>
</div>
<div class="paragraph">
<p>Ensure that Kubernetes is running on Docker Desktop and that the context is set to <code>docker-desktop</code>.</p>
</div>
</div>
</div>
<div class="openblock tab_content linux_section">
<div class="content">
<div class="paragraph">
<p>Run the following command from a command-line session:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>minikube start</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock tab_content linux_section">
<div class="content">

</div>
</div>
<div class="paragraph">
<p>Next, validate that you have a healthy Kubernetes environment by running the following command from the active command-line session.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>kubectl get nodes</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command should return a <code>Ready</code> status for the master node.</p>
</div>
<div class="paragraph tab_link windows_link">
<p><code><strong>WINDOWS</strong></code></p>
</div>
<div class="paragraph tab_link mac_link">
<p><code><strong>MAC</strong></code></p>
</div>
<div class="paragraph tab_link linux_link">
<p><code><strong>LINUX</strong></code></p>
</div>
<div class="openblock tab_content windows_section mac_section">
<div class="content">
<div class="paragraph">
<p>You do not need to do any other step.</p>
</div>
</div>
</div>
<div class="openblock tab_content linux_section">
<div class="content">
<div class="paragraph">
<p>Run the following command to configure the Docker CLI to use Minikube’s Docker daemon.
After you run this command, you will be able to interact with Minikube’s Docker daemon and build new
images directly to it from your host machine:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>eval $(minikube docker-env)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploying-the-microservices">Deploying the microservices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The two microservices you will deploy are called <code>system</code> and <code>inventory</code>. The <code>system</code> microservice returns the JVM system properties of the running container. The <code>inventory</code> microservice adds the properties from the <code>system</code> microservice to the inventory. This demonstrates how communication can be established between pods inside a cluster. To build these applications, navigate to the <code>start</code> directory and run the following command.</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>cd start
mvn clean package</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, run the <code>docker build</code> commands to build container images for your application:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker build -t system:1.0-SNAPSHOT system/.
docker build -t inventory:1.0-SNAPSHOT inventory/.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>-t</code> flag in the <code>docker build</code> command allows the Docker image to be labeled (tagged) in the <code>name[:tag]</code> format. The tag for an image describes the specific image version. If the optional <code>[:tag]</code> tag is not specified, the <code>latest</code> tag is created by default.</p>
</div>
<div class="paragraph">
<p>Run the following command to deploy the necessary Kubernetes resources to serve the applications.</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>kubectl apply -f kubernetes.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>When this command finishes, wait for the pods to be in the Ready state. Run the following command to view the status of the pods.</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>kubectl get pods</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the pods are ready, the output shows <code>1/1</code> for READY and <code>Running</code> for STATUS.</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre class="CodeRay highlight"><code>NAME                                   READY     STATUS    RESTARTS   AGE
system-deployment-6bd97d9bf6-6d2cj     1/1       Running   0          34s
inventory-deployment-645767664f-7gnxf  1/1       Running   0          34s</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the pods are ready, you will make requests to your services.</p>
</div>
<div class="paragraph tab_link windows_link">
<p><code><strong>WINDOWS</strong></code></p>
</div>
<div class="paragraph tab_link mac_link">
<p><code><strong>MAC</strong></code></p>
</div>
<div class="paragraph tab_link linux_link">
<p><code><strong>LINUX</strong></code></p>
</div>
<div class="openblock tab_content windows_section mac_section">
<div class="content">
<div class="paragraph">
<p>The default host name for Docker Desktop is <code>localhost</code>.</p>
</div>
</div>
</div>
<div class="openblock tab_content linux_section">
<div class="content">
<div class="paragraph">
<p>The default host name for minikube is 192.168.99.100. Otherwise it can be found using the <code>minikube ip</code> command.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Navigate to <code>http://[hostname]:31000/system/properties</code> and use the username <code>bob</code> and the password <code>bobpwd</code> to authenticate. Replace <code>[hostname]</code> with the IP address or host name of your Kubernetes cluster. Open your browser’s developer console and examine the response headers.</p>
</div>
<div class="paragraph">
<p>You can also run the <code>curl</code> command to make requests to your microservices. Use the <code>-u</code> option to pass in the username <code>bob</code> and the password <code>bobpwd</code>.</p>
</div>
<div class="paragraph tab_link windows_link">
<p><code><strong>WINDOWS</strong></code></p>
</div>
<div class="paragraph tab_link mac_link">
<p><code><strong>MAC</strong></code></p>
</div>
<div class="paragraph tab_link linux_link">
<p><code><strong>LINUX</strong></code></p>
</div>
<div class="openblock tab_content windows_section">
<div class="content">
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>curl http://localhost:31000/system/properties -u bob:bobpwd</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>curl</code> command is unavailable, then use <a href="https://www.getpostman.com/" target="_blank" rel="noopener noreferrer">Postman</a>. Postman enables you to make requests using a graphical interface. To make a request with Postman, enter <code>http://localhost:31000/system/properties</code> into the URL bar. Next, set the <code>Authorization</code> with <code>Basic Auth</code> type. Set the <code>Username</code> field to <code>bob</code> and the <code>Password</code> field to <code>bobpwd</code>. Read the <a href="https://learning.postman.com/docs/sending-requests/authorization/#basic-auth" target="_blank" rel="noopener noreferrer">Authorizing requests</a> document for more details. Finally, click the blue <code>Send</code> button to make the request.</p>
</div>
</div>
</div>
<div class="openblock tab_content mac_section">
<div class="content">
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>curl http://localhost:31000/system/properties -u bob:bobpwd</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock tab_content linux_section">
<div class="content">
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>curl http://$(minikube ip):31000/system/properties -u bob:bobpwd</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Similarly, navigate to <code>http://[hostname]:32000/inventory/systems/system-service</code>, or use the following <code>curl</code> command to add the system to your inventory.</p>
</div>
<div class="paragraph tab_link windows_link">
<p><code><strong>WINDOWS</strong></code></p>
</div>
<div class="paragraph tab_link mac_link">
<p><code><strong>MAC</strong></code></p>
</div>
<div class="paragraph tab_link linux_link">
<p><code><strong>LINUX</strong></code></p>
</div>
<div class="openblock tab_content windows_section mac_section">
<div class="content">
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>curl http://localhost:32000/inventory/systems/system-service</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock tab_content linux_section">
<div class="content">
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>curl http://$(minikube ip):32000/inventory/systems/system-service</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="modifying-system-microservice">Modifying system microservice</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>system</code> service is hardcoded to use a single forward slash as the context root. The context root is set in the <code class="hotspot=webApplication file=0">webApplication</code>
element, where the <code>contextRoot</code> attribute is specified as <code>"/"</code>. You’ll make the value of the <code>contextRoot</code> attribute configurable by implementing it as a variable.</p>
</div>
<div class="listingblock code_command hotspot file=0">
<div class="content">
<pre><mark>Replace the <code>server.xml</code> file.</mark>
<code>system/src/main/liberty/config/server.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>server.xml</p>
</div>
<div class="listingblock code_column hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="line-numbers"> 1</span><span class="tag">&lt;server</span> <span class="attribute-name">description</span>=<span class="string"><span class="delimiter">"</span><span class="content">Sample Liberty server</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers"> 2</span>
<span class="line-numbers"> 3</span>  <span class="tag">&lt;featureManager&gt;</span>
<span class="line-numbers"> 4</span>    <span class="tag">&lt;feature&gt;</span>restfulWS-3.1<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 5</span>    <span class="tag">&lt;feature&gt;</span>jsonb-3.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 6</span>    <span class="tag">&lt;feature&gt;</span>cdi-4.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 7</span>    <span class="tag">&lt;feature&gt;</span>jsonp-2.1<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 8</span>    <span class="tag">&lt;feature&gt;</span>mpConfig-3.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers"> 9</span>    <span class="tag">&lt;feature&gt;</span>mpHealth-4.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers">10</span>    <span class="tag">&lt;feature&gt;</span>appSecurity-5.0<span class="tag">&lt;/feature&gt;</span>
<span class="line-numbers">11</span>  <span class="tag">&lt;/featureManager&gt;</span>
<span class="line-numbers">12</span>
<span class="line-numbers">13</span>  <span class="tag">&lt;variable</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">default.http.port</span><span class="delimiter">"</span></span> <span class="attribute-name">defaultValue</span>=<span class="string"><span class="delimiter">"</span><span class="content">9080</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">14</span>  <span class="tag">&lt;variable</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">default.https.port</span><span class="delimiter">"</span></span> <span class="attribute-name">defaultValue</span>=<span class="string"><span class="delimiter">"</span><span class="content">9443</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">15</span>  <span class="tag">&lt;variable</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">system.app.username</span><span class="delimiter">"</span></span> <span class="attribute-name">defaultValue</span>=<span class="string"><span class="delimiter">"</span><span class="content">bob</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">16</span>  <span class="tag">&lt;variable</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">system.app.password</span><span class="delimiter">"</span></span> <span class="attribute-name">defaultValue</span>=<span class="string"><span class="delimiter">"</span><span class="content">bobpwd</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">17</span>  <span class="comment">&lt;!-- tag::context.root[] --&gt;</span>
<span class="line-numbers">18</span>  <span class="tag">&lt;variable</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">context.root</span><span class="delimiter">"</span></span> <span class="attribute-name">defaultValue</span>=<span class="string"><span class="delimiter">"</span><span class="content">/</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">19</span>  <span class="comment">&lt;!-- end::context.root[] --&gt;</span>
<span class="line-numbers">20</span>
<span class="line-numbers">21</span>  <span class="tag">&lt;httpEndpoint</span> <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">"</span><span class="content">*</span><span class="delimiter">"</span></span> <span class="attribute-name">httpPort</span>=<span class="string"><span class="delimiter">"</span><span class="content">${default.http.port}</span><span class="delimiter">"</span></span> 
<span class="line-numbers">22</span>    <span class="attribute-name">httpsPort</span>=<span class="string"><span class="delimiter">"</span><span class="content">${default.https.port}</span><span class="delimiter">"</span></span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">defaultHttpEndpoint</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>
<span class="line-numbers">23</span>
<span class="line-numbers">24</span>  <span class="comment">&lt;!-- tag::webApplication[] --&gt;</span>
<span class="line-numbers">25</span>  <span class="tag">&lt;webApplication</span> <span class="attribute-name">location</span>=<span class="string"><span class="delimiter">"</span><span class="content">guide-kubernetes-microprofile-config-system.war</span><span class="delimiter">"</span></span> <span class="attribute-name">contextRoot</span>=<span class="string"><span class="delimiter">"</span><span class="content">${context.root}</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
<span class="line-numbers">26</span>  <span class="comment">&lt;!-- end::webApplication[] --&gt;</span>
<span class="line-numbers">27</span>
<span class="line-numbers">28</span>  <span class="tag">&lt;basicRegistry</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">basic</span><span class="delimiter">"</span></span> <span class="attribute-name">realm</span>=<span class="string"><span class="delimiter">"</span><span class="content">BasicRegistry</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
<span class="line-numbers">29</span>    <span class="tag">&lt;user</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">${system.app.username}</span><span class="delimiter">"</span></span> <span class="attribute-name">password</span>=<span class="string"><span class="delimiter">"</span><span class="content">${system.app.password}</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>
<span class="line-numbers">30</span>  <span class="tag">&lt;/basicRegistry&gt;</span>
<span class="line-numbers">31</span>
<span class="line-numbers">32</span><span class="tag">&lt;/server&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>contextRoot</code> attribute in the <code class="hotspot=webApplication file=0">webApplication</code> element now gets its value from the <code class="hotspot=context.root file=0">context.root</code> variable. To find a value for the <code>context.root</code> variable, Open Liberty looks for the following environment variables, in order:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>context.root</code></p>
</li>
<li>
<p><code>context_root</code></p>
</li>
<li>
<p><code>CONTEXT_ROOT</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="modifying-inventory-microservice">Modifying inventory microservice</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>inventory</code> service is hardcoded to use <code>bob</code> and <code>bobpwd</code> as the credentials to authenticate against the <code>system</code> service. You’ll make these credentials configurable.</p>
</div>
<div class="listingblock code_command hotspot file=0">
<div class="content">
<pre><mark>Replace the <code>SystemClient</code> class.</mark>
<code>inventory/src/main/java/io/openliberty/guides/inventory/client/SystemClient.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>SystemClient.java</p>
</div>
<div class="listingblock code_column hide_tags=copyright">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="line-numbers">  1</span><span class="comment">// tag::copyright[]</span>
<span class="line-numbers">  2</span><span class="comment">/*******************************************************************************</span>
<span class="line-numbers">  3</span><span class="comment"> * Copyright (c) 2017, 2023 IBM Corporation and others.</span>
<span class="line-numbers">  4</span><span class="comment"> * All rights reserved. This program and the accompanying materials</span>
<span class="line-numbers">  5</span><span class="comment"> * are made available under the terms of the Eclipse Public License 2.0</span>
<span class="line-numbers">  6</span><span class="comment"> * which accompanies this distribution, and is available at</span>
<span class="line-numbers">  7</span><span class="comment"> * http://www.eclipse.org/legal/epl-2.0/</span>
<span class="line-numbers">  8</span><span class="comment"> *</span>
<span class="line-numbers">  9</span><span class="comment"> * SPDX-License-Identifier: EPL-2.0</span>
<span class="line-numbers"> 10</span><span class="comment"> *******************************************************************************/</span>
<span class="line-numbers"> 11</span><span class="comment">// end::copyright[]</span>
<span class="line-numbers"> 12</span><span class="keyword">package</span> <span class="namespace">io.openliberty.guides.inventory.client</span>;
<span class="line-numbers"> 13</span>
<span class="line-numbers"> 14</span><span class="keyword">import</span> <span class="include">java.net.URI</span>;
<span class="line-numbers"> 15</span><span class="keyword">import</span> <span class="include">java.util.Base64</span>;
<span class="line-numbers"> 16</span><span class="keyword">import</span> <span class="include">java.util.Properties</span>;
<span class="line-numbers"> 17</span>
<span class="line-numbers"> 18</span><span class="keyword">import</span> <span class="include">jakarta.enterprise.context.RequestScoped</span>;
<span class="line-numbers"> 19</span><span class="keyword">import</span> <span class="include">jakarta.inject.Inject</span>;
<span class="line-numbers"> 20</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.client.Client</span>;
<span class="line-numbers"> 21</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.client.ClientBuilder</span>;
<span class="line-numbers"> 22</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.client.Invocation.Builder</span>;
<span class="line-numbers"> 23</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.HttpHeaders</span>;
<span class="line-numbers"> 24</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.MediaType</span>;
<span class="line-numbers"> 25</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.Response</span>;
<span class="line-numbers"> 26</span><span class="keyword">import</span> <span class="include">jakarta.ws.rs.core.Response.Status</span>;
<span class="line-numbers"> 27</span>
<span class="line-numbers"> 28</span><span class="keyword">import</span> <span class="include">org.eclipse.microprofile.config.inject.ConfigProperty</span>;
<span class="line-numbers"> 29</span>
<span class="line-numbers"> 30</span><span class="annotation">@RequestScoped</span>
<span class="line-numbers"> 31</span><span class="directive">public</span> <span class="type">class</span> <span class="class">SystemClient</span> {
<span class="line-numbers"> 32</span>
<span class="line-numbers"> 33</span>  <span class="comment">// Constants for building URI to the system service.</span>
<span class="line-numbers"> 34</span>  <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">String</span> SYSTEM_PROPERTIES = <span class="string"><span class="delimiter">"</span><span class="content">/system/properties</span><span class="delimiter">"</span></span>;
<span class="line-numbers"> 35</span>  <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">String</span> PROTOCOL = <span class="string"><span class="delimiter">"</span><span class="content">http</span><span class="delimiter">"</span></span>;
<span class="line-numbers"> 36</span>
<span class="line-numbers"> 37</span>  <span class="annotation">@Inject</span>
<span class="line-numbers"> 38</span>  <span class="annotation">@ConfigProperty</span>(name = <span class="string"><span class="delimiter">"</span><span class="content">CONTEXT_ROOT</span><span class="delimiter">"</span></span>, defaultValue = <span class="string"><span class="delimiter">"</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 39</span>  <span class="predefined-type">String</span> CONTEXT_ROOT;
<span class="line-numbers"> 40</span>
<span class="line-numbers"> 41</span>  <span class="annotation">@Inject</span>
<span class="line-numbers"> 42</span>  <span class="annotation">@ConfigProperty</span>(name = <span class="string"><span class="delimiter">"</span><span class="content">default.http.port</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 43</span>  <span class="predefined-type">String</span> DEFAULT_PORT;
<span class="line-numbers"> 44</span>
<span class="line-numbers"> 45</span>  <span class="comment">// Basic Auth Credentials</span>
<span class="line-numbers"> 46</span>  <span class="comment">// tag::credentials[]</span>
<span class="line-numbers"> 47</span>  <span class="comment">// tag::system-app-username[]</span>
<span class="line-numbers"> 48</span>  <span class="annotation">@Inject</span>
<span class="line-numbers"> 49</span>  <span class="annotation">@ConfigProperty</span>(name = <span class="string"><span class="delimiter">"</span><span class="content">SYSTEM_APP_USERNAME</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 50</span>  <span class="directive">private</span> <span class="predefined-type">String</span> username;
<span class="line-numbers"> 51</span>  <span class="comment">// end::system-app-username[]</span>
<span class="line-numbers"> 52</span>
<span class="line-numbers"> 53</span>  <span class="comment">// tag::system-app-password[]</span>
<span class="line-numbers"> 54</span>  <span class="annotation">@Inject</span>
<span class="line-numbers"> 55</span>  <span class="annotation">@ConfigProperty</span>(name = <span class="string"><span class="delimiter">"</span><span class="content">SYSTEM_APP_PASSWORD</span><span class="delimiter">"</span></span>)
<span class="line-numbers"> 56</span>  <span class="directive">private</span> <span class="predefined-type">String</span> password;
<span class="line-numbers"> 57</span>  <span class="comment">// end::system-app-password[]</span>
<span class="line-numbers"> 58</span>  <span class="comment">// end::credentials[]</span>
<span class="line-numbers"> 59</span>
<span class="line-numbers"> 60</span>  <span class="comment">// Wrapper function that gets properties</span>
<span class="line-numbers"> 61</span>  <span class="directive">public</span> <span class="predefined-type">Properties</span> getProperties(<span class="predefined-type">String</span> hostname) {
<span class="line-numbers"> 62</span>    <span class="predefined-type">Properties</span> properties = <span class="predefined-constant">null</span>;
<span class="line-numbers"> 63</span>    Client client = ClientBuilder.newClient();
<span class="line-numbers"> 64</span>    <span class="keyword">try</span> {
<span class="line-numbers"> 65</span>        Builder builder = getBuilder(hostname, client);
<span class="line-numbers"> 66</span>        properties = getPropertiesHelper(builder);
<span class="line-numbers"> 67</span>    } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
<span class="line-numbers"> 68</span>        <span class="predefined-type">System</span>.err.println(
<span class="line-numbers"> 69</span>        <span class="string"><span class="delimiter">"</span><span class="content">Exception thrown while getting properties: </span><span class="delimiter">"</span></span> + e.getMessage());
<span class="line-numbers"> 70</span>    } <span class="keyword">finally</span> {
<span class="line-numbers"> 71</span>        client.close();
<span class="line-numbers"> 72</span>    }
<span class="line-numbers"> 73</span>    <span class="keyword">return</span> properties;
<span class="line-numbers"> 74</span>  }
<span class="line-numbers"> 75</span>
<span class="line-numbers"> 76</span>  <span class="comment">// Method that creates the client builder</span>
<span class="line-numbers"> 77</span>  <span class="directive">private</span> Builder getBuilder(<span class="predefined-type">String</span> hostname, Client client) <span class="directive">throws</span> <span class="exception">Exception</span> {
<span class="line-numbers"> 78</span>    <span class="predefined-type">URI</span> uri = <span class="keyword">new</span> <span class="predefined-type">URI</span>(
<span class="line-numbers"> 79</span>                  PROTOCOL, <span class="predefined-constant">null</span>, hostname, <span class="predefined-type">Integer</span>.valueOf(DEFAULT_PORT),
<span class="line-numbers"> 80</span>                  CONTEXT_ROOT + SYSTEM_PROPERTIES, <span class="predefined-constant">null</span>, <span class="predefined-constant">null</span>);
<span class="line-numbers"> 81</span>    <span class="predefined-type">String</span> urlString = uri.toString();
<span class="line-numbers"> 82</span>    Builder builder = client.target(urlString).request();
<span class="line-numbers"> 83</span>    builder.header(HttpHeaders.CONTENT_TYPE, MediaType.APPLICATION_JSON)
<span class="line-numbers"> 84</span>           .header(HttpHeaders.AUTHORIZATION, getAuthHeader());
<span class="line-numbers"> 85</span>    <span class="keyword">return</span> builder;
<span class="line-numbers"> 86</span>  }
<span class="line-numbers"> 87</span>
<span class="line-numbers"> 88</span>  <span class="comment">// Helper method that processes the request</span>
<span class="line-numbers"> 89</span>  <span class="directive">private</span> <span class="predefined-type">Properties</span> getPropertiesHelper(Builder builder) <span class="directive">throws</span> <span class="exception">Exception</span> {
<span class="line-numbers"> 90</span>    Response response = builder.get();
<span class="line-numbers"> 91</span>    <span class="keyword">if</span> (response.getStatus() == Status.OK.getStatusCode()) {
<span class="line-numbers"> 92</span>        <span class="keyword">return</span> response.readEntity(<span class="predefined-type">Properties</span>.class);
<span class="line-numbers"> 93</span>    } <span class="keyword">else</span> {
<span class="line-numbers"> 94</span>        <span class="predefined-type">System</span>.err.println(<span class="string"><span class="delimiter">"</span><span class="content">Response Status is not OK.</span><span class="delimiter">"</span></span>);
<span class="line-numbers"> 95</span>        <span class="keyword">return</span> <span class="predefined-constant">null</span>;
<span class="line-numbers"> 96</span>    }
<span class="line-numbers"> 97</span>  }
<span class="line-numbers"> 98</span>
<span class="line-numbers"> 99</span>  <span class="directive">private</span> <span class="predefined-type">String</span> getAuthHeader() {
<span class="line-numbers">100</span>    <span class="predefined-type">String</span> usernamePassword = username + <span class="string"><span class="delimiter">"</span><span class="content">:</span><span class="delimiter">"</span></span> + password;
<span class="line-numbers">101</span>    <span class="predefined-type">String</span> encoded = Base64.getEncoder().encodeToString(usernamePassword.getBytes());
<span class="line-numbers">102</span>    <span class="keyword">return</span> <span class="string"><span class="delimiter">"</span><span class="content">Basic </span><span class="delimiter">"</span></span> + encoded;
<span class="line-numbers">103</span>  }
<span class="line-numbers">104</span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The changes introduced here use MicroProfile Config and CDI to inject the value of the environment variables <code class="hotspot=system-app-username">SYSTEM_APP_USERNAME</code> and <code class="hotspot=system-app-password">SYSTEM_APP_PASSWORD</code> into the <code class="hotspot file=0">SystemClient</code> class.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-a-configmap-and-secret">Creating a ConfigMap and Secret</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Several options exist to configure an environment variable in a Docker container. You can set it directly in the <code class="hotspot file=1">Dockerfile</code> with the <code>ENV</code> command. You can also set it in your <code class="hotspot file=0">kubernetes.yaml</code> file by specifying a name and a value for the environment variable that you want to set for a specific container. With these options in mind, you’re going to use a ConfigMap and Secret to set these values. These are resources provided by Kubernetes as a way to provide configuration values to your containers. A benefit is that they can be reused across many different containers, even if they all require different environment variables to be set with the same value.</p>
</div>
<div class="paragraph">
<p>Create a ConfigMap to configure the app name with the following <code>kubectl</code> command.</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>kubectl create configmap sys-app-root --from-literal contextRoot=/dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command deploys a ConfigMap named <code>sys-app-root</code> to your cluster. It has a key called <code>contextRoot</code> with a value of <code>/dev</code>. The <code>--from-literal</code> flag allows you to specify individual key-value pairs to store in this ConfigMap. Other available options, such as <code>--from-file</code> and <code>--from-env-file</code>, provide more versatility as to what you want to configure. Details about these options can be found in the <a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#-em-configmap-em-" target="_blank" rel="noopener noreferrer">Kubernetes CLI documentation</a>.</p>
</div>
<div class="paragraph">
<p>Create a Secret to configure the new credentials that <code>inventory</code> uses to authenticate against <code>system</code> with the following <code>kubectl</code> command.</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>kubectl create secret generic sys-app-credentials --from-literal username=alice --from-literal password=wonderland</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command looks similar to the command to create a ConfigMap, but one difference is the word <code>generic</code>. This word creates a Secret that doesn’t store information in any specialized way. Different types of secrets are available, such as secrets to store Docker credentials and secrets to store public and private key pairs.</p>
</div>
<div class="paragraph">
<p>A Secret is similar to a ConfigMap. A key difference is that a Secret is used for confidential information such as credentials. One of the main differences is that you must explicitly tell <code>kubectl</code> to show you the contents of a Secret. Additionally, when it does show you the information, it only shows you a Base64 encoded version so that a casual onlooker doesn’t accidentally see any sensitive data. Secrets don’t provide any encryption by default, that is something you’ll either need to do yourself or find an alternate option to configure. Encryption is not required for the application to run.</p>
</div>
<div class="paragraph">
<p>kubernetes.yaml</p>
</div>
<div class="listingblock code_column">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="line-numbers">  1</span><span class="key">apiVersion</span>: <span class="string"><span class="content">apps/v1</span></span>
<span class="line-numbers">  2</span><span class="key">kind</span>: <span class="string"><span class="content">Deployment</span></span>
<span class="line-numbers">  3</span><span class="key">metadata</span>:
<span class="line-numbers">  4</span>  <span class="key">name</span>: <span class="string"><span class="content">system-deployment</span></span>
<span class="line-numbers">  5</span>  <span class="key">labels</span>:
<span class="line-numbers">  6</span>    <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers">  7</span><span class="key">spec</span>:
<span class="line-numbers">  8</span>  <span class="key">selector</span>:
<span class="line-numbers">  9</span>    <span class="key">matchLabels</span>:
<span class="line-numbers"> 10</span>      <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers"> 11</span>  <span class="key">strategy</span>:
<span class="line-numbers"> 12</span>    <span class="key">type</span>: <span class="string"><span class="content">RollingUpdate</span></span>
<span class="line-numbers"> 13</span>    <span class="key">rollingUpdate</span>:
<span class="line-numbers"> 14</span>      <span class="key">maxUnavailable</span>: <span class="string"><span class="content">1</span></span>
<span class="line-numbers"> 15</span>      <span class="key">maxSurge</span>: <span class="string"><span class="content">1</span></span>
<span class="line-numbers"> 16</span>  <span class="key">template</span>:
<span class="line-numbers"> 17</span>    <span class="key">metadata</span>:
<span class="line-numbers"> 18</span>      <span class="key">labels</span>:
<span class="line-numbers"> 19</span>        <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers"> 20</span>    <span class="key">spec</span>:
<span class="line-numbers"> 21</span>      <span class="key">containers</span>:
<span class="line-numbers"> 22</span>      <span class="comment"># tag::system-container[]</span>
<span class="line-numbers"> 23</span>      - <span class="string"><span class="content">name: system-container</span></span>
<span class="line-numbers"> 24</span>        <span class="key">image</span>: <span class="string"><span class="content">system:1.0-SNAPSHOT</span></span>
<span class="line-numbers"> 25</span>        <span class="key">ports</span>:
<span class="line-numbers"> 26</span>        - <span class="string"><span class="content">containerPort: 9080</span></span>
<span class="line-numbers"> 27</span>        <span class="comment"># system probes</span>
<span class="line-numbers"> 28</span>        <span class="key">startupProbe</span>:
<span class="line-numbers"> 29</span>          <span class="key">httpGet</span>:
<span class="line-numbers"> 30</span>            <span class="key">path</span>: <span class="string"><span class="content">/health/started</span></span>
<span class="line-numbers"> 31</span>            <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers"> 32</span>        <span class="key">livenessProbe</span>:
<span class="line-numbers"> 33</span>          <span class="key">httpGet</span>:
<span class="line-numbers"> 34</span>            <span class="key">path</span>: <span class="string"><span class="content">/health/live</span></span>
<span class="line-numbers"> 35</span>            <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers"> 36</span>          <span class="key">initialDelaySeconds</span>: <span class="string"><span class="content">60</span></span>
<span class="line-numbers"> 37</span>          <span class="key">periodSeconds</span>: <span class="string"><span class="content">10</span></span>
<span class="line-numbers"> 38</span>          <span class="key">timeoutSeconds</span>: <span class="string"><span class="content">3</span></span>
<span class="line-numbers"> 39</span>          <span class="key">failureThreshold</span>: <span class="string"><span class="content">1</span></span>
<span class="line-numbers"> 40</span>        <span class="key">readinessProbe</span>:
<span class="line-numbers"> 41</span>           <span class="key">httpGet</span>:
<span class="line-numbers"> 42</span>            <span class="key">path</span>: <span class="string"><span class="content">/health/ready</span></span>
<span class="line-numbers"> 43</span>            <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers"> 44</span>           <span class="key">initialDelaySeconds</span>: <span class="string"><span class="content">30</span></span>
<span class="line-numbers"> 45</span>           <span class="key">periodSeconds</span>: <span class="string"><span class="content">10</span></span>
<span class="line-numbers"> 46</span>           <span class="key">timeoutSeconds</span>: <span class="string"><span class="content">3</span></span>
<span class="line-numbers"> 47</span>           <span class="key">failureThreshold</span>: <span class="string"><span class="content">1</span></span>
<span class="line-numbers"> 48</span>        <span class="comment"># Set the environment variables</span>
<span class="line-numbers"> 49</span>        <span class="comment"># tag::env1[]</span>
<span class="line-numbers"> 50</span>        <span class="key">env</span>:
<span class="line-numbers"> 51</span>        <span class="comment"># end::env1[]</span>
<span class="line-numbers"> 52</span>        <span class="comment"># tag::contextRoot1[]</span>
<span class="line-numbers"> 53</span>        - <span class="string"><span class="content">name: CONTEXT_ROOT</span></span>
<span class="line-numbers"> 54</span>          <span class="comment"># tag::valueFrom1[]</span>
<span class="line-numbers"> 55</span>          <span class="key">valueFrom</span>:
<span class="line-numbers"> 56</span>          <span class="comment"># end::valueFrom1[]</span>
<span class="line-numbers"> 57</span>            <span class="comment"># tag::configRef1[]</span>
<span class="line-numbers"> 58</span>            <span class="key">configMapKeyRef</span>:
<span class="line-numbers"> 59</span>              <span class="comment"># tag::root1[]</span>
<span class="line-numbers"> 60</span>              <span class="key">name</span>: <span class="string"><span class="content">sys-app-root</span></span>
<span class="line-numbers"> 61</span>              <span class="comment"># end::root1[]</span>
<span class="line-numbers"> 62</span>              <span class="comment"># tag::contextRootKey1[]</span>
<span class="line-numbers"> 63</span>              <span class="key">key</span>: <span class="string"><span class="content">contextRoot</span></span>
<span class="line-numbers"> 64</span>              <span class="comment"># end::contextRootKey1[]</span>
<span class="line-numbers"> 65</span>            <span class="comment"># end::configRef1[]</span>
<span class="line-numbers"> 66</span>        <span class="comment"># end::contextRoot1[]</span>
<span class="line-numbers"> 67</span>        <span class="comment"># tag::sysUsername1[]</span>
<span class="line-numbers"> 68</span>        - <span class="string"><span class="content">name: SYSTEM_APP_USERNAME</span></span>
<span class="line-numbers"> 69</span>          <span class="comment"># tag::valueFrom2[]</span>
<span class="line-numbers"> 70</span>          <span class="key">valueFrom</span>:
<span class="line-numbers"> 71</span>          <span class="comment"># end::valueFrom2[]</span>
<span class="line-numbers"> 72</span>            <span class="comment"># tag::secretRef1[]</span>
<span class="line-numbers"> 73</span>            <span class="key">secretKeyRef</span>:
<span class="line-numbers"> 74</span>              <span class="comment"># tag::credentials1[]</span>
<span class="line-numbers"> 75</span>              <span class="key">name</span>: <span class="string"><span class="content">sys-app-credentials</span></span>
<span class="line-numbers"> 76</span>              <span class="comment"># end::credentials1[]</span>
<span class="line-numbers"> 77</span>              <span class="comment"># tag::username1[]</span>
<span class="line-numbers"> 78</span>              <span class="key">key</span>: <span class="string"><span class="content">username</span></span>
<span class="line-numbers"> 79</span>              <span class="comment"># end::username1[]</span>
<span class="line-numbers"> 80</span>            <span class="comment"># end::secretRef1[]</span>
<span class="line-numbers"> 81</span>        <span class="comment"># end::sysUsername1[]</span>
<span class="line-numbers"> 82</span>        <span class="comment"># tag::sysPassword1[]</span>
<span class="line-numbers"> 83</span>        - <span class="string"><span class="content">name: SYSTEM_APP_PASSWORD</span></span>
<span class="line-numbers"> 84</span>          <span class="comment"># tag::valueFrom3[]</span>
<span class="line-numbers"> 85</span>          <span class="key">valueFrom</span>:
<span class="line-numbers"> 86</span>          <span class="comment"># end::valueFrom3[]</span>
<span class="line-numbers"> 87</span>            <span class="comment"># tag::secretRef2[]</span>
<span class="line-numbers"> 88</span>            <span class="key">secretKeyRef</span>:
<span class="line-numbers"> 89</span>              <span class="comment"># tag::credentials2[]</span>
<span class="line-numbers"> 90</span>              <span class="key">name</span>: <span class="string"><span class="content">sys-app-credentials</span></span>
<span class="line-numbers"> 91</span>              <span class="comment"># end::credentials2[]</span>
<span class="line-numbers"> 92</span>              <span class="comment"># tag::password1[]</span>
<span class="line-numbers"> 93</span>              <span class="key">key</span>: <span class="string"><span class="content">password</span></span>
<span class="line-numbers"> 94</span>              <span class="comment"># end::password1[]</span>
<span class="line-numbers"> 95</span>            <span class="comment"># end::secretRef2[]</span>
<span class="line-numbers"> 96</span>        <span class="comment"># end::sysPassword1[]</span>
<span class="line-numbers"> 97</span>      <span class="comment"># end::system-container[]</span>
<span class="line-numbers"> 98</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 99</span><span class="key">apiVersion</span>: <span class="string"><span class="content">apps/v1</span></span>
<span class="line-numbers">100</span><span class="key">kind</span>: <span class="string"><span class="content">Deployment</span></span>
<span class="line-numbers">101</span><span class="key">metadata</span>:
<span class="line-numbers">102</span>  <span class="key">name</span>: <span class="string"><span class="content">inventory-deployment</span></span>
<span class="line-numbers">103</span>  <span class="key">labels</span>:
<span class="line-numbers">104</span>    <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers">105</span><span class="key">spec</span>:
<span class="line-numbers">106</span>  <span class="key">selector</span>:
<span class="line-numbers">107</span>    <span class="key">matchLabels</span>:
<span class="line-numbers">108</span>      <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers">109</span>  <span class="key">strategy</span>:
<span class="line-numbers">110</span>    <span class="key">type</span>: <span class="string"><span class="content">RollingUpdate</span></span>
<span class="line-numbers">111</span>    <span class="key">rollingUpdate</span>:
<span class="line-numbers">112</span>      <span class="key">maxUnavailable</span>: <span class="string"><span class="content">1</span></span>
<span class="line-numbers">113</span>      <span class="key">maxSurge</span>: <span class="string"><span class="content">1</span></span>
<span class="line-numbers">114</span>  <span class="key">template</span>:
<span class="line-numbers">115</span>    <span class="key">metadata</span>:
<span class="line-numbers">116</span>      <span class="key">labels</span>:
<span class="line-numbers">117</span>        <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers">118</span>    <span class="key">spec</span>:
<span class="line-numbers">119</span>      <span class="key">containers</span>:
<span class="line-numbers">120</span>      <span class="comment"># tag::inventory-container[]</span>
<span class="line-numbers">121</span>      - <span class="string"><span class="content">name: inventory-container</span></span>
<span class="line-numbers">122</span>        <span class="key">image</span>: <span class="string"><span class="content">inventory:1.0-SNAPSHOT</span></span>
<span class="line-numbers">123</span>        <span class="key">ports</span>:
<span class="line-numbers">124</span>        - <span class="string"><span class="content">containerPort: 9080</span></span>
<span class="line-numbers">125</span>        <span class="comment"># inventory probes</span>
<span class="line-numbers">126</span>        <span class="key">startupProbe</span>:
<span class="line-numbers">127</span>          <span class="key">httpGet</span>:
<span class="line-numbers">128</span>            <span class="key">path</span>: <span class="string"><span class="content">/health/started</span></span>
<span class="line-numbers">129</span>            <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers">130</span>        <span class="key">livenessProbe</span>:
<span class="line-numbers">131</span>          <span class="key">httpGet</span>:
<span class="line-numbers">132</span>            <span class="key">path</span>: <span class="string"><span class="content">/health/live</span></span>
<span class="line-numbers">133</span>            <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers">134</span>          <span class="key">initialDelaySeconds</span>: <span class="string"><span class="content">60</span></span>
<span class="line-numbers">135</span>          <span class="key">periodSeconds</span>: <span class="string"><span class="content">10</span></span>
<span class="line-numbers">136</span>          <span class="key">timeoutSeconds</span>: <span class="string"><span class="content">3</span></span>
<span class="line-numbers">137</span>          <span class="key">failureThreshold</span>: <span class="string"><span class="content">1</span></span>
<span class="line-numbers">138</span>        <span class="key">readinessProbe</span>:
<span class="line-numbers">139</span>          <span class="key">httpGet</span>:
<span class="line-numbers">140</span>            <span class="key">path</span>: <span class="string"><span class="content">/health/ready</span></span>
<span class="line-numbers">141</span>            <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers">142</span>          <span class="key">initialDelaySeconds</span>: <span class="string"><span class="content">30</span></span>
<span class="line-numbers">143</span>          <span class="key">periodSeconds</span>: <span class="string"><span class="content">10</span></span>
<span class="line-numbers">144</span>          <span class="key">timeoutSeconds</span>: <span class="string"><span class="content">3</span></span>
<span class="line-numbers">145</span>          <span class="key">failureThreshold</span>: <span class="string"><span class="content">1</span></span>
<span class="line-numbers">146</span>        <span class="comment"># Set the environment variables</span>
<span class="line-numbers">147</span>        <span class="comment"># tag::env2[]</span>
<span class="line-numbers">148</span>        <span class="key">env</span>:
<span class="line-numbers">149</span>        <span class="comment"># end::env2[]</span>
<span class="line-numbers">150</span>        - <span class="string"><span class="content">name: SYS_APP_HOSTNAME</span></span>
<span class="line-numbers">151</span>          <span class="key">value</span>: <span class="string"><span class="content">system-service</span></span>
<span class="line-numbers">152</span>        <span class="comment"># tag::contextRoot2[]</span>
<span class="line-numbers">153</span>        - <span class="string"><span class="content">name: CONTEXT_ROOT</span></span>
<span class="line-numbers">154</span>          <span class="comment"># tag::valueFrom4[]</span>
<span class="line-numbers">155</span>          <span class="key">valueFrom</span>:
<span class="line-numbers">156</span>          <span class="comment"># end::valueFrom4[]</span>
<span class="line-numbers">157</span>            <span class="comment"># tag::configRef2[]</span>
<span class="line-numbers">158</span>            <span class="key">configMapKeyRef</span>:
<span class="line-numbers">159</span>              <span class="comment"># tag::root2[]</span>
<span class="line-numbers">160</span>              <span class="key">name</span>: <span class="string"><span class="content">sys-app-root</span></span>
<span class="line-numbers">161</span>              <span class="comment"># end::root2[]</span>
<span class="line-numbers">162</span>              <span class="comment"># tag::contextRootKey2[]</span>
<span class="line-numbers">163</span>              <span class="key">key</span>: <span class="string"><span class="content">contextRoot</span></span>
<span class="line-numbers">164</span>              <span class="comment"># end::contextRootKey2[]</span>
<span class="line-numbers">165</span>            <span class="comment"># end::configRef2[]</span>
<span class="line-numbers">166</span>        <span class="comment"># end::contextRoot2[]</span>
<span class="line-numbers">167</span>        <span class="comment"># tag::sysUsername2[]</span>
<span class="line-numbers">168</span>        - <span class="string"><span class="content">name: SYSTEM_APP_USERNAME</span></span>
<span class="line-numbers">169</span>          <span class="comment"># tag::valueFrom5[]</span>
<span class="line-numbers">170</span>          <span class="key">valueFrom</span>:
<span class="line-numbers">171</span>          <span class="comment"># end::valueFrom5[]</span>
<span class="line-numbers">172</span>            <span class="comment"># tag::secretRef3[]</span>
<span class="line-numbers">173</span>            <span class="key">secretKeyRef</span>:
<span class="line-numbers">174</span>              <span class="comment"># tag::credentials3[]</span>
<span class="line-numbers">175</span>              <span class="key">name</span>: <span class="string"><span class="content">sys-app-credentials</span></span>
<span class="line-numbers">176</span>              <span class="comment"># end::credentials3[]</span>
<span class="line-numbers">177</span>              <span class="comment"># tag::username2[]</span>
<span class="line-numbers">178</span>              <span class="key">key</span>: <span class="string"><span class="content">username</span></span>
<span class="line-numbers">179</span>              <span class="comment"># end::username2[]</span>
<span class="line-numbers">180</span>            <span class="comment"># end::secretRef3[]</span>
<span class="line-numbers">181</span>        <span class="comment"># end::sysUsername2[]</span>
<span class="line-numbers">182</span>        <span class="comment"># tag::sysPassword2[]</span>
<span class="line-numbers">183</span>        - <span class="string"><span class="content">name: SYSTEM_APP_PASSWORD</span></span>
<span class="line-numbers">184</span>          <span class="comment"># tag::valueFrom6[]</span>
<span class="line-numbers">185</span>          <span class="key">valueFrom</span>:
<span class="line-numbers">186</span>          <span class="comment"># end::valueFrom6[]</span>
<span class="line-numbers">187</span>            <span class="comment"># tag::secretRef4[]</span>
<span class="line-numbers">188</span>            <span class="key">secretKeyRef</span>:
<span class="line-numbers">189</span>              <span class="comment"># tag::credentials4[]</span>
<span class="line-numbers">190</span>              <span class="key">name</span>: <span class="string"><span class="content">sys-app-credentials</span></span>
<span class="line-numbers">191</span>              <span class="comment"># end::credentials4[]</span>
<span class="line-numbers">192</span>              <span class="comment"># tag::password2[]</span>
<span class="line-numbers">193</span>              <span class="key">key</span>: <span class="string"><span class="content">password</span></span>
<span class="line-numbers">194</span>              <span class="comment"># end::password2[]</span>
<span class="line-numbers">195</span>            <span class="comment"># end::secretRef4[]</span>
<span class="line-numbers">196</span>        <span class="comment"># end::sysPassword2[]</span>
<span class="line-numbers">197</span>      <span class="comment"># end::inventory-container[]</span>
<span class="line-numbers">198</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers">199</span><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="line-numbers">200</span><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="line-numbers">201</span><span class="key">metadata</span>:
<span class="line-numbers">202</span>  <span class="key">name</span>: <span class="string"><span class="content">system-service</span></span>
<span class="line-numbers">203</span><span class="key">spec</span>:
<span class="line-numbers">204</span>  <span class="key">type</span>: <span class="string"><span class="content">NodePort</span></span>
<span class="line-numbers">205</span>  <span class="key">selector</span>:
<span class="line-numbers">206</span>    <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers">207</span>  <span class="key">ports</span>:
<span class="line-numbers">208</span>  - <span class="string"><span class="content">protocol: TCP</span></span>
<span class="line-numbers">209</span>    <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers">210</span>    <span class="key">targetPort</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers">211</span>    <span class="key">nodePort</span>: <span class="string"><span class="content">31000</span></span>
<span class="line-numbers">212</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers">213</span><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="line-numbers">214</span><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="line-numbers">215</span><span class="key">metadata</span>:
<span class="line-numbers">216</span>  <span class="key">name</span>: <span class="string"><span class="content">inventory-service</span></span>
<span class="line-numbers">217</span><span class="key">spec</span>:
<span class="line-numbers">218</span>  <span class="key">type</span>: <span class="string"><span class="content">NodePort</span></span>
<span class="line-numbers">219</span>  <span class="key">selector</span>:
<span class="line-numbers">220</span>    <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers">221</span>  <span class="key">ports</span>:
<span class="line-numbers">222</span>  - <span class="string"><span class="content">protocol: TCP</span></span>
<span class="line-numbers">223</span>    <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers">224</span>    <span class="key">targetPort</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers">225</span>    <span class="key">nodePort</span>: <span class="string"><span class="content">32000</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Dockerfile</p>
</div>
<div class="listingblock code_column">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="text"><span class="line-numbers"> 1</span>FROM icr.io/appcafe/open-liberty:kernel-slim-java11-openj9-ubi
<span class="line-numbers"> 2</span>
<span class="line-numbers"> 3</span>ARG VERSION=1.0
<span class="line-numbers"> 4</span>ARG REVISION=SNAPSHOT
<span class="line-numbers"> 5</span>LABEL \
<span class="line-numbers"> 6</span>  org.opencontainers.image.authors="My Name" \
<span class="line-numbers"> 7</span>  org.opencontainers.image.vendor="Open Liberty" \
<span class="line-numbers"> 8</span>  org.opencontainers.image.url="local" \
<span class="line-numbers"> 9</span>  org.opencontainers.image.source="https://github.com/OpenLiberty/guide-kubernetes-microprofile-config" \
<span class="line-numbers">10</span>  org.opencontainers.image.version="$VERSION" \
<span class="line-numbers">11</span>  org.opencontainers.image.revision="$REVISION" \
<span class="line-numbers">12</span>  vendor="Open Liberty" \
<span class="line-numbers">13</span>  name="system" \
<span class="line-numbers">14</span>  version="$VERSION-$REVISION" \
<span class="line-numbers">15</span>  summary="The system microservice from the Configuring microservices running in Kubernetes guide" \
<span class="line-numbers">16</span>  description="This image contains the system microservice running with the Open Liberty runtime."
<span class="line-numbers">17</span>COPY --chown=1001:0 src/main/liberty/config /config/
<span class="line-numbers">18</span>RUN features.sh
<span class="line-numbers">19</span>COPY --chown=1001:0 target/guide-kubernetes-microprofile-config-system.war /config/apps
<span class="line-numbers">20</span>
<span class="line-numbers">21</span>RUN configure.sh</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="updating-kubernetes-resources">Updating Kubernetes resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Next, you will update your Kubernetes deployments to set the environment variables in your containers based on the values that are configured in the ConfigMap and Secret that you created previously.</p>
</div>
<div class="listingblock code_command hotspot">
<div class="content">
<pre><mark>Replace the kubernetes file.</mark>
<code>kubernetes.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>kubernetes.yaml</p>
</div>
<div class="listingblock code_column">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="line-numbers">  1</span><span class="key">apiVersion</span>: <span class="string"><span class="content">apps/v1</span></span>
<span class="line-numbers">  2</span><span class="key">kind</span>: <span class="string"><span class="content">Deployment</span></span>
<span class="line-numbers">  3</span><span class="key">metadata</span>:
<span class="line-numbers">  4</span>  <span class="key">name</span>: <span class="string"><span class="content">system-deployment</span></span>
<span class="line-numbers">  5</span>  <span class="key">labels</span>:
<span class="line-numbers">  6</span>    <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers">  7</span><span class="key">spec</span>:
<span class="line-numbers">  8</span>  <span class="key">selector</span>:
<span class="line-numbers">  9</span>    <span class="key">matchLabels</span>:
<span class="line-numbers"> 10</span>      <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers"> 11</span>  <span class="key">strategy</span>:
<span class="line-numbers"> 12</span>    <span class="key">type</span>: <span class="string"><span class="content">RollingUpdate</span></span>
<span class="line-numbers"> 13</span>    <span class="key">rollingUpdate</span>:
<span class="line-numbers"> 14</span>      <span class="key">maxUnavailable</span>: <span class="string"><span class="content">1</span></span>
<span class="line-numbers"> 15</span>      <span class="key">maxSurge</span>: <span class="string"><span class="content">1</span></span>
<span class="line-numbers"> 16</span>  <span class="key">template</span>:
<span class="line-numbers"> 17</span>    <span class="key">metadata</span>:
<span class="line-numbers"> 18</span>      <span class="key">labels</span>:
<span class="line-numbers"> 19</span>        <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers"> 20</span>    <span class="key">spec</span>:
<span class="line-numbers"> 21</span>      <span class="key">containers</span>:
<span class="line-numbers"> 22</span>      <span class="comment"># tag::system-container[]</span>
<span class="line-numbers"> 23</span>      - <span class="string"><span class="content">name: system-container</span></span>
<span class="line-numbers"> 24</span>        <span class="key">image</span>: <span class="string"><span class="content">system:1.0-SNAPSHOT</span></span>
<span class="line-numbers"> 25</span>        <span class="key">ports</span>:
<span class="line-numbers"> 26</span>        - <span class="string"><span class="content">containerPort: 9080</span></span>
<span class="line-numbers"> 27</span>        <span class="comment"># system probes</span>
<span class="line-numbers"> 28</span>        <span class="key">startupProbe</span>:
<span class="line-numbers"> 29</span>          <span class="key">httpGet</span>:
<span class="line-numbers"> 30</span>            <span class="key">path</span>: <span class="string"><span class="content">/health/started</span></span>
<span class="line-numbers"> 31</span>            <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers"> 32</span>        <span class="key">livenessProbe</span>:
<span class="line-numbers"> 33</span>          <span class="key">httpGet</span>:
<span class="line-numbers"> 34</span>            <span class="key">path</span>: <span class="string"><span class="content">/health/live</span></span>
<span class="line-numbers"> 35</span>            <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers"> 36</span>          <span class="key">initialDelaySeconds</span>: <span class="string"><span class="content">60</span></span>
<span class="line-numbers"> 37</span>          <span class="key">periodSeconds</span>: <span class="string"><span class="content">10</span></span>
<span class="line-numbers"> 38</span>          <span class="key">timeoutSeconds</span>: <span class="string"><span class="content">3</span></span>
<span class="line-numbers"> 39</span>          <span class="key">failureThreshold</span>: <span class="string"><span class="content">1</span></span>
<span class="line-numbers"> 40</span>        <span class="key">readinessProbe</span>:
<span class="line-numbers"> 41</span>           <span class="key">httpGet</span>:
<span class="line-numbers"> 42</span>            <span class="key">path</span>: <span class="string"><span class="content">/health/ready</span></span>
<span class="line-numbers"> 43</span>            <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers"> 44</span>           <span class="key">initialDelaySeconds</span>: <span class="string"><span class="content">30</span></span>
<span class="line-numbers"> 45</span>           <span class="key">periodSeconds</span>: <span class="string"><span class="content">10</span></span>
<span class="line-numbers"> 46</span>           <span class="key">timeoutSeconds</span>: <span class="string"><span class="content">3</span></span>
<span class="line-numbers"> 47</span>           <span class="key">failureThreshold</span>: <span class="string"><span class="content">1</span></span>
<span class="line-numbers"> 48</span>        <span class="comment"># Set the environment variables</span>
<span class="line-numbers"> 49</span>        <span class="comment"># tag::env1[]</span>
<span class="line-numbers"> 50</span>        <span class="key">env</span>:
<span class="line-numbers"> 51</span>        <span class="comment"># end::env1[]</span>
<span class="line-numbers"> 52</span>        <span class="comment"># tag::contextRoot1[]</span>
<span class="line-numbers"> 53</span>        - <span class="string"><span class="content">name: CONTEXT_ROOT</span></span>
<span class="line-numbers"> 54</span>          <span class="comment"># tag::valueFrom1[]</span>
<span class="line-numbers"> 55</span>          <span class="key">valueFrom</span>:
<span class="line-numbers"> 56</span>          <span class="comment"># end::valueFrom1[]</span>
<span class="line-numbers"> 57</span>            <span class="comment"># tag::configRef1[]</span>
<span class="line-numbers"> 58</span>            <span class="key">configMapKeyRef</span>:
<span class="line-numbers"> 59</span>              <span class="comment"># tag::root1[]</span>
<span class="line-numbers"> 60</span>              <span class="key">name</span>: <span class="string"><span class="content">sys-app-root</span></span>
<span class="line-numbers"> 61</span>              <span class="comment"># end::root1[]</span>
<span class="line-numbers"> 62</span>              <span class="comment"># tag::contextRootKey1[]</span>
<span class="line-numbers"> 63</span>              <span class="key">key</span>: <span class="string"><span class="content">contextRoot</span></span>
<span class="line-numbers"> 64</span>              <span class="comment"># end::contextRootKey1[]</span>
<span class="line-numbers"> 65</span>            <span class="comment"># end::configRef1[]</span>
<span class="line-numbers"> 66</span>        <span class="comment"># end::contextRoot1[]</span>
<span class="line-numbers"> 67</span>        <span class="comment"># tag::sysUsername1[]</span>
<span class="line-numbers"> 68</span>        - <span class="string"><span class="content">name: SYSTEM_APP_USERNAME</span></span>
<span class="line-numbers"> 69</span>          <span class="comment"># tag::valueFrom2[]</span>
<span class="line-numbers"> 70</span>          <span class="key">valueFrom</span>:
<span class="line-numbers"> 71</span>          <span class="comment"># end::valueFrom2[]</span>
<span class="line-numbers"> 72</span>            <span class="comment"># tag::secretRef1[]</span>
<span class="line-numbers"> 73</span>            <span class="key">secretKeyRef</span>:
<span class="line-numbers"> 74</span>              <span class="comment"># tag::credentials1[]</span>
<span class="line-numbers"> 75</span>              <span class="key">name</span>: <span class="string"><span class="content">sys-app-credentials</span></span>
<span class="line-numbers"> 76</span>              <span class="comment"># end::credentials1[]</span>
<span class="line-numbers"> 77</span>              <span class="comment"># tag::username1[]</span>
<span class="line-numbers"> 78</span>              <span class="key">key</span>: <span class="string"><span class="content">username</span></span>
<span class="line-numbers"> 79</span>              <span class="comment"># end::username1[]</span>
<span class="line-numbers"> 80</span>            <span class="comment"># end::secretRef1[]</span>
<span class="line-numbers"> 81</span>        <span class="comment"># end::sysUsername1[]</span>
<span class="line-numbers"> 82</span>        <span class="comment"># tag::sysPassword1[]</span>
<span class="line-numbers"> 83</span>        - <span class="string"><span class="content">name: SYSTEM_APP_PASSWORD</span></span>
<span class="line-numbers"> 84</span>          <span class="comment"># tag::valueFrom3[]</span>
<span class="line-numbers"> 85</span>          <span class="key">valueFrom</span>:
<span class="line-numbers"> 86</span>          <span class="comment"># end::valueFrom3[]</span>
<span class="line-numbers"> 87</span>            <span class="comment"># tag::secretRef2[]</span>
<span class="line-numbers"> 88</span>            <span class="key">secretKeyRef</span>:
<span class="line-numbers"> 89</span>              <span class="comment"># tag::credentials2[]</span>
<span class="line-numbers"> 90</span>              <span class="key">name</span>: <span class="string"><span class="content">sys-app-credentials</span></span>
<span class="line-numbers"> 91</span>              <span class="comment"># end::credentials2[]</span>
<span class="line-numbers"> 92</span>              <span class="comment"># tag::password1[]</span>
<span class="line-numbers"> 93</span>              <span class="key">key</span>: <span class="string"><span class="content">password</span></span>
<span class="line-numbers"> 94</span>              <span class="comment"># end::password1[]</span>
<span class="line-numbers"> 95</span>            <span class="comment"># end::secretRef2[]</span>
<span class="line-numbers"> 96</span>        <span class="comment"># end::sysPassword1[]</span>
<span class="line-numbers"> 97</span>      <span class="comment"># end::system-container[]</span>
<span class="line-numbers"> 98</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers"> 99</span><span class="key">apiVersion</span>: <span class="string"><span class="content">apps/v1</span></span>
<span class="line-numbers">100</span><span class="key">kind</span>: <span class="string"><span class="content">Deployment</span></span>
<span class="line-numbers">101</span><span class="key">metadata</span>:
<span class="line-numbers">102</span>  <span class="key">name</span>: <span class="string"><span class="content">inventory-deployment</span></span>
<span class="line-numbers">103</span>  <span class="key">labels</span>:
<span class="line-numbers">104</span>    <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers">105</span><span class="key">spec</span>:
<span class="line-numbers">106</span>  <span class="key">selector</span>:
<span class="line-numbers">107</span>    <span class="key">matchLabels</span>:
<span class="line-numbers">108</span>      <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers">109</span>  <span class="key">strategy</span>:
<span class="line-numbers">110</span>    <span class="key">type</span>: <span class="string"><span class="content">RollingUpdate</span></span>
<span class="line-numbers">111</span>    <span class="key">rollingUpdate</span>:
<span class="line-numbers">112</span>      <span class="key">maxUnavailable</span>: <span class="string"><span class="content">1</span></span>
<span class="line-numbers">113</span>      <span class="key">maxSurge</span>: <span class="string"><span class="content">1</span></span>
<span class="line-numbers">114</span>  <span class="key">template</span>:
<span class="line-numbers">115</span>    <span class="key">metadata</span>:
<span class="line-numbers">116</span>      <span class="key">labels</span>:
<span class="line-numbers">117</span>        <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers">118</span>    <span class="key">spec</span>:
<span class="line-numbers">119</span>      <span class="key">containers</span>:
<span class="line-numbers">120</span>      <span class="comment"># tag::inventory-container[]</span>
<span class="line-numbers">121</span>      - <span class="string"><span class="content">name: inventory-container</span></span>
<span class="line-numbers">122</span>        <span class="key">image</span>: <span class="string"><span class="content">inventory:1.0-SNAPSHOT</span></span>
<span class="line-numbers">123</span>        <span class="key">ports</span>:
<span class="line-numbers">124</span>        - <span class="string"><span class="content">containerPort: 9080</span></span>
<span class="line-numbers">125</span>        <span class="comment"># inventory probes</span>
<span class="line-numbers">126</span>        <span class="key">startupProbe</span>:
<span class="line-numbers">127</span>          <span class="key">httpGet</span>:
<span class="line-numbers">128</span>            <span class="key">path</span>: <span class="string"><span class="content">/health/started</span></span>
<span class="line-numbers">129</span>            <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers">130</span>        <span class="key">livenessProbe</span>:
<span class="line-numbers">131</span>          <span class="key">httpGet</span>:
<span class="line-numbers">132</span>            <span class="key">path</span>: <span class="string"><span class="content">/health/live</span></span>
<span class="line-numbers">133</span>            <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers">134</span>          <span class="key">initialDelaySeconds</span>: <span class="string"><span class="content">60</span></span>
<span class="line-numbers">135</span>          <span class="key">periodSeconds</span>: <span class="string"><span class="content">10</span></span>
<span class="line-numbers">136</span>          <span class="key">timeoutSeconds</span>: <span class="string"><span class="content">3</span></span>
<span class="line-numbers">137</span>          <span class="key">failureThreshold</span>: <span class="string"><span class="content">1</span></span>
<span class="line-numbers">138</span>        <span class="key">readinessProbe</span>:
<span class="line-numbers">139</span>          <span class="key">httpGet</span>:
<span class="line-numbers">140</span>            <span class="key">path</span>: <span class="string"><span class="content">/health/ready</span></span>
<span class="line-numbers">141</span>            <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers">142</span>          <span class="key">initialDelaySeconds</span>: <span class="string"><span class="content">30</span></span>
<span class="line-numbers">143</span>          <span class="key">periodSeconds</span>: <span class="string"><span class="content">10</span></span>
<span class="line-numbers">144</span>          <span class="key">timeoutSeconds</span>: <span class="string"><span class="content">3</span></span>
<span class="line-numbers">145</span>          <span class="key">failureThreshold</span>: <span class="string"><span class="content">1</span></span>
<span class="line-numbers">146</span>        <span class="comment"># Set the environment variables</span>
<span class="line-numbers">147</span>        <span class="comment"># tag::env2[]</span>
<span class="line-numbers">148</span>        <span class="key">env</span>:
<span class="line-numbers">149</span>        <span class="comment"># end::env2[]</span>
<span class="line-numbers">150</span>        - <span class="string"><span class="content">name: SYS_APP_HOSTNAME</span></span>
<span class="line-numbers">151</span>          <span class="key">value</span>: <span class="string"><span class="content">system-service</span></span>
<span class="line-numbers">152</span>        <span class="comment"># tag::contextRoot2[]</span>
<span class="line-numbers">153</span>        - <span class="string"><span class="content">name: CONTEXT_ROOT</span></span>
<span class="line-numbers">154</span>          <span class="comment"># tag::valueFrom4[]</span>
<span class="line-numbers">155</span>          <span class="key">valueFrom</span>:
<span class="line-numbers">156</span>          <span class="comment"># end::valueFrom4[]</span>
<span class="line-numbers">157</span>            <span class="comment"># tag::configRef2[]</span>
<span class="line-numbers">158</span>            <span class="key">configMapKeyRef</span>:
<span class="line-numbers">159</span>              <span class="comment"># tag::root2[]</span>
<span class="line-numbers">160</span>              <span class="key">name</span>: <span class="string"><span class="content">sys-app-root</span></span>
<span class="line-numbers">161</span>              <span class="comment"># end::root2[]</span>
<span class="line-numbers">162</span>              <span class="comment"># tag::contextRootKey2[]</span>
<span class="line-numbers">163</span>              <span class="key">key</span>: <span class="string"><span class="content">contextRoot</span></span>
<span class="line-numbers">164</span>              <span class="comment"># end::contextRootKey2[]</span>
<span class="line-numbers">165</span>            <span class="comment"># end::configRef2[]</span>
<span class="line-numbers">166</span>        <span class="comment"># end::contextRoot2[]</span>
<span class="line-numbers">167</span>        <span class="comment"># tag::sysUsername2[]</span>
<span class="line-numbers">168</span>        - <span class="string"><span class="content">name: SYSTEM_APP_USERNAME</span></span>
<span class="line-numbers">169</span>          <span class="comment"># tag::valueFrom5[]</span>
<span class="line-numbers">170</span>          <span class="key">valueFrom</span>:
<span class="line-numbers">171</span>          <span class="comment"># end::valueFrom5[]</span>
<span class="line-numbers">172</span>            <span class="comment"># tag::secretRef3[]</span>
<span class="line-numbers">173</span>            <span class="key">secretKeyRef</span>:
<span class="line-numbers">174</span>              <span class="comment"># tag::credentials3[]</span>
<span class="line-numbers">175</span>              <span class="key">name</span>: <span class="string"><span class="content">sys-app-credentials</span></span>
<span class="line-numbers">176</span>              <span class="comment"># end::credentials3[]</span>
<span class="line-numbers">177</span>              <span class="comment"># tag::username2[]</span>
<span class="line-numbers">178</span>              <span class="key">key</span>: <span class="string"><span class="content">username</span></span>
<span class="line-numbers">179</span>              <span class="comment"># end::username2[]</span>
<span class="line-numbers">180</span>            <span class="comment"># end::secretRef3[]</span>
<span class="line-numbers">181</span>        <span class="comment"># end::sysUsername2[]</span>
<span class="line-numbers">182</span>        <span class="comment"># tag::sysPassword2[]</span>
<span class="line-numbers">183</span>        - <span class="string"><span class="content">name: SYSTEM_APP_PASSWORD</span></span>
<span class="line-numbers">184</span>          <span class="comment"># tag::valueFrom6[]</span>
<span class="line-numbers">185</span>          <span class="key">valueFrom</span>:
<span class="line-numbers">186</span>          <span class="comment"># end::valueFrom6[]</span>
<span class="line-numbers">187</span>            <span class="comment"># tag::secretRef4[]</span>
<span class="line-numbers">188</span>            <span class="key">secretKeyRef</span>:
<span class="line-numbers">189</span>              <span class="comment"># tag::credentials4[]</span>
<span class="line-numbers">190</span>              <span class="key">name</span>: <span class="string"><span class="content">sys-app-credentials</span></span>
<span class="line-numbers">191</span>              <span class="comment"># end::credentials4[]</span>
<span class="line-numbers">192</span>              <span class="comment"># tag::password2[]</span>
<span class="line-numbers">193</span>              <span class="key">key</span>: <span class="string"><span class="content">password</span></span>
<span class="line-numbers">194</span>              <span class="comment"># end::password2[]</span>
<span class="line-numbers">195</span>            <span class="comment"># end::secretRef4[]</span>
<span class="line-numbers">196</span>        <span class="comment"># end::sysPassword2[]</span>
<span class="line-numbers">197</span>      <span class="comment"># end::inventory-container[]</span>
<span class="line-numbers">198</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers">199</span><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="line-numbers">200</span><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="line-numbers">201</span><span class="key">metadata</span>:
<span class="line-numbers">202</span>  <span class="key">name</span>: <span class="string"><span class="content">system-service</span></span>
<span class="line-numbers">203</span><span class="key">spec</span>:
<span class="line-numbers">204</span>  <span class="key">type</span>: <span class="string"><span class="content">NodePort</span></span>
<span class="line-numbers">205</span>  <span class="key">selector</span>:
<span class="line-numbers">206</span>    <span class="key">app</span>: <span class="string"><span class="content">system</span></span>
<span class="line-numbers">207</span>  <span class="key">ports</span>:
<span class="line-numbers">208</span>  - <span class="string"><span class="content">protocol: TCP</span></span>
<span class="line-numbers">209</span>    <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers">210</span>    <span class="key">targetPort</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers">211</span>    <span class="key">nodePort</span>: <span class="string"><span class="content">31000</span></span>
<span class="line-numbers">212</span><span class="head"><span class="head">---</span></span>
<span class="line-numbers">213</span><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="line-numbers">214</span><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="line-numbers">215</span><span class="key">metadata</span>:
<span class="line-numbers">216</span>  <span class="key">name</span>: <span class="string"><span class="content">inventory-service</span></span>
<span class="line-numbers">217</span><span class="key">spec</span>:
<span class="line-numbers">218</span>  <span class="key">type</span>: <span class="string"><span class="content">NodePort</span></span>
<span class="line-numbers">219</span>  <span class="key">selector</span>:
<span class="line-numbers">220</span>    <span class="key">app</span>: <span class="string"><span class="content">inventory</span></span>
<span class="line-numbers">221</span>  <span class="key">ports</span>:
<span class="line-numbers">222</span>  - <span class="string"><span class="content">protocol: TCP</span></span>
<span class="line-numbers">223</span>    <span class="key">port</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers">224</span>    <span class="key">targetPort</span>: <span class="string"><span class="content">9080</span></span>
<span class="line-numbers">225</span>    <span class="key">nodePort</span>: <span class="string"><span class="content">32000</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code class="hotspot=contextRoot1 hotspot=contextRoot2 file=0">CONTEXT_ROOT</code>, <code class="hotspot=sysUsername1 hotspot=sysUsername2 file=0">SYSTEM_APP_USERNAME</code>, and <code class="hotspot=sysPassword1 hotspot=sysPassword2 file=0">SYSTEM_APP_PASSWORD</code> environment variables are set in the <code class="hotspot=env1 hotspot=env2 file=0">env</code> sections of <code class="hotspot=system-container file=0">system-container</code> and <code class="hotspot=inventory-container file=0">inventory-container</code>.</p>
</div>
<div class="paragraph">
<p>Using the <code class="hotspot=valueFrom1 hotspot=valueFrom2 hotspot=valueFrom3 hotspot=valueFrom4 hotspot=valueFrom5 hotspot=valueFrom6 file=0">valueFrom</code> field, you can specify the value of an environment variable from various sources. These sources include a ConfigMap, a Secret, and information about the cluster. In this example <code class="hotspot=configRef1 hotspot=configRef2 file=0">configMapKeyRef</code> gets the value <code class="hotspot=contextRootKey1 hotspot=contextRootKey2 file=0">contextRoot</code> from the <code class="hotspot=root1 hotspot=root2 file=0">sys-app-root</code> ConfigMap. Similarly, <code class="hotspot=secretRef1 hotspot=secretRef2 hotspot=secretRef3 hotspot=secretRef4 file=0">secretKeyRef</code> gets the values <code class="hotspot=username1 hotspot=username2 file=0">username</code> and <code class="hotspot=password1 hotspot=password2 file=0">password</code> from the <code class="hotspot=credentials1 hotspot=credentials2 hotspot=credentials3 hotspot=credentials4 file=0">sys-app-credentials</code> Secret.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploying-your-changes">Deploying your changes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Rebuild the application using <code>mvn clean package</code>.</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn clean package</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the <code>docker build</code> commands to rebuild container images for your application:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>docker build -t system:1.0-SNAPSHOT system/.
docker build -t inventory:1.0-SNAPSHOT inventory/.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the following command to deploy your changes to the Kubernetes cluster.</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>kubectl replace --force -f kubernetes.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>When this command finishes, wait for the pods to be in the Ready state. Run the following command to view the status of the pods.</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>kubectl get pods</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the pods are ready, the output shows <code>1/1</code> for READY and <code>Running</code> for STATUS.</p>
</div>
<div class="paragraph">
<p>Your application will now be available at the <code>http://[hostname]:31000/dev/system/properties</code> URL. You now need to use the new username, <code>alice</code>, and the new password, <code>wonderland</code>, to log in. Alternatively, you can run the following command:</p>
</div>
<div class="paragraph tab_link windows_link">
<p><code><strong>WINDOWS</strong></code></p>
</div>
<div class="paragraph tab_link mac_link">
<p><code><strong>MAC</strong></code></p>
</div>
<div class="paragraph tab_link linux_link">
<p><code><strong>LINUX</strong></code></p>
</div>
<div class="openblock tab_content windows_section">
<div class="content">
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>curl http://localhost:31000/dev/system/properties -u alice:wonderland</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>curl</code> command is unavailable, then use <a href="https://www.getpostman.com/" target="_blank" rel="noopener noreferrer">Postman</a>. To make a request with Postman, enter <code>http://localhost:31000/dev/system/properties</code> into the URL bar. Next, set the <code>Authorization</code> with <code>Basic Auth</code> type, and set the <code>Username</code> field to <code>alice</code> and <code>Password</code> field to <code>wonderland</code>. Finally, click the blue <code>Send</code> button to make the request.</p>
</div>
</div>
</div>
<div class="openblock tab_content mac_section">
<div class="content">
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>curl http://localhost:31000/dev/system/properties -u alice:wonderland</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock tab_content linux_section">
<div class="content">
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>curl http://$(minikube ip):31000/dev/system/properties -u alice:wonderland</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Notice that the URL you are using to reach the application now has <code>/dev</code> as the context root.</p>
</div>
<div class="paragraph">
<p>Verify that <code>http://[hostname]:32000/inventory/systems/system-service</code> is working as intended. If it is not working, then check the configuration of the credentials.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing-the-microservices">Testing the microservices</h2>
<div class="sectionbody">
<div class="paragraph tab_link windows_link">
<p><code><strong>WINDOWS</strong></code></p>
</div>
<div class="paragraph tab_link mac_link">
<p><code><strong>MAC</strong></code></p>
</div>
<div class="paragraph tab_link linux_link">
<p><code><strong>LINUX</strong></code></p>
</div>
<div class="openblock tab_content windows_section mac_section">
<div class="content">
<div class="paragraph">
<p>Run the integration tests:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn failsafe:integration-test -Dsystem.context.root=/dev</code></pre>
</div>
</div>
</div>
</div>
<div class="openblock tab_content linux_section">
<div class="content">
<div class="paragraph">
<p>Run the integration tests against a cluster running at Minikube’s IP address:</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>mvn failsafe:integration-test -Dsystem.context.root=/dev -Dsystem.service.root=$(minikube ip):31000 -Dinventory.service.root=$(minikube ip):32000</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The tests for <code>inventory</code> verify that the service can communicate with <code>system</code> using the configured credentials. If the credentials are misconfigured, then the <code>inventory</code> test fails, so the <code>inventory</code> test indirectly verifies that the credentials are correctly configured.</p>
</div>
<div class="paragraph">
<p>After the tests succeed, you should see output similar to the following in your console.</p>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre class="CodeRay highlight"><code>-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running it.io.openliberty.guides.system.SystemEndpointIT
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.706 s - in it.io.openliberty.guides.system.SystemEndpointIT

Results:

Tests run: 2, Failures: 0, Errors: 0, Skipped: 0</code></pre>
</div>
</div>
<div class="listingblock no_copy">
<div class="content">
<pre class="CodeRay highlight"><code>-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running it.io.openliberty.guides.inventory.InventoryEndpointIT
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.696 s - in it.io.openliberty.guides.inventory.InventoryEndpointIT

Results:

Tests run: 3, Failures: 0, Errors: 0, Skipped: 0</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tearing-down-the-environment">Tearing down the environment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Run the following commands to delete all the resources that you created.</p>
</div>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>kubectl delete -f kubernetes.yaml
kubectl delete configmap sys-app-root
kubectl delete secret sys-app-credentials</code></pre>
</div>
</div>
<div class="paragraph command tab_link windows_link">
<p><code><strong>WINDOWS</strong></code></p>
</div>
<div class="paragraph tab_link mac_link">
<p><code><strong>MAC</strong></code></p>
</div>
<div class="paragraph tab_link linux_link">
<p><code><strong>LINUX</strong></code></p>
</div>
<div class="openblock tab_content windows_section mac_section">
<div class="content">
<div class="paragraph">
<p>Nothing more needs to be done for Docker Desktop.</p>
</div>
</div>
</div>
<div class="openblock tab_content linux_section">
<div class="content">
<div class="paragraph">
<p>Perform the following steps to return your environment to a clean state.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Point the Docker daemon back to your local machine:</p>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>eval $(minikube docker-env -u)</code></pre>
</div>
</div>
</li>
<li>
<p>Stop your Minikube cluster:</p>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>minikube stop</code></pre>
</div>
</div>
</li>
<li>
<p>Delete your cluster:</p>
<div class="listingblock command">
<div class="content">
<pre class="CodeRay highlight"><code>minikube delete</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="great-work-youre-done">Great work! You’re done!</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You have used MicroProfile Config to externalize the configuration of two microservices, and then you configured them by creating a ConfigMap and Secret in your Kubernetes cluster.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="guide-attribution">Guide Attribution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Configuring microservices running in Kubernetes <span class="licensedClass">by</span> Open Liberty <span class="licensedClass">is licensed under</span> CC BY-ND 4.0</p>
</div>
</div>
</div>
    </div>
  </div>

  <!-- Code section -->
  <div id="code_column" class="position_relative" tabindex="0">
    <div id="code_column_title_container">
      <div id="code_column_tabs_container" class="dimmed">
        <ul id="code_column_tabs" class="nav" role="tablist"></ul>
      </div>
      <div class="copyFileButton" tabindex="0">
        <img src="/img/guides_copy_button.svg" alt="Copy file contents" title="Copy file contents">
        <div id="code_section_copied_confirmation">Copied to clipboard </div>
      </div>
    </div>
    <div id="code_column_content"></div>

    <div id="prereqs_container">
      <p id="prereqs_title">Prerequisites:</p>
      <div class="prereqs_list"></div>
      <div class="skills_network_container">
        <div class="skills_network_description"></div>
      </div>
    </div>

    <button id="dismiss_button" aria-label="Back to text" tabindex="0">
      Back to text
    </button>
  </div>
</div>

<!-- Build a list of all the documents in the guides code base -->






<!-- Remove any documents deemed private (archived, templates, etc) -->


<!-- Count number of guides from past 30 days-->


    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    

    
    
    

    <!-- 2592000 is 30 days in seconds (30 days * 24 hours * 60 minutes * 60 seconds) -->
    


<!-- Sort list of guides by date with most recent first -->





<div id="end_of_guide">
        <h2 tabindex="0">Nice work! Where to next?</h2>
        <div id="end_of_guide_left_section">
            <p id="guide_attribution"></p>
            
            <h3 id="feedback_rating_question">What did you think of this guide?</h3>
            <div id="feedback_ratings">
                <img class="guide_rating" id="extreme_dislike" src="/img/1_Extreme_Dislike.png" onclick="$('#dislike_popup').show(); $('.popup_content').focus();" alt="Extreme Dislike" data-guide-rating="1" tabindex="0" aria-label="Rate this guide as extreme dislike">
                <img class="guide_rating" id="dislike" src="/img/2_Dislike.png" onclick="$('#dislike_popup').show(); $('.popup_content').focus();" alt="Dislike" data-guide-rating="2" tabindex="0" aria-label="Rate this guide as dislike">
                <img class="guide_rating" id="like" src="/img/3_Like.png" onclick="$('#like_popup').show(); $('.popup_content').focus();" alt="Like" data-guide-rating="3" tabindex="0" aria-label="Rate this guide as like">
                <img class="guide_rating" id="extreme_like" src="/img/4_Extreme_Like.png" onclick="$('#like_popup').show(); $('.popup_content').focus();" alt="Extreme Like" data-guide-rating="4" tabindex="0" aria-label="Rate this guide as extreme like">
            </div>

            <div id="like_popup" class="popup">
                <div class="popup_content" tabindex="0">
                    <p class="popup_title">Thank you for your feedback!</p>
                    <button id="close_button" class="popup_button" onclick="$('#like_popup').hide();">Close</button>
                </div>
            </div>

            <div id="dislike_popup" class="popup">
                <div class="popup_content" tabindex="0">
                    <p class="popup_title">Thank you for your feedback!</p>
                    <p id="open_issue">Would you like to open an issue in GitHub?</p>
                    
                        <a href="https://github.com/OpenLiberty/guide-kubernetes-microprofile-config/issues/new" target="_blank" id="yes_button" class="popup_button" onclick="$('#dislike_popup').hide();" rel="noopener noreferrer">Yes</a>
                    
                    <button id="no_button" class="popup_button" onclick="$('#dislike_popup').hide();">No, thank you</button>
                </div>
            </div>

            <h3 id="improve_guide_feedback">What could make this guide better?</h3>
            
                <p><a target="_blank" rel="noopener noreferrer" href="https://github.com/OpenLiberty/guide-kubernetes-microprofile-config/issues">Raise an issue</a> to share feedback</p>
                <p><a target="_blank" rel="noopener noreferrer" href="https://github.com/OpenLiberty/guide-kubernetes-microprofile-config/pulls">Create a pull request</a> to contribute to this guide</p>
            

            <h3 id="need_help">Need help?</h3>
            <p><a target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/questions/tagged/open-liberty">Ask a question on Stack Overflow</a></p>

            <h3>Like Open Liberty? Star our repo on GitHub.</h3>
            <a class="github-button" href="https://github.com/OpenLiberty/open-liberty" data-icon="octicon-star" aria-label="Star OpenLiberty/open-liberty on GitHub" target="_blank" rel="noopener noreferrer">Star</a>
        </div>
        <div id="end_of_guide_right_section">
            <h3 id="where_to_next">Where to next?</h3>

            
            

            <!-- Related guides section -->
            
            <div id="related-guides">
                <div id="related-guides-cards" class="row">
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/kubernetes-intro.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Deploying microservices to Kubernetes</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">25 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/microprofile-config.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Configuring microservices</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">20 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/cdi-intro.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Injecting dependencies into microservices</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">15 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                    
                    
                    
                        <!-- Only create a card if we find the permalink -->
                        
                        <div class="col-sm-12 col-lg-6">
                            <a href="/zh-Hans/guides/docker.html" class="small_guide_item">
                                <div class="guide_title_container">
                                    <h3 class="guide_title">Using Docker containers to develop microservices</h3>
                                </div>
                                <img class="duration_clock_icon" src="/img/guide_duration_clock_icon_small.svg" alt="Duration">
                                <span class="guide_duration">20 minutes</span>

                                <!-- Add New flag to guides from the past 30 days or 4 most recent posts. -->
                                <!-- If new posts count is less than 4, use 4 most recent posts -->
                                
                                    
                                <!-- If new posts count is >= 4, use posts from last 30 days-->
                                
                                <!-- Add Updated flag to guides if the last major update is within last 12 weeks. -->
                                <!-- Count number of guides from past last 12 weeks that is 84 days-->
                                <!-- 7257600 is 84 days in seconds (84 days * 24 hours * 60 minutes * 60 seconds) -->
                                
                                
                            </a>
                        </div>
                    
                
                </div>
            </div>
            
        </div>
    </div>



    </main>

    



<footer>
    <div id="footer_gray_background">
        <div id="footer_top_container" class="footer_container container-fluid">
            <div id="footer_project_container">
                <span id="footer_open_liberty"></span>
                <p id="footer_project">IBM 开放式源代码项目</p>
            </div>
            <div id="footer_round_links_container">
                <a id="footer_github_link" class="footer_round_btn" href="https://github.com/OpenLiberty/" target="_blank" rel="noopener noreferrer" aria-label="Github"></a>
                <a id="footer_twitter_link" class="footer_round_btn" href="https://twitter.com/OpenLibertyIO" target="_blank" rel="noopener noreferrer" aria-label="Twitter"></a>
                <a id="footer_stackoverflow_link" class="footer_round_btn" href="https://stackoverflow.com/questions/tagged/open-liberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty questions on Stack Overflow"></a>
                <a id="footer_groupsio_link" class="footer_round_btn" href="https://groups.io/g/openliberty" target="_blank" rel="noopener noreferrer" aria-label="Open Liberty Groups.io"></a>
                <a id="footer_gitter_link" class="footer_round_btn" href="https://app.gitter.im/#/room/#OpenLiberty_development:gitter.im" target="_blank" rel="noopener" aria-label="Open Liberty Gitter"></a>
            </div>
        </div>         
    </div>

    <div id="footer_bottom_container" class="footer_container container-fluid">
        <div id="footer_bottom_left_section">
            <p id="footer_copyright">© Copyright IBM Corp. 2017, 2023</p>
            <p class="vertical_bar">|</p>
            <a id="footer_privacy_policy_link" href="https://www.ibm.com/privacy/" target="_blank" rel="noopener noreferrer" class="left_footer_link">隐私策略</a>
            <p class="vertical_bar">|</p>
            <a id="footer_license_link" href="https://github.com/OpenLiberty/open-liberty/blob/release/LICENSE" target="_blank" rel="noopener noreferrer" class="left_footer_link">许可证</a>
            <p class="vertical_bar">|</p>
            <a id="footer_logos_link" href="https://github.com/OpenLiberty/logos" target="_blank" rel="noopener noreferrer" class="left_footer_link">洛戈斯</a>
        </div>
        <div id="footer_bottom_right_section">
            <a id="footer_docs_link" href="/docs" aria-label="Open Liberty Docs" class="right_footer_link blue_link_light_background">文档</a>
            <a id="footer_blog_link" href="/blog" aria-label="Open Liberty Blog" class="right_footer_link blue_link_light_background">博客</a>
            <a id="footer_support_link" href="/support" aria-label="Open Liberty Support" class="right_footer_link blue_link_light_background">支持</a>
        </div>
    </div>
</footer>

<!-- PRE-LOADED IMAGES FOR ON HOVER BEHAVIOR -->
<div class="d-none hidden">
    <img src="/img/Footer_GitCat_Hover.svg" alt="OpenLiberty Github link">
    <img src="/img/Footer_TwitterBird_Hover.svg" alt="OpenLibertyIO Twitter link">
    <img src="/img/Footer_StackO_Hover.svg" alt="Open-liberty Stack Overflow link">
    <img src="/img/Footer_GroupsIO_Hover.svg" alt="Openliberty Groups IO link">
    <img src="/img/footer_gitter_hover.svg" alt="Openliberty Gitter link">
</div>

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js" integrity="sha512-lzilC+JFd6YV8+vQRNRtU7DOqv5Sa9Ek53lXt/k91HZTJpytHS1L6l1mMKR9K6VVoDt4LiEXaa6XBrYk1YhGTQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>


<script type="text/javascript" src="/zh-Hans/assets/devEnvironment.js"></script>




  <script type="text/javascript" src="/zh-Hans/assets/guide-common.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/toc.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/tabs.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/guide-static.js"></script>

  <script type="text/javascript" src="/zh-Hans/assets/guide-multipane-static.js"></script>


<script type="text/javascript" src="/zh-Hans/assets/openliberty.js"></script>

  </body>

</html>
